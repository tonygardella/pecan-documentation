<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>29 Docker | The Predictive Ecosystem Analyzer</title>
  <meta name="description" content="29 Docker | The Predictive Ecosystem Analyzer">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="29 Docker | The Predictive Ecosystem Analyzer" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="29 Docker | The Predictive Ecosystem Analyzer" />
  
  
  

<meta name="author" content="By: PEcAn Team">


<meta name="date" content="2019-02-06">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="available-meteorological-drivers.html">
<link rel="next" href="shiny.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.5/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/dt-ext-fixedcolumns-1.10.16/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-fixedcolumns-1.10.16/js/dataTables.fixedColumns.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<script src="libs/jszip-1.10.16/jszip.min.js"></script>
<script src="libs/pdfmake-1.10.16/pdfmake.min.js"></script>
<script src="libs/pdfmake-1.10.16/vfs_fonts.js"></script>
<link href="libs/dt-ext-buttons-1.10.16/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-buttons-1.10.16/js/dataTables.buttons.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.flash.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.html5.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.colVis.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.print.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="project-overview.html"><a href="project-overview.html"><i class="fa fa-check"></i><b>1</b> Project Overview</a></li>
<li class="chapter" data-level="2" data-path="contributor-covenant-code-of-conduct.html"><a href="contributor-covenant-code-of-conduct.html"><i class="fa fa-check"></i><b>2</b> Contributor Covenant Code of Conduct</a></li>
<li class="chapter" data-level="3" data-path="about-the-pecan-book.html"><a href="about-the-pecan-book.html"><i class="fa fa-check"></i><b>3</b> About the PEcAn Book</a><ul>
<li class="chapter" data-level="3.1" data-path="about-the-pecan-book.html"><a href="about-the-pecan-book.html#how-to-contribute"><i class="fa fa-check"></i><b>3.1</b> How to Contribute</a><ul>
<li class="chapter" data-level="3.1.1" data-path="about-the-pecan-book.html"><a href="about-the-pecan-book.html#editing-the-book-yourself"><i class="fa fa-check"></i><b>3.1.1</b> Editing the book yourself</a></li>
<li class="chapter" data-level="3.1.2" data-path="about-the-pecan-book.html"><a href="about-the-pecan-book.html#feedbackcommentssuggestions"><i class="fa fa-check"></i><b>3.1.2</b> Feedback/Comments/Suggestions</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Basic User Guide</b></span></li>
<li class="chapter" data-level="4" data-path="GettingStarted.html"><a href="GettingStarted.html"><i class="fa fa-check"></i><b>4</b> Getting Started</a><ul>
<li class="chapter" data-level="4.1" data-path="GettingStarted.html"><a href="GettingStarted.html#how-pecan-works-in-a-nutshell"><i class="fa fa-check"></i><b>4.1</b> How PEcAn Works in a nutshell</a></li>
<li class="chapter" data-level="4.2" data-path="GettingStarted.html"><a href="GettingStarted.html#installing-and-running-pecan"><i class="fa fa-check"></i><b>4.2</b> Installing and running PEcAn</a><ul>
<li class="chapter" data-level="4.2.1" data-path="GettingStarted.html"><a href="GettingStarted.html#basicvm"><i class="fa fa-check"></i><b>4.2.1</b> Using the Virtual Machine</a></li>
<li class="chapter" data-level="4.2.2" data-path="GettingStarted.html"><a href="GettingStarted.html#awsvm"><i class="fa fa-check"></i><b>4.2.2</b> Using Amazon Web Services (AWS)</a></li>
<li class="chapter" data-level="4.2.3" data-path="GettingStarted.html"><a href="GettingStarted.html#dockervm"><i class="fa fa-check"></i><b>4.2.3</b> (Experimental) Using Docker</a></li>
<li class="chapter" data-level="4.2.4" data-path="GettingStarted.html"><a href="GettingStarted.html#advanced-installing-by-hand"><i class="fa fa-check"></i><b>4.2.4</b> (Advanced) Installing by hand</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="GettingStarted.html"><a href="GettingStarted.html#pecan-demos"><i class="fa fa-check"></i><b>4.3</b> PEcAn Demos</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="web-workflow.html"><a href="web-workflow.html"><i class="fa fa-check"></i><b>5</b> Web workflow</a><ul>
<li class="chapter" data-level="5.1" data-path="web-workflow.html"><a href="web-workflow.html#web-site-model"><i class="fa fa-check"></i><b>5.1</b> Site and model selection</a><ul>
<li class="chapter" data-level="5.1.1" data-path="web-workflow.html"><a href="web-workflow.html#selecting-a-model"><i class="fa fa-check"></i><b>5.1.1</b> Selecting a model</a></li>
<li class="chapter" data-level="5.1.2" data-path="web-workflow.html"><a href="web-workflow.html#selecting-a-site"><i class="fa fa-check"></i><b>5.1.2</b> Selecting a site</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="web-workflow.html"><a href="web-workflow.html#web-model-config"><i class="fa fa-check"></i><b>5.2</b> Model configuration</a><ul>
<li class="chapter" data-level="5.2.1" data-path="web-workflow.html"><a href="web-workflow.html#choosing-meteorology"><i class="fa fa-check"></i><b>5.2.1</b> Choosing meteorology</a></li>
<li class="chapter" data-level="5.2.2" data-path="web-workflow.html"><a href="web-workflow.html#selecting-plant-functional-types-pfts-and-other-parameter-groupings."><i class="fa fa-check"></i><b>5.2.2</b> Selecting Plant Functional Types (PFTs) and other parameter groupings.</a></li>
<li class="chapter" data-level="5.2.3" data-path="web-workflow.html"><a href="web-workflow.html#choosing-initial-vegetation"><i class="fa fa-check"></i><b>5.2.3</b> Choosing initial vegetation</a></li>
<li class="chapter" data-level="5.2.4" data-path="web-workflow.html"><a href="web-workflow.html#spin-up"><i class="fa fa-check"></i><b>5.2.4</b> Spin up</a></li>
<li class="chapter" data-level="5.2.5" data-path="web-workflow.html"><a href="web-workflow.html#selecting-a-soils-product"><i class="fa fa-check"></i><b>5.2.5</b> Selecting a soils product</a></li>
<li class="chapter" data-level="5.2.6" data-path="web-workflow.html"><a href="web-workflow.html#other-model-inputs"><i class="fa fa-check"></i><b>5.2.6</b> Other model inputs</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Intermediate user guide</b></span></li>
<li class="chapter" data-level="6" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>6</b> Introduction</a></li>
<li class="chapter" data-level="7" data-path="pecanXML.html"><a href="pecanXML.html"><i class="fa fa-check"></i><b>7</b> The PEcAn XML</a><ul>
<li class="chapter" data-level="7.1" data-path="pecanXML.html"><a href="pecanXML.html#xml-core-config"><i class="fa fa-check"></i><b>7.1</b> Core configuration</a><ul>
<li class="chapter" data-level="7.1.1" data-path="pecanXML.html"><a href="pecanXML.html#xml-structure"><i class="fa fa-check"></i><b>7.1.1</b> Top-level structure</a></li>
<li class="chapter" data-level="7.1.2" data-path="pecanXML.html"><a href="pecanXML.html#xml-info"><i class="fa fa-check"></i><b>7.1.2</b> <code>info</code>: Run metadata</a></li>
<li class="chapter" data-level="7.1.3" data-path="pecanXML.html"><a href="pecanXML.html#xml-outdir"><i class="fa fa-check"></i><b>7.1.3</b> <code>outdir</code>: Output directory</a></li>
<li class="chapter" data-level="7.1.4" data-path="pecanXML.html"><a href="pecanXML.html#xml-database"><i class="fa fa-check"></i><b>7.1.4</b> <code>database</code>: PEcAn database settings</a></li>
<li class="chapter" data-level="7.1.5" data-path="pecanXML.html"><a href="pecanXML.html#xml-pft"><i class="fa fa-check"></i><b>7.1.5</b> <code>pft</code>: Plant functional type selection</a></li>
<li class="chapter" data-level="7.1.6" data-path="pecanXML.html"><a href="pecanXML.html#xml-meta-analysis"><i class="fa fa-check"></i><b>7.1.6</b> <code>meta.analysis</code>: Trait Meta Analysis</a></li>
<li class="chapter" data-level="7.1.7" data-path="pecanXML.html"><a href="pecanXML.html#xml-model"><i class="fa fa-check"></i><b>7.1.7</b> <code>model</code>: Model configuration</a></li>
<li class="chapter" data-level="7.1.8" data-path="pecanXML.html"><a href="pecanXML.html#xml-run"><i class="fa fa-check"></i><b>7.1.8</b> <code>run</code>: Run Setup</a></li>
<li class="chapter" data-level="7.1.9" data-path="pecanXML.html"><a href="pecanXML.html#xml-host"><i class="fa fa-check"></i><b>7.1.9</b> <code>host</code>: Host information for remote execution</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="pecanXML.html"><a href="pecanXML.html#xml-advanced"><i class="fa fa-check"></i><b>7.2</b> Advanced features</a><ul>
<li class="chapter" data-level="7.2.1" data-path="pecanXML.html"><a href="pecanXML.html#xml-ensemble"><i class="fa fa-check"></i><b>7.2.1</b> <code>ensemble</code>: Ensemble Runs</a></li>
<li class="chapter" data-level="7.2.2" data-path="pecanXML.html"><a href="pecanXML.html#xml-sensitivity-analysis"><i class="fa fa-check"></i><b>7.2.2</b> <code>sensitivity.analysis</code>: Sensitivity analysis</a></li>
<li class="chapter" data-level="7.2.3" data-path="pecanXML.html"><a href="pecanXML.html#xml-parameter-data-assimilation"><i class="fa fa-check"></i><b>7.2.3</b> Parameter Data Assimilation</a></li>
<li class="chapter" data-level="7.2.4" data-path="pecanXML.html"><a href="pecanXML.html#xml-multi-settings"><i class="fa fa-check"></i><b>7.2.4</b> Multi-Settings</a></li>
<li class="chapter" data-level="7.2.5" data-path="pecanXML.html"><a href="pecanXML.html#xml-state-data-assimilation"><i class="fa fa-check"></i><b>7.2.5</b> (experimental) State Data Assimilation</a></li>
<li class="chapter" data-level="7.2.6" data-path="pecanXML.html"><a href="pecanXML.html#xml-browndog"><i class="fa fa-check"></i><b>7.2.6</b> (experimental) Brown Dog</a></li>
<li class="chapter" data-level="7.2.7" data-path="pecanXML.html"><a href="pecanXML.html#xml-benchmarking"><i class="fa fa-check"></i><b>7.2.7</b> (experimental) Benchmarking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="additional-web-configuration.html"><a href="additional-web-configuration.html"><i class="fa fa-check"></i><b>8</b> Additional web configuration</a><ul>
<li class="chapter" data-level="8.1" data-path="additional-web-configuration.html"><a href="additional-web-configuration.html#brown-dog"><i class="fa fa-check"></i><b>8.1</b> Brown Dog</a></li>
<li class="chapter" data-level="8.2" data-path="additional-web-configuration.html"><a href="additional-web-configuration.html#basic-setups"><i class="fa fa-check"></i><b>8.2</b> Basic Setups</a></li>
<li class="chapter" data-level="8.3" data-path="additional-web-configuration.html"><a href="additional-web-configuration.html#advanced-setup"><i class="fa fa-check"></i><b>8.3</b> Advanced Setup</a></li>
<li class="chapter" data-level="8.4" data-path="additional-web-configuration.html"><a href="additional-web-configuration.html#editing-model-configurations"><i class="fa fa-check"></i><b>8.4</b> Editing model configurations</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html"><i class="fa fa-check"></i><b>9</b> Settings-configured analyses</a><ul>
<li class="chapter" data-level="9.1" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#pda"><i class="fa fa-check"></i><b>9.1</b> Parameter data assimilation (PDA)</a><ul>
<li class="chapter" data-level="9.1.1" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#pda.mcmc.r"><i class="fa fa-check"></i><b>9.1.1</b> <strong>pda.mcmc.R</strong></a></li>
<li class="chapter" data-level="9.1.2" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#pda.mcmc.bs.r"><i class="fa fa-check"></i><b>9.1.2</b> <strong>pda.mcmc.bs.R</strong></a></li>
<li class="chapter" data-level="9.1.3" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#pda.emulator"><i class="fa fa-check"></i><b>9.1.3</b> <strong>pda.emulator</strong></a></li>
<li class="chapter" data-level="9.1.4" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#pda.mcmc.recover.r"><i class="fa fa-check"></i><b>9.1.4</b> <strong>pda.mcmc.recover.R</strong></a></li>
<li class="chapter" data-level="9.1.5" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#pda.utils.r"><i class="fa fa-check"></i><b>9.1.5</b> <strong>pda.utils.R</strong></a></li>
<li class="chapter" data-level="9.1.6" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#get.da.data..r-plot.da.r"><i class="fa fa-check"></i><b>9.1.6</b> <strong>get.da.data.*.R, plot.da.R</strong></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#sda"><i class="fa fa-check"></i><b>9.2</b> State data assimilation (SDA)</a><ul>
<li class="chapter" data-level="9.2.1" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#sda.enkf.r-description"><i class="fa fa-check"></i><b>9.2.1</b> <strong>sda.enkf.R Description</strong></a></li>
<li class="chapter" data-level="9.2.2" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#sda.enkf.r-arguments"><i class="fa fa-check"></i><b>9.2.2</b> <strong>sda.enkf.R Arguments</strong></a></li>
<li class="chapter" data-level="9.2.3" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#state-data-assimilation-workflow"><i class="fa fa-check"></i><b>9.2.3</b> State Data Assimilation Workflow</a></li>
<li class="chapter" data-level="9.2.4" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#state-data-assimilation-tags-example"><i class="fa fa-check"></i><b>9.2.4</b> State Data Assimilation Tags Example</a></li>
<li class="chapter" data-level="9.2.5" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#state-data-assimilation-tags-descriptions"><i class="fa fa-check"></i><b>9.2.5</b> State Data Assimilation Tags Descriptions</a></li>
<li class="chapter" data-level="9.2.6" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#model-specific-functions-for-sda-workflow"><i class="fa fa-check"></i><b>9.2.6</b> Model Specific Functions for SDA Workflow</a></li>
<li class="chapter" data-level="9.2.7" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#analysis-options"><i class="fa fa-check"></i><b>9.2.7</b> Analysis Options</a></li>
<li class="chapter" data-level="9.2.8" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#the-generalized-ensemble-filter"><i class="fa fa-check"></i><b>9.2.8</b> The Generalized Ensemble Filter</a></li>
<li class="chapter" data-level="9.2.9" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#multi-site-state-data-assimilation."><i class="fa fa-check"></i><b>9.2.9</b> Multi-site State data assimilation.</a></li>
<li class="chapter" data-level="9.2.10" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#data-products"><i class="fa fa-check"></i><b>9.2.10</b> Data Products</a></li>
<li class="chapter" data-level="9.2.11" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#current-models"><i class="fa fa-check"></i><b>9.2.11</b> Current Models</a></li>
<li class="chapter" data-level="9.2.12" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#model-calibration"><i class="fa fa-check"></i><b>9.2.12</b> Model Calibration</a></li>
<li class="chapter" data-level="9.2.13" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#initial-conditions"><i class="fa fa-check"></i><b>9.2.13</b> Initial Conditions</a></li>
<li class="chapter" data-level="9.2.14" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#drivers"><i class="fa fa-check"></i><b>9.2.14</b> Drivers</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#sequential-state-data-assimilation"><i class="fa fa-check"></i><b>9.3</b> Sequential State Data Assimilation</a><ul>
<li class="chapter" data-level="9.3.1" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#general-description"><i class="fa fa-check"></i><b>9.3.1</b> General Description</a></li>
<li class="chapter" data-level="9.3.2" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#enkf"><i class="fa fa-check"></i><b>9.3.2</b> EnKF</a></li>
<li class="chapter" data-level="9.3.3" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#generalized-ensemble-filter"><i class="fa fa-check"></i><b>9.3.3</b> Generalized Ensemble Filter</a></li>
<li class="chapter" data-level="9.3.4" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#ensemble-adjustment"><i class="fa fa-check"></i><b>9.3.4</b> Ensemble Adjustment</a></li>
<li class="chapter" data-level="9.3.5" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#diagnostics"><i class="fa fa-check"></i><b>9.3.5</b> Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#Benchmarking"><i class="fa fa-check"></i><b>9.4</b> Benchmarking</a><ul>
<li class="chapter" data-level="9.4.1" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#data-preparation"><i class="fa fa-check"></i><b>9.4.1</b> Data Preparation</a></li>
<li class="chapter" data-level="9.4.2" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#model-runs"><i class="fa fa-check"></i><b>9.4.2</b> Model Runs</a></li>
<li class="chapter" data-level="9.4.3" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#the-benchmarking-shiny-app"><i class="fa fa-check"></i><b>9.4.3</b> The Benchmarking Shiny App</a></li>
<li class="chapter" data-level="9.4.4" data-path="settings-configured-analyses.html"><a href="settings-configured-analyses.html#benchmarking-in-pecan.xml"><i class="fa fa-check"></i><b>9.4.4</b> Benchmarking in pecan.xml</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="pecan-remote.html"><a href="pecan-remote.html"><i class="fa fa-check"></i><b>10</b> Remote execution with PEcAn</a><ul>
<li class="chapter" data-level="10.1" data-path="pecan-remote.html"><a href="pecan-remote.html#basics-of-ssh"><i class="fa fa-check"></i><b>10.1</b> Basics of SSH</a></li>
<li class="chapter" data-level="10.2" data-path="pecan-remote.html"><a href="pecan-remote.html#ssh-authentication-password-vs.ssh-key"><i class="fa fa-check"></i><b>10.2</b> SSH authentication – password vs. SSH key</a><ul>
<li class="chapter" data-level="10.2.1" data-path="pecan-remote.html"><a href="pecan-remote.html#ssh-tunneling"><i class="fa fa-check"></i><b>10.2.1</b> SSH tunneling</a></li>
<li class="chapter" data-level="10.2.2" data-path="pecan-remote.html"><a href="pecan-remote.html#ssh-tunnels-and-pecan"><i class="fa fa-check"></i><b>10.2.2</b> SSH tunnels and PEcAn</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="pecan-remote.html"><a href="pecan-remote.html#basic-remote-execute-functions"><i class="fa fa-check"></i><b>10.3</b> Basic remote execute functions</a></li>
<li class="chapter" data-level="10.4" data-path="pecan-remote.html"><a href="pecan-remote.html#remote-model-execution-with-pecan"><i class="fa fa-check"></i><b>10.4</b> Remote model execution with PEcAn</a><ul>
<li class="chapter" data-level="10.4.1" data-path="pecan-remote.html"><a href="pecan-remote.html#xml-configuration"><i class="fa fa-check"></i><b>10.4.1</b> XML configuration</a></li>
<li class="chapter" data-level="10.4.2" data-path="pecan-remote.html"><a href="pecan-remote.html#configuration-for-pecan-web-interface"><i class="fa fa-check"></i><b>10.4.2</b> Configuration for PEcAn web interface</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="pecan-remote.html"><a href="pecan-remote.html#running-pecan-code-for-remotely"><i class="fa fa-check"></i><b>10.5</b> Running PEcAn code for remotely</a><ul>
<li class="chapter" data-level="10.5.1" data-path="pecan-remote.html"><a href="pecan-remote.html#geo.bu.edu"><i class="fa fa-check"></i><b>10.5.1</b> geo.bu.edu</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="the-pecan-docker-api.html"><a href="the-pecan-docker-api.html"><i class="fa fa-check"></i><b>11</b> The PEcAn Docker API</a><ul>
<li class="chapter" data-level="11.1" data-path="the-pecan-docker-api.html"><a href="the-pecan-docker-api.html#installation"><i class="fa fa-check"></i><b>11.1</b> Installation</a></li>
<li class="chapter" data-level="11.2" data-path="the-pecan-docker-api.html"><a href="the-pecan-docker-api.html#creating-and-submitting-a-workflow"><i class="fa fa-check"></i><b>11.2</b> Creating and submitting a workflow</a></li>
</ul></li>
<li class="part"><span><b>IV Advanced user guide</b></span></li>
<li class="chapter" data-level="12" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>12</b> Introduction</a></li>
<li class="chapter" data-level="13" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>13</b> PEcAn workflow (web/workflow.R)</a><ul>
<li class="chapter" data-level="13.1" data-path="workflow.html"><a href="workflow.html#workflow-readsettings"><i class="fa fa-check"></i><b>13.1</b> Read Settings</a></li>
<li class="chapter" data-level="13.2" data-path="workflow.html"><a href="workflow.html#workflow-input"><i class="fa fa-check"></i><b>13.2</b> Input Conversions</a><ul>
<li class="chapter" data-level="13.2.1" data-path="workflow.html"><a href="workflow.html#workflow-input-data"><i class="fa fa-check"></i><b>13.2.1</b> Input Data</a></li>
<li class="chapter" data-level="13.2.2" data-path="workflow.html"><a href="workflow.html#workflow-input-initial"><i class="fa fa-check"></i><b>13.2.2</b> Initial Conditions</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="workflow.html"><a href="workflow.html#workflow-met"><i class="fa fa-check"></i><b>13.3</b> Meteorological Data</a><ul>
<li class="chapter" data-level="13.3.1" data-path="workflow.html"><a href="workflow.html#workflow-met-download"><i class="fa fa-check"></i><b>13.3.1</b> Downloading Raw data (Description of Process)</a></li>
<li class="chapter" data-level="13.3.2" data-path="workflow.html"><a href="workflow.html#workflow-met-standard"><i class="fa fa-check"></i><b>13.3.2</b> Converting raw data to PEcAn standard</a></li>
<li class="chapter" data-level="13.3.3" data-path="workflow.html"><a href="workflow.html#workflow-met-downscale"><i class="fa fa-check"></i><b>13.3.3</b> Downscaling and gapfilling (optional)</a></li>
<li class="chapter" data-level="13.3.4" data-path="workflow.html"><a href="workflow.html#workflow-met-model"><i class="fa fa-check"></i><b>13.3.4</b> Converting from PEcAn standard to model-specific format</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="workflow.html"><a href="workflow.html#workflow-traits"><i class="fa fa-check"></i><b>13.4</b> Traits</a></li>
<li class="chapter" data-level="13.5" data-path="workflow.html"><a href="workflow.html#workflow-metaanalysis"><i class="fa fa-check"></i><b>13.5</b> Meta Analysis</a></li>
<li class="chapter" data-level="13.6" data-path="workflow.html"><a href="workflow.html#workflow-modelconfig"><i class="fa fa-check"></i><b>13.6</b> Model Configuration</a></li>
<li class="chapter" data-level="13.7" data-path="workflow.html"><a href="workflow.html#workflow-modelrun"><i class="fa fa-check"></i><b>13.7</b> Run Execution</a></li>
<li class="chapter" data-level="13.8" data-path="workflow.html"><a href="workflow.html#workflow-postrun"><i class="fa fa-check"></i><b>13.8</b> Post Run Analysis</a></li>
<li class="chapter" data-level="13.9" data-path="workflow.html"><a href="workflow.html#workflow-advanced"><i class="fa fa-check"></i><b>13.9</b> Advanced Analysis</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html"><i class="fa fa-check"></i><b>14</b> Adding to PEcAn</a><ul>
<li class="chapter" data-level="14.1" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#adding-model"><i class="fa fa-check"></i><b>14.1</b> Adding An Ecosystem Model</a><ul>
<li class="chapter" data-level="14.1.1" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#pecan-database"><i class="fa fa-check"></i><b>14.1.1</b> PEcAn Database</a></li>
<li class="chapter" data-level="14.1.2" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#define-model_type"><i class="fa fa-check"></i><b>14.1.2</b> Define MODEL_TYPE</a></li>
<li class="chapter" data-level="14.1.3" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#machine"><i class="fa fa-check"></i><b>14.1.3</b> MACHINE</a></li>
<li class="chapter" data-level="14.1.4" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#model"><i class="fa fa-check"></i><b>14.1.4</b> MODEL</a></li>
<li class="chapter" data-level="14.1.5" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#formats"><i class="fa fa-check"></i><b>14.1.5</b> FORMATS</a></li>
<li class="chapter" data-level="14.1.6" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#model_type---formats"><i class="fa fa-check"></i><b>14.1.6</b> MODEL_TYPE -&gt; Formats</a></li>
<li class="chapter" data-level="14.1.7" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#inputs"><i class="fa fa-check"></i><b>14.1.7</b> INPUTS</a></li>
<li class="chapter" data-level="14.1.8" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#pfts-plant-functional-types"><i class="fa fa-check"></i><b>14.1.8</b> PFTS (Plant Functional Types)</a></li>
<li class="chapter" data-level="14.1.9" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#priors"><i class="fa fa-check"></i><b>14.1.9</b> PRIORS</a></li>
<li class="chapter" data-level="14.1.10" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#interface-modules"><i class="fa fa-check"></i><b>14.1.10</b> Interface Modules</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#NewInput"><i class="fa fa-check"></i><b>14.2</b> Adding input data</a><ul>
<li class="chapter" data-level="14.2.1" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#input-records-in-bety"><i class="fa fa-check"></i><b>14.2.1</b> Input records in BETY</a></li>
<li class="chapter" data-level="14.2.2" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#create-a-database-file-record-for-the-input-data"><i class="fa fa-check"></i><b>14.2.2</b> Create a database file record for the input data</a></li>
<li class="chapter" data-level="14.2.3" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#creating-a-new-input-record-in-bety"><i class="fa fa-check"></i><b>14.2.3</b> Creating a new Input record in BETY</a></li>
<li class="chapter" data-level="14.2.4" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#InputConversions"><i class="fa fa-check"></i><b>14.2.4</b> Adding a new input converter</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#adding-data-web"><i class="fa fa-check"></i><b>14.3</b> Pecan Data Ingest via Web Interface</a><ul>
<li class="chapter" data-level="14.3.1" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#loading-data"><i class="fa fa-check"></i><b>14.3.1</b> Loading Data</a></li>
<li class="chapter" data-level="14.3.2" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#local-upload-example"><i class="fa fa-check"></i><b>14.3.2</b> Local Upload Example</a></li>
<li class="chapter" data-level="14.3.3" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#creating-a-format-record"><i class="fa fa-check"></i><b>14.3.3</b> 3. Creating a format record</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#NewFormat"><i class="fa fa-check"></i><b>14.4</b> Creating a new format</a><ul>
<li class="chapter" data-level="14.4.1" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#formats-in-bety"><i class="fa fa-check"></i><b>14.4.1</b> Formats in BETY</a></li>
<li class="chapter" data-level="14.4.2" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#creating-a-new-format-in-bety"><i class="fa fa-check"></i><b>14.4.2</b> Creating a new format in BETY</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#NewBenchmark"><i class="fa fa-check"></i><b>14.5</b> Creating a new benchmark reference run</a></li>
<li class="chapter" data-level="14.6" data-path="adding-to-pecan.html"><a href="adding-to-pecan.html#editing-records"><i class="fa fa-check"></i><b>14.6</b> Editing records</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="standalone-tools-modules.html"><a href="standalone-tools-modules.html"><i class="fa fa-check"></i><b>15</b> Standalone tools (modules)</a><ul>
<li class="chapter" data-level="15.1" data-path="standalone-tools-modules.html"><a href="standalone-tools-modules.html#LoadData"><i class="fa fa-check"></i><b>15.1</b> Loading Data in PEcAn</a><ul>
<li class="chapter" data-level="15.1.1" data-path="standalone-tools-modules.html"><a href="standalone-tools-modules.html#function-load_data"><i class="fa fa-check"></i><b>15.1.1</b> Function <code>load_data</code></a></li>
<li class="chapter" data-level="15.1.2" data-path="standalone-tools-modules.html"><a href="standalone-tools-modules.html#example"><i class="fa fa-check"></i><b>15.1.2</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="working-with-the-vm.html"><a href="working-with-the-vm.html"><i class="fa fa-check"></i><b>16</b> Working with the VM</a><ul>
<li class="chapter" data-level="16.1" data-path="working-with-the-vm.html"><a href="working-with-the-vm.html#connecting-to-the-vm-via-ssh"><i class="fa fa-check"></i><b>16.1</b> Connecting to the VM via SSH</a></li>
<li class="chapter" data-level="16.2" data-path="working-with-the-vm.html"><a href="working-with-the-vm.html#connecting-to-bety-on-the-vm-via-ssh"><i class="fa fa-check"></i><b>16.2</b> Connecting to bety on the VM via SSh</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="workflow-modules.html"><a href="workflow-modules.html"><i class="fa fa-check"></i><b>17</b> Workflow modules</a><ul>
<li class="chapter" data-level="17.1" data-path="workflow-modules.html"><a href="workflow-modules.html#overview"><i class="fa fa-check"></i><b>17.1</b> Overview</a><ul>
<li class="chapter" data-level="17.1.1" data-path="workflow-modules.html"><a href="workflow-modules.html#load-settings"><i class="fa fa-check"></i><b>17.1.1</b> Load Settings:</a></li>
<li class="chapter" data-level="17.1.2" data-path="workflow-modules.html"><a href="workflow-modules.html#query-database"><i class="fa fa-check"></i><b>17.1.2</b> Query Database:</a></li>
<li class="chapter" data-level="17.1.3" data-path="workflow-modules.html"><a href="workflow-modules.html#meta-analysis"><i class="fa fa-check"></i><b>17.1.3</b> Meta Analysis:</a></li>
<li class="chapter" data-level="17.1.4" data-path="workflow-modules.html"><a href="workflow-modules.html#write-configuration-files"><i class="fa fa-check"></i><b>17.1.4</b> Write Configuration Files</a></li>
<li class="chapter" data-level="17.1.5" data-path="workflow-modules.html"><a href="workflow-modules.html#start-runs"><i class="fa fa-check"></i><b>17.1.5</b> Start Runs:</a></li>
<li class="chapter" data-level="17.1.6" data-path="workflow-modules.html"><a href="workflow-modules.html#get-model-output"><i class="fa fa-check"></i><b>17.1.6</b> Get Model Output</a></li>
<li class="chapter" data-level="17.1.7" data-path="workflow-modules.html"><a href="workflow-modules.html#ensemble-analysis"><i class="fa fa-check"></i><b>17.1.7</b> Ensemble Analysis</a></li>
<li class="chapter" data-level="17.1.8" data-path="workflow-modules.html"><a href="workflow-modules.html#sensitivity-analysis-variance-decomposition"><i class="fa fa-check"></i><b>17.1.8</b> Sensitivity Analysis, Variance Decomposition</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="workflow-modules.html"><a href="workflow-modules.html#glossary"><i class="fa fa-check"></i><b>17.2</b> Glossary</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="submitting-workflow-from-command-line.html"><a href="submitting-workflow-from-command-line.html"><i class="fa fa-check"></i><b>18</b> Submitting Workflow from Command Line</a></li>
<li class="chapter" data-level="19" data-path="vm-desktop-conversion.html"><a href="vm-desktop-conversion.html"><i class="fa fa-check"></i><b>19</b> VM Desktop Conversion</a><ul>
<li class="chapter" data-level="19.0.1" data-path="vm-desktop-conversion.html"><a href="vm-desktop-conversion.html#install-rstudio-desktop"><i class="fa fa-check"></i><b>19.0.1</b> Install RStudio Desktop</a></li>
</ul></li>
<li class="part"><span><b>V Developer user guide</b></span></li>
<li class="chapter" data-level="20" data-path="introduction-developer-guide.html"><a href="introduction-developer-guide.html"><i class="fa fa-check"></i><b>20</b> Introduction: Developer Guide</a></li>
<li class="chapter" data-level="21" data-path="pecan-setup.html"><a href="pecan-setup.html"><i class="fa fa-check"></i><b>21</b> PEcAn Setup</a><ul>
<li class="chapter" data-level="21.1" data-path="pecan-setup.html"><a href="pecan-setup.html#installing-the-pecan-vm"><i class="fa fa-check"></i><b>21.1</b> Installing the PEcAn VM</a></li>
<li class="chapter" data-level="21.2" data-path="pecan-setup.html"><a href="pecan-setup.html#pecan-manual-setup"><i class="fa fa-check"></i><b>21.2</b> Install PEcAn by hand</a><ul>
<li class="chapter" data-level="21.2.1" data-path="pecan-setup.html"><a href="pecan-setup.html#installation-prerequisites"><i class="fa fa-check"></i><b>21.2.1</b> Installation Prerequisites</a></li>
<li class="chapter" data-level="21.2.2" data-path="pecan-setup.html"><a href="pecan-setup.html#os-specific-installations"><i class="fa fa-check"></i><b>21.2.2</b> OS Specific Installations</a></li>
<li class="chapter" data-level="21.2.3" data-path="pecan-setup.html"><a href="pecan-setup.html#installing-bety"><i class="fa fa-check"></i><b>21.2.3</b> Installing BETY</a></li>
<li class="chapter" data-level="21.2.4" data-path="pecan-setup.html"><a href="pecan-setup.html#install-models"><i class="fa fa-check"></i><b>21.2.4</b> Install Models</a></li>
<li class="chapter" data-level="21.2.5" data-path="pecan-setup.html"><a href="pecan-setup.html#download-and-compile-pecan"><i class="fa fa-check"></i><b>21.2.5</b> Download and Compile PEcAn</a></li>
<li class="chapter" data-level="21.2.6" data-path="pecan-setup.html"><a href="pecan-setup.html#pecan-testrun"><i class="fa fa-check"></i><b>21.2.6</b> PEcAn Testrun</a></li>
<li class="chapter" data-level="21.2.7" data-path="pecan-setup.html"><a href="pecan-setup.html#pecan-customizations"><i class="fa fa-check"></i><b>21.2.7</b> PEcAn Customizations</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="pecan-setup.html"><a href="pecan-setup.html#aws-setup"><i class="fa fa-check"></i><b>21.3</b> AWS Setup</a><ul>
<li class="chapter" data-level="21.3.1" data-path="pecan-setup.html"><a href="pecan-setup.html#porting-vm-to-aws"><i class="fa fa-check"></i><b>21.3.1</b> Porting VM to AWS</a></li>
<li class="chapter" data-level="21.3.2" data-path="pecan-setup.html"><a href="pecan-setup.html#set-up-multiple-instances-optional"><i class="fa fa-check"></i><b>21.3.2</b> Set up multiple instances (optional)</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="pecan-setup.html"><a href="pecan-setup.html#shiny-setup"><i class="fa fa-check"></i><b>21.4</b> Shiny Setup</a><ul>
<li class="chapter" data-level="21.4.1" data-path="pecan-setup.html"><a href="pecan-setup.html#install-the-shiny-r-package-and-shiny-server"><i class="fa fa-check"></i><b>21.4.1</b> Install the Shiny R package and Shiny server</a></li>
<li class="chapter" data-level="21.4.2" data-path="pecan-setup.html"><a href="pecan-setup.html#modify-the-shiny-configuration-file"><i class="fa fa-check"></i><b>21.4.2</b> Modify the shiny configuration file</a></li>
<li class="chapter" data-level="21.4.3" data-path="pecan-setup.html"><a href="pecan-setup.html#set-the-apache-proxy"><i class="fa fa-check"></i><b>21.4.3</b> Set the Apache proxy</a></li>
<li class="chapter" data-level="21.4.4" data-path="pecan-setup.html"><a href="pecan-setup.html#enable-and-start-the-shiny-server-and-restart-apache"><i class="fa fa-check"></i><b>21.4.4</b> Enable and start the shiny server, and restart apache</a></li>
<li class="chapter" data-level="21.4.5" data-path="pecan-setup.html"><a href="pecan-setup.html#troubleshooting-1"><i class="fa fa-check"></i><b>21.4.5</b> Troubleshooting</a></li>
<li class="chapter" data-level="21.4.6" data-path="pecan-setup.html"><a href="pecan-setup.html#further-reading"><i class="fa fa-check"></i><b>21.4.6</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="pecan-setup.html"><a href="pecan-setup.html#thredds-setup"><i class="fa fa-check"></i><b>21.5</b> Thredds Setup</a><ul>
<li class="chapter" data-level="21.5.1" data-path="pecan-setup.html"><a href="pecan-setup.html#install-the-tomcat-8-and-thredds-webapp"><i class="fa fa-check"></i><b>21.5.1</b> Install the Tomcat 8 and Thredds webapp</a></li>
<li class="chapter" data-level="21.5.2" data-path="pecan-setup.html"><a href="pecan-setup.html#ubuntu-1"><i class="fa fa-check"></i><b>21.5.2</b> Ubuntu</a></li>
<li class="chapter" data-level="21.5.3" data-path="pecan-setup.html"><a href="pecan-setup.html#customize-the-thredds-server"><i class="fa fa-check"></i><b>21.5.3</b> Customize the Thredds server</a></li>
<li class="chapter" data-level="21.5.4" data-path="pecan-setup.html"><a href="pecan-setup.html#update-the-catalog"><i class="fa fa-check"></i><b>21.5.4</b> Update the catalog</a></li>
<li class="chapter" data-level="21.5.5" data-path="pecan-setup.html"><a href="pecan-setup.html#troubleshooting-2"><i class="fa fa-check"></i><b>21.5.5</b> Troubleshooting</a></li>
<li class="chapter" data-level="21.5.6" data-path="pecan-setup.html"><a href="pecan-setup.html#further-reading-1"><i class="fa fa-check"></i><b>21.5.6</b> Further reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="maintaining-pecan.html"><a href="maintaining-pecan.html"><i class="fa fa-check"></i><b>22</b> Maintaining PEcAn</a><ul>
<li class="chapter" data-level="22.1" data-path="maintaining-pecan.html"><a href="maintaining-pecan.html#updating-pecan-code-and-bety-database"><i class="fa fa-check"></i><b>22.1</b> Updating PEcAn Code and Bety Database</a><ul>
<li class="chapter" data-level="22.1.1" data-path="maintaining-pecan.html"><a href="maintaining-pecan.html#updating-pecan"><i class="fa fa-check"></i><b>22.1.1</b> Updating PEcAn</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="maintaining-pecan.html"><a href="maintaining-pecan.html#updating-bety"><i class="fa fa-check"></i><b>22.2</b> Updating BETY</a></li>
<li class="chapter" data-level="22.3" data-path="maintaining-pecan.html"><a href="maintaining-pecan.html#database-synchronization"><i class="fa fa-check"></i><b>22.3</b> Database synchronization</a><ul>
<li class="chapter" data-level="22.3.1" data-path="maintaining-pecan.html"><a href="maintaining-pecan.html#how-does-it-work"><i class="fa fa-check"></i><b>22.3.1</b> How does it work?</a></li>
<li class="chapter" data-level="22.3.2" data-path="maintaining-pecan.html"><a href="maintaining-pecan.html#set-up"><i class="fa fa-check"></i><b>22.3.2</b> Set up</a></li>
<li class="chapter" data-level="22.3.3" data-path="maintaining-pecan.html"><a href="maintaining-pecan.html#fetch-latest-data"><i class="fa fa-check"></i><b>22.3.3</b> Fetch latest data</a></li>
<li class="chapter" data-level="22.3.4" data-path="maintaining-pecan.html"><a href="maintaining-pecan.html#sharing-data"><i class="fa fa-check"></i><b>22.3.4</b> Sharing data</a></li>
<li class="chapter" data-level="22.3.5" data-path="maintaining-pecan.html"><a href="maintaining-pecan.html#automation"><i class="fa fa-check"></i><b>22.3.5</b> Automation</a></li>
<li class="chapter" data-level="22.3.6" data-path="maintaining-pecan.html"><a href="maintaining-pecan.html#database-maintentance"><i class="fa fa-check"></i><b>22.3.6</b> Database maintentance</a></li>
<li class="chapter" data-level="22.3.7" data-path="maintaining-pecan.html"><a href="maintaining-pecan.html#troubleshooting-3"><i class="fa fa-check"></i><b>22.3.7</b> Troubleshooting</a></li>
<li class="chapter" data-level="22.3.8" data-path="maintaining-pecan.html"><a href="maintaining-pecan.html#network-status-map"><i class="fa fa-check"></i><b>22.3.8</b> Network Status Map</a></li>
<li class="chapter" data-level="22.3.9" data-path="maintaining-pecan.html"><a href="maintaining-pecan.html#tasks"><i class="fa fa-check"></i><b>22.3.9</b> Tasks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html"><i class="fa fa-check"></i><b>23</b> Git and GitHub Workflow</a><ul>
<li class="chapter" data-level="23.1" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#using-git"><i class="fa fa-check"></i><b>23.1</b> Using Git</a><ul>
<li class="chapter" data-level="23.1.1" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#git"><i class="fa fa-check"></i><b>23.1.1</b> Git</a></li>
<li class="chapter" data-level="23.1.2" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#pecan-project-and-github"><i class="fa fa-check"></i><b>23.1.2</b> PEcAn Project and Github</a></li>
<li class="chapter" data-level="23.1.3" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#pecan-project-branches"><i class="fa fa-check"></i><b>23.1.3</b> PEcAn Project Branches</a></li>
<li class="chapter" data-level="23.1.4" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#quick-and-easy"><i class="fa fa-check"></i><b>23.1.4</b> Quick and Easy</a></li>
<li class="chapter" data-level="23.1.5" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#recommended-git-workflow"><i class="fa fa-check"></i><b>23.1.5</b> Recommended Git Workflow</a></li>
<li class="chapter" data-level="23.1.6" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#before-any-work-is-done"><i class="fa fa-check"></i><b>23.1.6</b> Before any work is done</a></li>
<li class="chapter" data-level="23.1.7" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#during-development"><i class="fa fa-check"></i><b>23.1.7</b> During development:</a></li>
<li class="chapter" data-level="23.1.8" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#basic-workflow"><i class="fa fa-check"></i><b>23.1.8</b> Basic Workflow</a></li>
<li class="chapter" data-level="23.1.9" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#recommended-workflow-a-new-branch-for-each-change"><i class="fa fa-check"></i><b>23.1.9</b> Recommended Workflow: A new branch for each change</a></li>
<li class="chapter" data-level="23.1.10" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#git-rstudio"><i class="fa fa-check"></i><b>23.1.10</b> Git + Rstudio</a></li>
<li class="chapter" data-level="23.1.11" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#for-development"><i class="fa fa-check"></i><b>23.1.11</b> For development:</a></li>
<li class="chapter" data-level="23.1.12" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#references"><i class="fa fa-check"></i><b>23.1.12</b> References</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#github-use-with-pecan"><i class="fa fa-check"></i><b>23.2</b> GitHub use with PEcAn</a><ul>
<li class="chapter" data-level="23.2.1" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#bugs-issues-features-etc."><i class="fa fa-check"></i><b>23.2.1</b> Bugs, Issues, Features, etc.</a></li>
<li class="chapter" data-level="23.2.2" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#requesting-a-feature"><i class="fa fa-check"></i><b>23.2.2</b> Requesting a feature</a></li>
<li class="chapter" data-level="23.2.3" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#closing-an-issue"><i class="fa fa-check"></i><b>23.2.3</b> Closing an issue</a></li>
<li class="chapter" data-level="23.2.4" data-path="git-and-github-workflow.html"><a href="git-and-github-workflow.html#when-to-submit-an-issue"><i class="fa fa-check"></i><b>23.2.4</b> When to submit an issue?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="coding-practices.html"><a href="coding-practices.html"><i class="fa fa-check"></i><b>24</b> Coding Practices</a><ul>
<li class="chapter" data-level="24.1" data-path="coding-practices.html"><a href="coding-practices.html#coding-style"><i class="fa fa-check"></i><b>24.1</b> Coding Style</a><ul>
<li class="chapter" data-level="24.1.1" data-path="coding-practices.html"><a href="coding-practices.html#use-roxygen2-documentation"><i class="fa fa-check"></i><b>24.1.1</b> Use Roxygen2 documentation</a></li>
<li class="chapter" data-level="24.1.2" data-path="coding-practices.html"><a href="coding-practices.html#write-your-name-at-the-top"><i class="fa fa-check"></i><b>24.1.2</b> Write your name at the top</a></li>
<li class="chapter" data-level="24.1.3" data-path="coding-practices.html"><a href="coding-practices.html#use-testthat-testing-package"><i class="fa fa-check"></i><b>24.1.3</b> Use testthat testing package</a></li>
<li class="chapter" data-level="24.1.4" data-path="coding-practices.html"><a href="coding-practices.html#dont-use-shortcuts"><i class="fa fa-check"></i><b>24.1.4</b> Don’t use shortcuts</a></li>
<li class="chapter" data-level="24.1.5" data-path="coding-practices.html"><a href="coding-practices.html#package-dependencies"><i class="fa fa-check"></i><b>24.1.5</b> Package Dependencies:</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="coding-practices.html"><a href="coding-practices.html#logging"><i class="fa fa-check"></i><b>24.2</b> Logging</a><ul>
<li class="chapter" data-level="24.2.1" data-path="coding-practices.html"><a href="coding-practices.html#pecan-logging-functions"><i class="fa fa-check"></i><b>24.2.1</b> PEcAn logging functions</a></li>
<li class="chapter" data-level="24.2.2" data-path="coding-practices.html"><a href="coding-practices.html#other-r-logging-packages"><i class="fa fa-check"></i><b>24.2.2</b> Other R logging packages</a></li>
<li class="chapter" data-level="24.2.3" data-path="coding-practices.html"><a href="coding-practices.html#example-usage"><i class="fa fa-check"></i><b>24.2.3</b> Example Usage</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="coding-practices.html"><a href="coding-practices.html#package-data"><i class="fa fa-check"></i><b>24.3</b> Package Data</a><ul>
<li class="chapter" data-level="24.3.1" data-path="coding-practices.html"><a href="coding-practices.html#summary"><i class="fa fa-check"></i><b>24.3.1</b> Summary:</a></li>
<li class="chapter" data-level="24.3.2" data-path="coding-practices.html"><a href="coding-practices.html#accessing-data"><i class="fa fa-check"></i><b>24.3.2</b> Accessing data</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="coding-practices.html"><a href="coding-practices.html#packages-used-in-development"><i class="fa fa-check"></i><b>24.4</b> Packages used in development</a></li>
<li class="chapter" data-level="24.5" data-path="coding-practices.html"><a href="coding-practices.html#roxygen2-1"><i class="fa fa-check"></i><b>24.5</b> Roxygen2</a><ul>
<li class="chapter" data-level="24.5.1" data-path="coding-practices.html"><a href="coding-practices.html#canonical-references"><i class="fa fa-check"></i><b>24.5.1</b> Canonical references:</a></li>
<li class="chapter" data-level="24.5.2" data-path="coding-practices.html"><a href="coding-practices.html#basic-roxygen2-instructions"><i class="fa fa-check"></i><b>24.5.2</b> Basic Roxygen2 instructions:</a></li>
<li class="chapter" data-level="24.5.3" data-path="coding-practices.html"><a href="coding-practices.html#example-1"><i class="fa fa-check"></i><b>24.5.3</b> Example</a></li>
<li class="chapter" data-level="24.5.4" data-path="coding-practices.html"><a href="coding-practices.html#updating-documentation"><i class="fa fa-check"></i><b>24.5.4</b> Updating documentation</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="coding-practices.html"><a href="coding-practices.html#testing"><i class="fa fa-check"></i><b>24.6</b> Testing</a><ul>
<li class="chapter" data-level="24.6.1" data-path="coding-practices.html"><a href="coding-practices.html#rationale"><i class="fa fa-check"></i><b>24.6.1</b> Rationale</a></li>
<li class="chapter" data-level="24.6.2" data-path="coding-practices.html"><a href="coding-practices.html#tests-makes-development-easier-and-less-error-prone"><i class="fa fa-check"></i><b>24.6.2</b> Tests makes development easier and less error prone</a></li>
<li class="chapter" data-level="24.6.3" data-path="coding-practices.html"><a href="coding-practices.html#quick-start"><i class="fa fa-check"></i><b>24.6.3</b> Quick Start:</a></li>
<li class="chapter" data-level="24.6.4" data-path="coding-practices.html"><a href="coding-practices.html#test-files"><i class="fa fa-check"></i><b>24.6.4</b> Test files</a></li>
<li class="chapter" data-level="24.6.5" data-path="coding-practices.html"><a href="coding-practices.html#testing-the-shiny-server"><i class="fa fa-check"></i><b>24.6.5</b> Testing the Shiny Server</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="directory-structure.html"><a href="directory-structure.html"><i class="fa fa-check"></i><b>25</b> Directory structure</a><ul>
<li class="chapter" data-level="25.1" data-path="directory-structure.html"><a href="directory-structure.html#overview-of-pecan-repository-as-of-pecan-1.5.3"><i class="fa fa-check"></i><b>25.1</b> Overview of PEcAn repository as of PEcAn 1.5.3</a></li>
<li class="chapter" data-level="25.2" data-path="directory-structure.html"><a href="directory-structure.html#generic-r-package-structure"><i class="fa fa-check"></i><b>25.2</b> Generic R package structure:</a></li>
</ul></li>
<li class="part"><span><b>VI Reference Materials</b></span></li>
<li class="chapter" data-level="26" data-path="pecan-standard-formats.html"><a href="pecan-standard-formats.html"><i class="fa fa-check"></i><b>26</b> PEcAn standard formats</a><ul>
<li class="chapter" data-level="26.1" data-path="pecan-standard-formats.html"><a href="pecan-standard-formats.html#defining-new-input-formats"><i class="fa fa-check"></i><b>26.1</b> Defining new input formats</a><ul>
<li class="chapter" data-level="26.1.1" data-path="pecan-standard-formats.html"><a href="pecan-standard-formats.html#input-standards"><i class="fa fa-check"></i><b>26.1.1</b> Input Standards</a></li>
<li class="chapter" data-level="26.1.2" data-path="pecan-standard-formats.html"><a href="pecan-standard-formats.html#output-standards"><i class="fa fa-check"></i><b>26.1.2</b> Output Standards</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="pecan-models.html"><a href="pecan-models.html"><i class="fa fa-check"></i><b>27</b> PEcAn Models</a><ul>
<li class="chapter" data-level="27.1" data-path="pecan-models.html"><a href="pecan-models.html#models-biocro"><i class="fa fa-check"></i><b>27.1</b> BioCro</a></li>
<li class="chapter" data-level="27.2" data-path="pecan-models.html"><a href="pecan-models.html#models-clm"><i class="fa fa-check"></i><b>27.2</b> CLM</a></li>
<li class="chapter" data-level="27.3" data-path="pecan-models.html"><a href="pecan-models.html#models-dalec"><i class="fa fa-check"></i><b>27.3</b> DALEC</a></li>
<li class="chapter" data-level="27.4" data-path="pecan-models.html"><a href="pecan-models.html#models-ed"><i class="fa fa-check"></i><b>27.4</b> ED2</a><ul>
<li class="chapter" data-level="27.4.1" data-path="pecan-models.html"><a href="pecan-models.html#introduction-2"><i class="fa fa-check"></i><b>27.4.1</b> Introduction</a></li>
<li class="chapter" data-level="27.4.2" data-path="pecan-models.html"><a href="pecan-models.html#pecan-configuration-file-additions"><i class="fa fa-check"></i><b>27.4.2</b> PEcAn configuration file additions</a></li>
<li class="chapter" data-level="27.4.3" data-path="pecan-models.html"><a href="pecan-models.html#models-ed-pft-configuration"><i class="fa fa-check"></i><b>27.4.3</b> PFT configuration in ED2</a></li>
<li class="chapter" data-level="27.4.4" data-path="pecan-models.html"><a href="pecan-models.html#model-specific-input-files"><i class="fa fa-check"></i><b>27.4.4</b> Model specific input files</a></li>
<li class="chapter" data-level="27.4.5" data-path="pecan-models.html"><a href="pecan-models.html#model-configuration-files"><i class="fa fa-check"></i><b>27.4.5</b> Model configuration files</a></li>
<li class="chapter" data-level="27.4.6" data-path="pecan-models.html"><a href="pecan-models.html#installation-notes"><i class="fa fa-check"></i><b>27.4.6</b> Installation notes</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="pecan-models.html"><a href="pecan-models.html#models-gday"><i class="fa fa-check"></i><b>27.5</b> GDAY</a></li>
<li class="chapter" data-level="27.6" data-path="pecan-models.html"><a href="pecan-models.html#models-linkages"><i class="fa fa-check"></i><b>27.6</b> LINKAGES</a></li>
<li class="chapter" data-level="27.7" data-path="pecan-models.html"><a href="pecan-models.html#models-lpjguess"><i class="fa fa-check"></i><b>27.7</b> LPJ-GUESS</a></li>
<li class="chapter" data-level="27.8" data-path="pecan-models.html"><a href="pecan-models.html#models-maespa"><i class="fa fa-check"></i><b>27.8</b> MAESPA</a></li>
<li class="chapter" data-level="27.9" data-path="pecan-models.html"><a href="pecan-models.html#models-preles"><i class="fa fa-check"></i><b>27.9</b> PRELES</a></li>
<li class="chapter" data-level="27.10" data-path="pecan-models.html"><a href="pecan-models.html#models-sipnet"><i class="fa fa-check"></i><b>27.10</b> SiPNET</a><ul>
<li class="chapter" data-level="27.10.1" data-path="pecan-models.html"><a href="pecan-models.html#download-gfdl"><i class="fa fa-check"></i><b>27.10.1</b> Download GFDL</a></li>
<li class="chapter" data-level="27.10.2" data-path="pecan-models.html"><a href="pecan-models.html#cm3"><i class="fa fa-check"></i><b>27.10.2</b> CM3</a></li>
<li class="chapter" data-level="27.10.3" data-path="pecan-models.html"><a href="pecan-models.html#esm2m-esm2g"><i class="fa fa-check"></i><b>27.10.3</b> ESM2M &amp; ESM2G</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="28" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html"><i class="fa fa-check"></i><b>28</b> Available Meteorological Drivers</a><ul>
<li class="chapter" data-level="28.1" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#ameriflux"><i class="fa fa-check"></i><b>28.1</b> Ameriflux</a></li>
<li class="chapter" data-level="28.2" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#amerifluxlbl"><i class="fa fa-check"></i><b>28.2</b> AmerifluxLBL</a></li>
<li class="chapter" data-level="28.3" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#fluxnet2015"><i class="fa fa-check"></i><b>28.3</b> Fluxnet2015</a></li>
<li class="chapter" data-level="28.4" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#narr"><i class="fa fa-check"></i><b>28.4</b> NARR</a></li>
<li class="chapter" data-level="28.5" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#cruncep"><i class="fa fa-check"></i><b>28.5</b> CRUNCEP</a></li>
<li class="chapter" data-level="28.6" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#cmip5"><i class="fa fa-check"></i><b>28.6</b> CMIP5</a></li>
<li class="chapter" data-level="28.7" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#nldas"><i class="fa fa-check"></i><b>28.7</b> NLDAS</a></li>
<li class="chapter" data-level="28.8" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#gldas"><i class="fa fa-check"></i><b>28.8</b> GLDAS</a></li>
<li class="chapter" data-level="28.9" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#paleon"><i class="fa fa-check"></i><b>28.9</b> PalEON</a></li>
<li class="chapter" data-level="28.10" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#fluxnetlathuile"><i class="fa fa-check"></i><b>28.10</b> FluxnetLaThuile</a></li>
<li class="chapter" data-level="28.11" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#geostreams"><i class="fa fa-check"></i><b>28.11</b> Geostreams</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="docker-index.html"><a href="docker-index.html"><i class="fa fa-check"></i><b>29</b> Docker</a><ul>
<li class="chapter" data-level="29.1" data-path="docker-index.html"><a href="docker-index.html#docker-intro"><i class="fa fa-check"></i><b>29.1</b> Introduction to Docker?</a><ul>
<li class="chapter" data-level="29.1.1" data-path="docker-index.html"><a href="docker-index.html#what-is-docker"><i class="fa fa-check"></i><b>29.1.1</b> What is Docker?</a></li>
<li class="chapter" data-level="29.1.2" data-path="docker-index.html"><a href="docker-index.html#working-with-docker"><i class="fa fa-check"></i><b>29.1.2</b> Working with Docker</a></li>
<li class="chapter" data-level="29.1.3" data-path="docker-index.html"><a href="docker-index.html#docker-compose"><i class="fa fa-check"></i><b>29.1.3</b> <code>docker-compose</code></a></li>
</ul></li>
<li class="chapter" data-level="29.2" data-path="docker-index.html"><a href="docker-index.html#docker-quickstart"><i class="fa fa-check"></i><b>29.2</b> Quickstart for Docker and PEcAn</a><ul>
<li class="chapter" data-level="29.2.1" data-path="docker-index.html"><a href="docker-index.html#install-docker"><i class="fa fa-check"></i><b>29.2.1</b> Install Docker</a></li>
<li class="chapter" data-level="29.2.2" data-path="docker-index.html"><a href="docker-index.html#setup-pecan-using-docker-compose"><i class="fa fa-check"></i><b>29.2.2</b> Setup PEcAn using docker-compose</a></li>
</ul></li>
<li class="chapter" data-level="29.3" data-path="docker-index.html"><a href="docker-index.html#pecan-docker"><i class="fa fa-check"></i><b>29.3</b> PEcAn Docker Architecture</a><ul>
<li class="chapter" data-level="29.3.1" data-path="docker-index.html"><a href="docker-index.html#pecan-docker-overview"><i class="fa fa-check"></i><b>29.3.1</b> Overview</a></li>
<li class="chapter" data-level="29.3.2" data-path="docker-index.html"><a href="docker-index.html#pecan-docker-compose"><i class="fa fa-check"></i><b>29.3.2</b> PEcAn’s <code>docker-compose</code></a></li>
</ul></li>
<li class="chapter" data-level="29.4" data-path="docker-index.html"><a href="docker-index.html#model-docker"><i class="fa fa-check"></i><b>29.4</b> Models using Docker</a><ul>
<li class="chapter" data-level="29.4.1" data-path="docker-index.html"><a href="docker-index.html#model-docker-json-file"><i class="fa fa-check"></i><b>29.4.1</b> Model information</a></li>
<li class="chapter" data-level="29.4.2" data-path="docker-index.html"><a href="docker-index.html#model-docker-Dockerfile"><i class="fa fa-check"></i><b>29.4.2</b> Model build</a></li>
<li class="chapter" data-level="29.4.3" data-path="docker-index.html"><a href="docker-index.html#common-problems"><i class="fa fa-check"></i><b>29.4.3</b> Common problems</a></li>
</ul></li>
<li class="chapter" data-level="29.5" data-path="docker-index.html"><a href="docker-index.html#docker-build-images"><i class="fa fa-check"></i><b>29.5</b> Building and modifying images</a><ul>
<li class="chapter" data-level="29.5.1" data-path="docker-index.html"><a href="docker-index.html#docker-local-devel"><i class="fa fa-check"></i><b>29.5.1</b> Local development and testing with Docker</a></li>
<li class="chapter" data-level="29.5.2" data-path="docker-index.html"><a href="docker-index.html#docker-troubleshooting"><i class="fa fa-check"></i><b>29.5.2</b> Troubleshooting Docker</a></li>
</ul></li>
<li class="chapter" data-level="29.6" data-path="docker-index.html"><a href="docker-index.html#docker-migrate"><i class="fa fa-check"></i><b>29.6</b> Migrating PEcAn from VM to Docker</a><ul>
<li class="chapter" data-level="29.6.1" data-path="docker-index.html"><a href="docker-index.html#running-bety-as-a-docker-container"><i class="fa fa-check"></i><b>29.6.1</b> Running BETY as a docker container</a></li>
<li class="chapter" data-level="29.6.2" data-path="docker-index.html"><a href="docker-index.html#using-the-pecan-download.file-function"><i class="fa fa-check"></i><b>29.6.2</b> Using the PEcAn download.file() function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>30</b> SHINY</a><ul>
<li class="chapter" data-level="30.0.1" data-path="shiny.html"><a href="shiny.html#debugging-shiny-apps"><i class="fa fa-check"></i><b>30.0.1</b> Debugging Shiny Apps</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>31</b> Debugging</a><ul>
<li class="chapter" data-level="31.0.1" data-path="debugging.html"><a href="debugging.html#using-testsworkflow.r"><i class="fa fa-check"></i><b>31.0.1</b> Using <code>tests/workflow.R</code></a></li>
<li class="chapter" data-level="31.0.2" data-path="debugging.html"><a href="debugging.html#useful-scripts"><i class="fa fa-check"></i><b>31.0.2</b> Useful scripts</a></li>
<li class="chapter" data-level="31.1" data-path="debugging.html"><a href="debugging.html#troubleshooting-pecan"><i class="fa fa-check"></i><b>31.1</b> Troubleshooting PEcAn</a><ul>
<li class="chapter" data-level="31.1.1" data-path="debugging.html"><a href="debugging.html#cookies-and-pecan-web-pages"><i class="fa fa-check"></i><b>31.1.1</b> Cookies and pecan web pages</a></li>
<li class="chapter" data-level="31.1.2" data-path="debugging.html"><a href="debugging.html#warning-mkdir-function.mkdir-no-such-file-or-directory"><i class="fa fa-check"></i><b>31.1.2</b> <code>Warning: mkdir() [function.mkdir]: No such file or directory</code></a></li>
<li class="chapter" data-level="31.1.3" data-path="debugging.html"><a href="debugging.html#after-creating-a-new-pft-the-tag-for-pft-not-passed-to-config.xml-in-ed"><i class="fa fa-check"></i><b>31.1.3</b> After creating a new PFT the <num> tag for PFT not passed to config.xml in ED</a></li>
</ul></li>
<li class="chapter" data-level="31.2" data-path="debugging.html"><a href="debugging.html#pecan-project-use-to-teach-ecological-model-data-synthesis"><i class="fa fa-check"></i><b>31.2</b> PEcAn Project use to teach Ecological model-data synthesis</a><ul>
<li class="chapter" data-level="31.2.1" data-path="debugging.html"><a href="debugging.html#university-classes"><i class="fa fa-check"></i><b>31.2.1</b> University classes</a></li>
<li class="chapter" data-level="31.2.2" data-path="debugging.html"><a href="debugging.html#summer-courses-workshops"><i class="fa fa-check"></i><b>31.2.2</b> Summer Courses / Workshops</a></li>
<li class="chapter" data-level="31.2.3" data-path="debugging.html"><a href="debugging.html#selected-publications"><i class="fa fa-check"></i><b>31.2.3</b> Selected Publications</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="32" data-path="rabbitmq.html"><a href="rabbitmq.html"><i class="fa fa-check"></i><b>32</b> RabbitMQ</a><ul>
<li class="chapter" data-level="32.1" data-path="rabbitmq.html"><a href="rabbitmq.html#rabbitmq-basics-sender"><i class="fa fa-check"></i><b>32.1</b> Producer – <code>sender.py</code></a></li>
<li class="chapter" data-level="32.2" data-path="rabbitmq.html"><a href="rabbitmq.html#rabbitmq-basics-receiver"><i class="fa fa-check"></i><b>32.2</b> Consumer – <code>receiver.py</code></a></li>
<li class="chapter" data-level="32.3" data-path="rabbitmq.html"><a href="rabbitmq.html#rabbitmq-web"><i class="fa fa-check"></i><b>32.3</b> RabbitMQ and the PEcAn web interface</a></li>
<li class="chapter" data-level="32.4" data-path="rabbitmq.html"><a href="rabbitmq.html#rabbitmq-xml"><i class="fa fa-check"></i><b>32.4</b> RabbitMQ in the PEcAn XML</a></li>
<li class="chapter" data-level="32.5" data-path="rabbitmq.html"><a href="rabbitmq.html#rabbitmq-dockerfile"><i class="fa fa-check"></i><b>32.5</b> RabbitMQ configuration in Dockerfiles</a></li>
<li class="chapter" data-level="32.6" data-path="rabbitmq.html"><a href="rabbitmq.html#rabbitmq-case-study"><i class="fa fa-check"></i><b>32.6</b> Case study: PEcAn web interface</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="database.html"><a href="database.html"><i class="fa fa-check"></i><b>33</b> BETY Database Administration</a><ul>
<li class="chapter" data-level="33.1" data-path="database.html"><a href="database.html#database-setup"><i class="fa fa-check"></i><b>33.1</b> Best practices</a></li>
<li class="chapter" data-level="33.2" data-path="database.html"><a href="database.html#backup-of-bety-database"><i class="fa fa-check"></i><b>33.2</b> Backup of BETY database</a></li>
<li class="chapter" data-level="33.3" data-path="database.html"><a href="database.html#restore-of-bety-database"><i class="fa fa-check"></i><b>33.3</b> Restore of BETY database</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="bookediting.html"><a href="bookediting.html"><i class="fa fa-check"></i><b>34</b> Editing this book</a></li>
<li class="chapter" data-level="35" data-path="data-assimilation-with-dart.html"><a href="data-assimilation-with-dart.html"><i class="fa fa-check"></i><b>35</b> Data assimilation with DART</a></li>
<li class="part"><span><b>VII Demos and Vignettes</b></span></li>
<li class="chapter" data-level="36" data-path="pecan-hands-on-demo-01-basic-run.html"><a href="pecan-hands-on-demo-01-basic-run.html"><i class="fa fa-check"></i><b>36</b> PEcAn Hands-On Demo 01: Basic Run</a><ul>
<li class="chapter" data-level="36.1" data-path="pecan-hands-on-demo-01-basic-run.html"><a href="pecan-hands-on-demo-01-basic-run.html#objective"><i class="fa fa-check"></i><b>36.1</b> Objective</a><ul>
<li class="chapter" data-level="36.1.1" data-path="pecan-hands-on-demo-01-basic-run.html"><a href="pecan-hands-on-demo-01-basic-run.html#pecan-url"><i class="fa fa-check"></i><b>36.1.1</b> PEcAn URL</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="pecan-hands-on-demo-01-basic-run.html"><a href="pecan-hands-on-demo-01-basic-run.html#basic-run"><i class="fa fa-check"></i><b>36.2</b> Basic Run</a><ul>
<li class="chapter" data-level="36.2.1" data-path="pecan-hands-on-demo-01-basic-run.html"><a href="pecan-hands-on-demo-01-basic-run.html#start-pecan-1"><i class="fa fa-check"></i><b>36.2.1</b> Start PEcAn:</a></li>
<li class="chapter" data-level="36.2.2" data-path="pecan-hands-on-demo-01-basic-run.html"><a href="pecan-hands-on-demo-01-basic-run.html#site-selection"><i class="fa fa-check"></i><b>36.2.2</b> Site Selection</a></li>
<li class="chapter" data-level="36.2.3" data-path="pecan-hands-on-demo-01-basic-run.html"><a href="pecan-hands-on-demo-01-basic-run.html#host"><i class="fa fa-check"></i><b>36.2.3</b> Host</a></li>
<li class="chapter" data-level="36.2.4" data-path="pecan-hands-on-demo-01-basic-run.html"><a href="pecan-hands-on-demo-01-basic-run.html#mode"><i class="fa fa-check"></i><b>36.2.4</b> Mode</a></li>
<li class="chapter" data-level="36.2.5" data-path="pecan-hands-on-demo-01-basic-run.html"><a href="pecan-hands-on-demo-01-basic-run.html#site-group"><i class="fa fa-check"></i><b>36.2.5</b> Site Group</a></li>
<li class="chapter" data-level="36.2.6" data-path="pecan-hands-on-demo-01-basic-run.html"><a href="pecan-hands-on-demo-01-basic-run.html#conversion"><i class="fa fa-check"></i><b>36.2.6</b> Conversion:</a></li>
<li class="chapter" data-level="36.2.7" data-path="pecan-hands-on-demo-01-basic-run.html"><a href="pecan-hands-on-demo-01-basic-run.html#site"><i class="fa fa-check"></i><b>36.2.7</b> Site:</a></li>
<li class="chapter" data-level="36.2.8" data-path="pecan-hands-on-demo-01-basic-run.html"><a href="pecan-hands-on-demo-01-basic-run.html#model-run-workflow"><i class="fa fa-check"></i><b>36.2.8</b> Model Run Workflow</a></li>
</ul></li>
<li class="chapter" data-level="36.3" data-path="pecan-hands-on-demo-01-basic-run.html"><a href="pecan-hands-on-demo-01-basic-run.html#next-steps"><i class="fa fa-check"></i><b>36.3</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="demo-02-sensitivity-and-uncertainty-analysis.html"><a href="demo-02-sensitivity-and-uncertainty-analysis.html"><i class="fa fa-check"></i><b>37</b> Demo 02: Sensitivity and Uncertainty Analysis</a><ul>
<li class="chapter" data-level="37.1" data-path="demo-02-sensitivity-and-uncertainty-analysis.html"><a href="demo-02-sensitivity-and-uncertainty-analysis.html#run-specification-1"><i class="fa fa-check"></i><b>37.1</b> Run Specification</a><ul>
<li class="chapter" data-level="37.1.1" data-path="demo-02-sensitivity-and-uncertainty-analysis.html"><a href="demo-02-sensitivity-and-uncertainty-analysis.html#additional-outputs"><i class="fa fa-check"></i><b>37.1.1</b> Additional Outputs:</a></li>
<li class="chapter" data-level="37.1.2" data-path="demo-02-sensitivity-and-uncertainty-analysis.html"><a href="demo-02-sensitivity-and-uncertainty-analysis.html#run-id"><i class="fa fa-check"></i><b>37.1.2</b> 1. Run ID:</a></li>
<li class="chapter" data-level="37.1.3" data-path="demo-02-sensitivity-and-uncertainty-analysis.html"><a href="demo-02-sensitivity-and-uncertainty-analysis.html#inputs-3"><i class="fa fa-check"></i><b>37.1.3</b> 2. Inputs:</a></li>
<li class="chapter" data-level="37.1.4" data-path="demo-02-sensitivity-and-uncertainty-analysis.html"><a href="demo-02-sensitivity-and-uncertainty-analysis.html#outputs"><i class="fa fa-check"></i><b>37.1.4</b> 3. Outputs:</a></li>
<li class="chapter" data-level="37.1.5" data-path="demo-02-sensitivity-and-uncertainty-analysis.html"><a href="demo-02-sensitivity-and-uncertainty-analysis.html#pfts"><i class="fa fa-check"></i><b>37.1.5</b> 4. PFTs:</a></li>
<li class="chapter" data-level="37.1.6" data-path="demo-02-sensitivity-and-uncertainty-analysis.html"><a href="demo-02-sensitivity-and-uncertainty-analysis.html#pecan-files"><i class="fa fa-check"></i><b>37.1.6</b> PEcAn Files:</a></li>
</ul></li>
<li class="chapter" data-level="37.2" data-path="demo-02-sensitivity-and-uncertainty-analysis.html"><a href="demo-02-sensitivity-and-uncertainty-analysis.html#global-sensitivity-shiny"><i class="fa fa-check"></i><b>37.2</b> Global Sensitivity: Shiny</a><ul>
<li class="chapter" data-level="37.2.1" data-path="demo-02-sensitivity-and-uncertainty-analysis.html"><a href="demo-02-sensitivity-and-uncertainty-analysis.html#next-steps-1"><i class="fa fa-check"></i><b>37.2.1</b> Next Steps</a></li>
<li class="chapter" data-level="37.2.2" data-path="demo-02-sensitivity-and-uncertainty-analysis.html"><a href="demo-02-sensitivity-and-uncertainty-analysis.html#assimilation-by-hand"><i class="fa fa-check"></i><b>37.2.2</b> Assimilation ‘by hand’</a></li>
<li class="chapter" data-level="37.2.3" data-path="demo-02-sensitivity-and-uncertainty-analysis.html"><a href="demo-02-sensitivity-and-uncertainty-analysis.html#mcmc-concepts"><i class="fa fa-check"></i><b>37.2.3</b> MCMC Concepts</a></li>
<li class="chapter" data-level="37.2.4" data-path="demo-02-sensitivity-and-uncertainty-analysis.html"><a href="demo-02-sensitivity-and-uncertainty-analysis.html#more-info-about-tools-analyses-and-specific-tasks"><i class="fa fa-check"></i><b>37.2.4</b> More info about tools, analyses, and specific tasks…</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="38" data-path="pecan-testing-the-sensitivity-analysis-against-observations.html"><a href="pecan-testing-the-sensitivity-analysis-against-observations.html"><i class="fa fa-check"></i><b>38</b> PEcAn: Testing the Sensitivity Analysis Against Observations&quot;</a><ul>
<li class="chapter" data-level="38.0.1" data-path="pecan-testing-the-sensitivity-analysis-against-observations.html"><a href="pecan-testing-the-sensitivity-analysis-against-observations.html#author-ankur-desai"><i class="fa fa-check"></i><b>38.0.1</b> Author: “Ankur Desai”</a></li>
<li class="chapter" data-level="38.1" data-path="pecan-testing-the-sensitivity-analysis-against-observations.html"><a href="pecan-testing-the-sensitivity-analysis-against-observations.html#introduction-3"><i class="fa fa-check"></i><b>38.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="simple-model-data-comparisons.html"><a href="simple-model-data-comparisons.html"><i class="fa fa-check"></i><b>39</b> Simple Model-Data Comparisons</a><ul>
<li class="chapter" data-level="39.0.1" data-path="simple-model-data-comparisons.html"><a href="simple-model-data-comparisons.html#author-istem-fer-tess-mccabe"><i class="fa fa-check"></i><b>39.0.1</b> Author: Istem Fer, Tess McCabe</a></li>
<li class="chapter" data-level="39.1" data-path="simple-model-data-comparisons.html"><a href="simple-model-data-comparisons.html#starting-rstudio-server"><i class="fa fa-check"></i><b>39.1</b> Starting RStudio Server</a></li>
<li class="chapter" data-level="39.2" data-path="simple-model-data-comparisons.html"><a href="simple-model-data-comparisons.html#read-in-settings-from-an-xml-file"><i class="fa fa-check"></i><b>39.2</b> Read in settings From an XML file</a></li>
<li class="chapter" data-level="39.3" data-path="simple-model-data-comparisons.html"><a href="simple-model-data-comparisons.html#read-in-model-output-from-specific-variables"><i class="fa fa-check"></i><b>39.3</b> Read in model output from specific variables</a></li>
<li class="chapter" data-level="39.4" data-path="simple-model-data-comparisons.html"><a href="simple-model-data-comparisons.html#compare-model-to-flux-observations"><i class="fa fa-check"></i><b>39.4</b> Compare model to flux observations</a></li>
</ul></li>
<li class="chapter" data-level="40" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html"><i class="fa fa-check"></i><b>40</b> Parameter Data Assimilation</a><ul>
<li class="chapter" data-level="40.1" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html#objectives"><i class="fa fa-check"></i><b>40.1</b> Objectives</a></li>
<li class="chapter" data-level="40.2" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html#larger-context"><i class="fa fa-check"></i><b>40.2</b> Larger Context</a></li>
<li class="chapter" data-level="40.3" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html#connect-to-rstudio"><i class="fa fa-check"></i><b>40.3</b> Connect to Rstudio</a></li>
<li class="chapter" data-level="40.4" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html#defining-variables"><i class="fa fa-check"></i><b>40.4</b> Defining variables</a></li>
<li class="chapter" data-level="40.5" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html#initial-ensemble-analysis"><i class="fa fa-check"></i><b>40.5</b> Initial Ensemble Analysis</a><ul>
<li class="chapter" data-level="40.5.1" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html#questions"><i class="fa fa-check"></i><b>40.5.1</b> Questions:</a></li>
</ul></li>
<li class="chapter" data-level="40.6" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html#choosing-parameters"><i class="fa fa-check"></i><b>40.6</b> Choosing Parameters</a><ul>
<li class="chapter" data-level="40.6.1" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html#questions-1"><i class="fa fa-check"></i><b>40.6.1</b> Questions:</a></li>
</ul></li>
<li class="chapter" data-level="40.7" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html#editing-pecan-settings"><i class="fa fa-check"></i><b>40.7</b> Editing PEcAn settings</a></li>
<li class="chapter" data-level="40.8" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html#investigating-pecan-function-pda.emulator-optional"><i class="fa fa-check"></i><b>40.8</b> Investigating PEcAn function pda.emulator (optional)</a></li>
<li class="chapter" data-level="40.9" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html#running-a-demo-pda"><i class="fa fa-check"></i><b>40.9</b> Running a demo PDA</a></li>
<li class="chapter" data-level="40.10" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html#outputs-from-pecans-parameter-data-assimilation"><i class="fa fa-check"></i><b>40.10</b> Outputs from PEcAn’s Parameter Data Assimilation</a><ul>
<li class="chapter" data-level="40.10.1" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html#questions-2"><i class="fa fa-check"></i><b>40.10.1</b> Questions:</a></li>
</ul></li>
<li class="chapter" data-level="40.11" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html#post-pda-analyses"><i class="fa fa-check"></i><b>40.11</b> Post-PDA analyses</a><ul>
<li class="chapter" data-level="40.11.1" data-path="parameter-data-assimilation.html"><a href="parameter-data-assimilation.html#questions-3"><i class="fa fa-check"></i><b>40.11.1</b> Questions:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="41" data-path="state-variable-data-assimilation.html"><a href="state-variable-data-assimilation.html"><i class="fa fa-check"></i><b>41</b> State-Variable Data Assimilation</a><ul>
<li class="chapter" data-level="41.1" data-path="state-variable-data-assimilation.html"><a href="state-variable-data-assimilation.html#objectives-1"><i class="fa fa-check"></i><b>41.1</b> Objectives:</a></li>
<li class="chapter" data-level="41.2" data-path="state-variable-data-assimilation.html"><a href="state-variable-data-assimilation.html#overview-1"><i class="fa fa-check"></i><b>41.2</b> Overview:</a><ul>
<li class="chapter" data-level="41.2.1" data-path="state-variable-data-assimilation.html"><a href="state-variable-data-assimilation.html#initial-run"><i class="fa fa-check"></i><b>41.2.1</b> Initial Run</a></li>
<li class="chapter" data-level="41.2.2" data-path="state-variable-data-assimilation.html"><a href="state-variable-data-assimilation.html#settings-1"><i class="fa fa-check"></i><b>41.2.2</b> Settings:</a></li>
<li class="chapter" data-level="41.2.3" data-path="state-variable-data-assimilation.html"><a href="state-variable-data-assimilation.html#loading-data-1"><i class="fa fa-check"></i><b>41.2.3</b> Loading data</a></li>
<li class="chapter" data-level="41.2.4" data-path="state-variable-data-assimilation.html"><a href="state-variable-data-assimilation.html#estimating-tree-level-data-uncertainties"><i class="fa fa-check"></i><b>41.2.4</b> Estimating tree-level data uncertainties</a></li>
</ul></li>
<li class="chapter" data-level="41.3" data-path="state-variable-data-assimilation.html"><a href="state-variable-data-assimilation.html#allometric-equations"><i class="fa fa-check"></i><b>41.3</b> Allometric equations</a></li>
<li class="chapter" data-level="41.4" data-path="state-variable-data-assimilation.html"><a href="state-variable-data-assimilation.html#estimate-stand-level-npp"><i class="fa fa-check"></i><b>41.4</b> Estimate stand-level NPP</a></li>
<li class="chapter" data-level="41.5" data-path="state-variable-data-assimilation.html"><a href="state-variable-data-assimilation.html#build-initial-conditions"><i class="fa fa-check"></i><b>41.5</b> Build Initial Conditions</a></li>
<li class="chapter" data-level="41.6" data-path="state-variable-data-assimilation.html"><a href="state-variable-data-assimilation.html#load-priors"><i class="fa fa-check"></i><b>41.6</b> Load Priors</a></li>
<li class="chapter" data-level="41.7" data-path="state-variable-data-assimilation.html"><a href="state-variable-data-assimilation.html#ensemble-kalman-filter"><i class="fa fa-check"></i><b>41.7</b> Ensemble Kalman Filter</a></li>
<li class="chapter" data-level="41.8" data-path="state-variable-data-assimilation.html"><a href="state-variable-data-assimilation.html#finishing-up"><i class="fa fa-check"></i><b>41.8</b> Finishing up</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="data-assimilation-concepts.html"><a href="data-assimilation-concepts.html"><i class="fa fa-check"></i><b>42</b> Data Assimilation Concepts&quot;</a><ul>
<li class="chapter" data-level="42.1" data-path="data-assimilation-concepts.html"><a href="data-assimilation-concepts.html#fitting-the-model"><i class="fa fa-check"></i><b>42.1</b> Fitting the model</a></li>
<li class="chapter" data-level="42.2" data-path="data-assimilation-concepts.html"><a href="data-assimilation-concepts.html#whats-going-on"><i class="fa fa-check"></i><b>42.2</b> What’s going on</a></li>
<li class="chapter" data-level="42.3" data-path="data-assimilation-concepts.html"><a href="data-assimilation-concepts.html#evaluating-the-model-output"><i class="fa fa-check"></i><b>42.3</b> Evaluating the model output</a></li>
<li class="chapter" data-level="42.4" data-path="data-assimilation-concepts.html"><a href="data-assimilation-concepts.html#additional-information"><i class="fa fa-check"></i><b>42.4</b> Additional information</a></li>
<li class="chapter" data-level="42.5" data-path="data-assimilation-concepts.html"><a href="data-assimilation-concepts.html#citations"><i class="fa fa-check"></i><b>42.5</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="43" data-path="pecanapi-vignette.html"><a href="pecanapi-vignette.html"><i class="fa fa-check"></i><b>43</b> Introduction to the PEcAn R API</a><ul>
<li class="chapter" data-level="43.1" data-path="pecanapi-vignette.html"><a href="pecanapi-vignette.html#introduction-4"><i class="fa fa-check"></i><b>43.1</b> Introduction</a></li>
<li class="chapter" data-level="43.2" data-path="pecanapi-vignette.html"><a href="pecanapi-vignette.html#pecanapi-setup"><i class="fa fa-check"></i><b>43.2</b> Initial setup</a></li>
<li class="chapter" data-level="43.3" data-path="pecanapi-vignette.html"><a href="pecanapi-vignette.html#pecanapi-workflow"><i class="fa fa-check"></i><b>43.3</b> Registering a workflow with the database</a></li>
<li class="chapter" data-level="43.4" data-path="pecanapi-vignette.html"><a href="pecanapi-vignette.html#pecanapi-settings"><i class="fa fa-check"></i><b>43.4</b> Building a settings object</a></li>
<li class="chapter" data-level="43.5" data-path="pecanapi-vignette.html"><a href="pecanapi-vignette.html#pecanapi-submit"><i class="fa fa-check"></i><b>43.5</b> Submitting a run</a></li>
<li class="chapter" data-level="43.6" data-path="pecanapi-vignette.html"><a href="pecanapi-vignette.html#pecanapi-output"><i class="fa fa-check"></i><b>43.6</b> Processing output</a></li>
</ul></li>
<li class="part"><span><b>VIII Appendix</b></span></li>
<li class="chapter" data-level="44" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>44</b> FAQ</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Predictive Ecosystem Analyzer</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="docker-index" class="section level1">
<h1><span class="header-section-number">29</span> Docker</h1>
<p>This chapter describes the PEcAn Docker container infrastructure.
It contains the following sections:</p>
<ul>
<li><a href="docker-index.html#docker-intro">Introduction to Docker</a> – Brief introduction to Docker and <code>docker-compose</code></li>
<li><a href="docker-index.html#docker-quickstart">Docker quickstart</a> – Brief tutorial for setting up a Docker-based PEcAn instance</li>
<li><a href="docker-index.html#pecan-docker">PEcAn Docker infrastructure</a> – Detailed description of the containers comprising the PEcAn Docker-based infrastructure</li>
<li><a href="docker-index.html#model-docker">Dockerfiles for models</a> – General guide for writing Dockerfiles for new models</li>
<li><a href="docker-index.html#docker-migrate">Migrating from VM to Docker</a> – Steps to migrate from running PEcAn on a VM to a docker.</li>
</ul>

<div id="docker-intro" class="section level2">
<h2><span class="header-section-number">29.1</span> Introduction to Docker?</h2>
<div id="what-is-docker" class="section level3">
<h3><span class="header-section-number">29.1.1</span> What is Docker?</h3>
<p>For a quick and accessible introduction to Docker, we suggest this YouTube video: <a href="https://www.youtube.com/watch?v=YFl2mCHdv24">Learn Docker in 12 Minutes</a>.</p>
<p>For more comprehensive Docker documentation, we refer you to the <a href="https://docs.docker.com/">Docker documentation website</a>.</p>
<p>For a useful analogy for Docker containerization, we refer you to the webcomic <a href="https://xkcd.com/1988/">xkcd</a>.</p>
<p>Docker is a technology for encapsulating software in “containers”, somewhat similarly to virtual machines.
Like virtual machines, Docker containers facilitate software distribution by bundling the software with all of its dependencies in a single location.
Unlike virtual machines, Docker containers are meant to only run a single service or process and are build on top of existing services provided by the host OS (such as disk access, networking, memory management etc.).</p>
<p>In Docker, an <strong>image</strong> refers to a binary snapshot of a piece of software and all of its dependencies.
A <strong>container</strong> refers to a running instance of a particular image.
A good rule of thumb is that each container should be responsible for no more than one running process.
A software <strong>stack</strong> refers to a collection of containers, each responsible for its own process, working together to power a particular application.
Docker makes it easy to run multiple software stacks at the same time in parallel on the same machine.
Stacks can be given a unique name, which is passed along as a prefix to all their containers.
Inside these stacks, containers can communicate using generic names not prefixed with the stack name, making it easy to deploy multiple stacks with the same internal configuration.
Containers within the same stack communicate with each other via a common <strong>network</strong>.
Like virtual machines or system processes, Docker stacks can also be instructed to open specific ports to facilitate communication with the host and other machines.</p>
<p>The PEcAn database BETY provides an instructive case-study.
BETY is comprised of two core processes – a PostgreSQL database, and a web-based front-end to that database (Apache web server with Ruby on Rails).
Running BETY as a “Dockerized” application therefore involves two containers – one for the PostgreSQL database, and one for the web server.
We could build these containers ourselves by starting from a container with nothing but the essentials of a particular operating system, but we can save some time and effort by starting with an <a href="https://hub.docker.com/_/postgres/">existing image for PostgreSQL</a> from Docker Hub.
When starting a Dockerized BETY, we start the PostgreSQL container first, then start the BETY container telling it how to communicate with the PostgreSQL container.
To upgrade an existing BETY instance, we stop the BETY container, download the latest version, tell it to upgrade the database, and re-start the BETY container.
There is no need to install new dependencies for BETY since they are all shipped as part of the container.</p>
<p>The PEcAn Docker architecture is designed to facilitate installation and maintenance on a variety of systems by eliminating the need to install and maintain complex system dependencies (such as PostgreSQL, Apache web server, and Shiny server).
Furthermore, using separate Docker containers for each ecosystem model helps avoid clashes between different software version requirements of different models (e.g. some models require GCC &lt;5.0, while others may require GCC &gt;=5.0).</p>
<p>The full PEcAn Docker stack is described in more detail in the <a href="docker-index.html#pecan-docker">next section</a>.</p>
</div>
<div id="working-with-docker" class="section level3">
<h3><span class="header-section-number">29.1.2</span> Working with Docker</h3>
<p>To run an image, you can use the Docker command line interface.
For example, the following runs a PostgreSQL image based on the <a href="https://hub.docker.com/r/mdillon/postgis/">pre-existing PostGIS image</a> by <code>mdillon</code>:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">docker</span> run \
    --detach \
    --rm \
    --name postgresql \
    --network pecan \
    --publish 9876:5432 \
    --volume <span class="va">${PWD}</span>/postgres:/var/lib/postgresql/data \
    mdillon/postgis:9.6-alpine</code></pre>
<p>This will start the PostgreSQL+PostGIS container.
The following options were used:</p>
<ul>
<li><code>--detach</code> makes the container run in the background.</li>
<li><code>--rm</code> removes the container when it is finished (make sure to use the volume below).</li>
<li><code>--name</code> the name of the container, also the hostname of the container which can be used by other docker containers in the same network inside docker.</li>
<li><code>--network pecan</code> the network that the container should be running in, this leverages of network isolation in docker and allows this container to be connected to by others using the postgresql hostname.</li>
<li><code>--publish</code> exposes the port to the outside world, this is like ssh, and maps port 9876 to port 5432 in the docker container</li>
<li><code>--volume</code> maps a folder on your local machine to the machine in the container. This allows you to save data on your local machine.</li>
<li><code>mdillon/postgis:9.6-alpine</code> is the actual image that will be run, in this case it comes from the group/person mdillon, the container is postgis and the version 9.6-alpine (version 9.6 build on alpine linux).</li>
</ul>
<p>Other options that might be used:</p>
<ul>
<li><code>--tty</code> allocate a pseudo-TTY to send stdout and stderr back to the console.</li>
<li><code>--interactive</code> keeps stdin open so the user can interact with the application running.</li>
<li><code>--env</code> sets environment variables, these are often used to change the behavior of the docker container.</li>
</ul>
<p>To see a list of all running containers you can use the following command:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">docker</span> ps</code></pre>
<p>To see the log files of this container you use the following command (you can either use their name or id as returned by <code>docker ps</code>). The <code>-f</code> flag will follow the <code>stdout</code>/<code>stderr</code> from the container, use <code>Ctrl-C</code> to stop following the <code>stdout</code>/<code>stderr</code>.</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">docker</span> logs -f postgresql</code></pre>
<p>To stop a running container use:</p>
<pre><code>docker stop postgresql</code></pre>
<p>Containers that are running in the foreground (without the <code>--detach</code>) can be stopped by pressing <code>Ctrl-C</code>. Any containers running in the background (with <code>--detach</code>) will continue running until the machine is restarted or the container is stopped using <code>docker stop</code>.</p>
</div>
<div id="docker-compose" class="section level3">
<h3><span class="header-section-number">29.1.3</span> <code>docker-compose</code></h3>
<p>For a quick introduction to <code>docker-compose</code>, we recommend the following YouTube video: <a href="https://www.youtube.com/watch?v=Qw9zlE3t8Ko">Docker Compose in 12 Minutes</a>.</p>
<p>The complete <code>docker-compose</code> references can be found on the <a href="https://docs.docker.com/compose/">Docker documentation website</a>.</p>
<p><code>docker-compose</code> provides a convenient way to configure and run a multi-container Docker stack.
Basically, a <code>docker-compose</code> setup consists of a list of containers and their configuration parameters, which are then internally converted into a bunch of <code>docker</code> commands.
To configure BETY as described above, we can use a <code>docker-compose.yml</code> file like the following:</p>
<pre class="sourceCode yaml"><code class="sourceCode yaml"><span class="fu">version:</span><span class="at"> </span><span class="st">&quot;3&quot;</span>
<span class="fu">services:</span>
  <span class="fu">postgres:</span>
    <span class="fu">image:</span><span class="at"> mdillon/postgis:9.5</span>
  <span class="fu">bety:</span>
    <span class="fu">image:</span><span class="at"> pecan/bety</span>
    <span class="fu">depends_on:</span>
      <span class="kw">-</span> postgres</code></pre>
<p>This simple file allows us to bring up a full BETY application with both database and BETY application. The BETY app will not be brought up until the database container has started.</p>
<p>You can now start this application by changing into the same directory as the <code>docker-compose.yml</code> file (<code>cd /path/to/file</code>) and then running:</p>
<pre><code>docker-compose up</code></pre>
<p>This will start the application, and you will see the log files for the 2 different containers.</p>

</div>
</div>
<div id="docker-quickstart" class="section level2">
<h2><span class="header-section-number">29.2</span> Quickstart for Docker and PEcAn</h2>
<p>This is a short documentation on how to start with Docker and PEcAn. This will not go into much detail about about how to use docker.</p>
<div id="install-docker" class="section level3">
<h3><span class="header-section-number">29.2.1</span> Install Docker</h3>
<p>You will need to install docker first. See <a href="https://www.docker.com/community-edition#/download" class="uri">https://www.docker.com/community-edition#/download</a></p>
<p>Once Docker is installed, make sure it is running.
To test that Docker is installed and running, open a terminal and run the following commands:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">docker</span> run hello-world</code></pre>
<p>If successful, this should return a message starting with <code>&quot;Hello from Docker!&quot;</code>.
If this doesn’t work, there is something wrong with your configuration.
Refer to the Docker documentation for debugging.</p>
<p>NOTE: Depending on how Docker is installed and configured, you may have to run this command as <code>sudo</code>.
Try running the command without <code>sudo</code> first.
If that fails, but running as <code>sudo</code> succeeds, see <a href="https://docs.docker.com/install/linux/linux-postinstall/">these instructions</a> for steps to use Docker as a non-root user.</p>
</div>
<div id="setup-pecan-using-docker-compose" class="section level3">
<h3><span class="header-section-number">29.2.2</span> Setup PEcAn using docker-compose</h3>
<p>The PEcAn Docker stack is configured using a <code>docker-compose.yml</code> file (see also <a href="docker-index.html#docker-compose"><code>docker-compose</code></a>).
If you cloned the PEcAn source from GitHub, you can find this file in the root directory of the repository.
Alternatively, if you do not want to clone the PEcAn source, you can download just this file directly from GitHub <a href="https://github.com/PecanProject/pecan/blob/develop/docker-compose.yml">here</a>. (NOTE that this is the latest, <code>develop</code> branch version. If you want a specific release, you should change the branch accordingly.).</p>
<p>The following instructions assume you are in the same directory as the file (if not, <code>cd</code> into it) and that the file is called <code>docker-compose.yml</code>.
The <code>docker-compose</code> commands assume this.
If you want to explicitly point <code>docker-compose</code> to a specific file, you can do so by calling all commands as <code>docker-compose -f /path/to/my-docker-compose.yml ...other options...</code>.
(NOTE that this <code>-f</code> option must go <em>immediately</em> after <code>docker-compose</code>. More generally, <code>docker-compose</code> options are very sensitive to their location relative to other commands in the same line – that is, <code>docker-compose -f /my/docker-compose.yml -p pecan up -d postgres</code> is <em>not</em> the same as <code>docker-compose -d postgres -p pecan up -f /my/docker-compose.yml</code>. If expected ever don’t seem to be working, check that the arguments are in the right order.)</p>
<div id="pecan-docker-quickstart-init" class="section level4">
<h4><span class="header-section-number">29.2.2.1</span> Initialize the PEcAn database (first time only)</h4>
<p>The commands described in this section will set up the PEcAn database (BETY) and pre-load it with some common “default” data.</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">docker-compose</span> -p pecan up -d postgres

<span class="co"># If you have a custom docker-compose file:</span>
<span class="co"># docker-compose -f /path/to/my-docker-compose.yml -p pecan up -d postgres</span></code></pre>
<p>The breakdown of this command is as follows:</p>
<ul>
<li><code>-p pecan</code> – This tells <code>docker-compose</code> to do all of this as part of a “project” <code>-p</code> we’ll call <code>pecan</code>. By default, the project name is set to the name of the current working directory. The project name will be used as a prefix to all containers started by this <code>docker-compose</code> instance (so, if we have a service called <code>postgres</code>, this will create a container called <code>pecan_postgres</code>).</li>
<li><code>up -d</code> – <code>up</code> is a command that initializes the containers. Initialization involves downloading and building the target containers and any containers they depend on, and then running them. Normally, this happens in the foreground, printing logs directly to <code>stderr</code>/<code>stdout</code> (meaning you would have to interrupt it with Ctrl-C), but the <code>-d</code> flag forces this to happen more quietly and in the background.</li>
<li><code>postgres</code> – This indicates that we only want to initialize the service called <code>postgres</code> (and its dependencies). If we omitted this, <code>docker-compose</code> would initialize all containers in the stack.</li>
</ul>
<p>The end result of this command is to initialize a “blank” PostGIS container that will run in the background.
This container is not connected to any data (yet), and is basically analogous to just installing and starting PostgreSQL to your system.
As a side effect, the above command will also create blank data <a href="https://docs.docker.com/storage/volumes/">“volumes”</a> and a <a href="https://docs.docker.com/network/">“network”</a> that containers will use to communicate with each other.
Because our project is called <code>pecan</code> and <code>docker-compose.yml</code> describes a network called <code>pecan</code>, the resulting network is called <code>pecan_pecan</code>.
This is relevant to the following commands, which will actually initialize and populate the BETY database.</p>
<p>Assuming the above ran successfully, next run the following:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">docker</span> run -ti --rm --network pecan_pecan pecan/bety:latest initialize</code></pre>
<p>The breakdown of this command is as follows: {#docker-run-init}</p>
<ul>
<li><code>docker run</code> – This says we will be running a specific command inside the target Docker container. See <code>docker run --help</code> and the <a href="https://docs.docker.com/engine/reference/run/">Docker run reference</a> for more information.</li>
<li><code>-ti</code> – This is actually two flags, <code>-t</code> to allocate a pseudo-tty and <code>-i</code> to keep STDIN open even if detached. <code>-t</code> is necessary to ensure lower-level script commands run correctly. <code>-i</code> makes sure that the command output (<code>stdin</code>) is displayed.</li>
<li><code>--rm</code> – This automatically removes the resulting container once the specified command exits, as well as any volumes associated with the container. This is useful as a general “clean-up” flag for one-off commands (like this one) to make sure you don’t leave any “zombie” containers or volumes around at the end.</li>
<li><code>--network pecan_pecan</code> – This indicates that the container will use the existing <code>pecan_pecan</code> network. This network is what ensures communication between the <code>postgres</code> container (which, recall, is <em>just</em> a PostGIS installation, and has no data inside it) and the “volumes” where the actual data are persistently stored.</li>
<li><code>pecan/bety:latest</code> – This is the name of the image in which to run the specified command, in the form <code>repository/image:version</code>. This is interpreted as follows:
<ul>
<li>First, it sees if there are any images called <code>pecan/bety:latest</code> available on your local machine. If there are, it uses that one.</li>
<li>If that image version is <em>not</em> available locally, it will next try to find the image online. By default, it searches <a href="https://hub.docker.com/">Docker Hub</a>, such that <code>pecan/bety</code> gets expanded to the container at <code>https://hub.docker.com/r/pecan/bety</code>. For custom repositories, a full name can be given, such as <code>hub.ncsa.illinois.edu/pecan/bety:latest</code>.</li>
<li>If <code>:version</code> is omitted, Docker assumes <code>:latest</code>. NOTE that while online containers <em>should</em> have a <code>:latest</code> version, not all of them do, and if a <code>:latest</code> version does not exist, Docker will be unable to find the image and will throw an error.</li>
</ul></li>
<li>Everything after the image name (here, <code>pecan/bety:latest</code>) is interpreted as an argument to the image’s specified <a href="https://docs.docker.com/engine/reference/builder/#entrypoint">entrypoint</a>. For the <code>pecan/bety</code> image, the entrypoint is the script <a href="https://github.com/PecanProject/bety/blob/master/docker/entrypoint.sh"><code>docker/entrypoint.sh</code></a> located in the BETY repository. Here, the <code>initialize</code> argument is parsed to mean “Create a new database”, which first runs <code>psql</code> commands to create the <code>bety</code> role and database and then runs the <code>load.bety.sh</code> script.
<ul>
<li>NOTE: The entrypoint script that is used is the one copied into the Docker container at the time it was built, which, depending on the indicated image version and how often images are built on Docker Hub relative to updates to the source, may be older than whatever is in the source code.</li>
<li>NOTE: The <code>load.bety.sh</code> script is, somewhat confusingly, located in the <em>PEcAn</em> GitHub repository (<a href="https://github.com/PecanProject/pecan/blob/develop/scripts/load.bety.sh"><code>scripts/load.bety.sh</code></a>), <em>not</em> in the BETY repository. As part of its build process, the BETY image downloads the latest <code>develop</code> version of <code>load.bety.sh</code> from the PEcAn repository and stores it in the root folder of the image. The relevant parts of the Dockerfile are <a href="https://github.com/PecanProject/bety/blob/master/Dockerfile#L33-L36">here</a>. As with <code>entrypoint.sh</code>, note that this script is only updated when the image is re-built, and because the origin is in a different repository, new versions are not built whenever <code>load.bety.sh</code> is updated. This is a <a href="https://github.com/PecanProject/bety/issues/597">known issue</a>.</li>
</ul></li>
</ul>
<p>The above command should produce a bunch of output, some of which may look like errors.
Some of these errors are normal and should not stop the command from completing successfully.
You will know you have encountered more serious errors if the command exits or hangs with output resembling the following:</p>
<pre><code>LINE 1: SELECT count(*) FROM formats WHERE ...
                             ^
Error: Relation `formats` does not exist</code></pre>
<p><strong>If the above command fails</strong>, you can try to fix things interactively by first opening a shell inside the container…</p>
<pre><code>docker run -ti --rm --network pecan_pecan pecan/bety:latest /bin/bash</code></pre>
<p>…and then running the following commands, which emulate the functionality of the <code>entrypoint.sh</code> with the <code>initialize</code> argument.</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># Create the bety role in the postgresql database</span>
<span class="ex">psql</span> -h postgres -p 5432 -U postgres -c <span class="st">&quot;CREATE ROLE bety WITH LOGIN CREATEDB NOSUPERUSER NOCREATEROLE PASSWORD &#39;bety&#39;&quot;</span>

<span class="co"># Initialize the bety database itself, and set to be owned by role bety</span>
<span class="ex">psql</span> -h postgres -p 5432 -U postgres -c <span class="st">&quot;CREATE DATABASE bety WITH OWNER bety&quot;</span>

<span class="co"># If either of these fail with a &quot;role/database bety already exists&quot;,</span>
<span class="co"># that&#39;s fine. You can safely proceed to the next command.</span>

<span class="co"># Load the actual bety database tables and values</span>
<span class="ex">./load.bety.sh</span> -a <span class="st">&quot;postgres&quot;</span> -d <span class="st">&quot;bety&quot;</span> -p <span class="st">&quot;-h postgres -p 5432&quot;</span> -o bety -c -u -g -m <span class="va">${LOCAL_SERVER}</span> -r 0 -w https://ebi-forecast.igb.illinois.edu/pecan/dump/all/bety.tar.gz</code></pre>
<p>Note that this command may throw a bunch of errors related to functions and/or operators already existing.
This is normal – it just means that the PostGIS extension to PostgreSQL is already installed.
The important thing is that you see output near the end like:</p>
<pre><code>CREATED SCHEMA
Loading  schema_migrations         : ADDED 61
Started psql (pid=507)
Updated  formats                   :     35 (+35)
Fixed    formats                   : 46
Updated  machines                  :     23 (+23)
Fixed    machines                  : 24
Updated  mimetypes                 :    419 (+419)
Fixed    mimetypes                 : 1095
...
...
...
Added carya41 with access_level=4 and page_access_level=1 with id=323
Added carya42 with access_level=4 and page_access_level=2 with id=325
Added carya43 with access_level=4 and page_access_level=3 with id=327
Added carya44 with access_level=4 and page_access_level=4 with id=329
Added guestuser with access_level=4 and page_access_level=4 with id=331</code></pre>
<p>Once the command has finished successfully, proceed with the next step:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">docker</span> run -ti --rm --network pecan_pecan --volume pecan_pecan:/data pecan/data:develop</code></pre>
<p>The breakdown of this command is as follows:</p>
<ul>
<li><code>docker run -ti --rm --network pecan_pecan</code> – Same as <a href="#docker-run-init">above</a>.</li>
<li><code>--volume pecan_pecan:/data</code> – This mounts the data from the subsequent container (<code>pecan/data:develop</code>) onto the current project volume, called <code>pecan_pecan</code> (as with the network, the project name <code>pecan</code> is the prefix, and the volume name also happens to be <code>pecan</code> as specified in the <code>docker-compose.yml</code> file).</li>
<li><code>pecan/data:develop</code> – As above, this is the target image to run. Since there is no argument after the image name, this command will run the default command (<a href="https://docs.docker.com/engine/reference/builder/#cmd"><code>CMD</code></a>) specified for this docker container. In this case, it is the <a href="https://github.com/PecanProject/pecan/blob/develop/docker/add-data.sh"><code>docker/add_data.sh</code></a> script from the PEcAn repository.</li>
</ul>
<p>Under the hood, this container runs the <code>docker/add-data.sh</code> script, which downloads a bunch of input files and registers them with the PEcAn database.</p>
<p>Successful execution of this command should take some time because it involves downloading and copying reasonably large amounts of data and performing a number of database operations.</p>
</div>
<div id="start-pecan" class="section level4">
<h4><span class="header-section-number">29.2.2.2</span> Start PEcAn</h4>
<p>If you already completed the above steps, you can start the full stack by just running the following:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">docker-compose</span> -p pecan up -d</code></pre>
<p>This will build and start all containers required to run PEcAn.
With the <code>-d</code> flag, this will run all of these containers quietly in the background, and show a nice architecture diagram with the name and status of each container while they are starting.
Once this is done you have a working instance of PEcAn.</p>
<p>If all of the containers started successfully, you should be able to access the various components from a browser via the following URLs:</p>
<ul>
<li>PEcAn web interface (running models) – <a href="http://localhost:8000/pecan/" class="uri">http://localhost:8000/pecan/</a> (NOTE: The trailing backslash is necessary.)</li>
<li>PEcAn documentation and home page – <a href="http://localhost:8000/" class="uri">http://localhost:8000/</a></li>
<li>BETY web interface – <a href="http://localhost:8000/bety/" class="uri">http://localhost:8000/bety/</a></li>
<li>File browser (minio) – <a href="http://localhost:8000/minio/" class="uri">http://localhost:8000/minio/</a></li>
<li>RabbitMQ management console (for managing queued processes) – <a href="http://localhost:8000/rabbitmq/" class="uri">http://localhost:8000/rabbitmq/</a></li>
<li>Traefik, webserver showing maps from URLs onto their respective containers – <a href="http://localhost:8001/" class="uri">http://localhost:8001/</a></li>
<li>Monitor, service that monitors models and shows all models that are online as well as how many instances are online and the number of jobs waiting. The output is in JSON – <a href="http://localhost:8000/monitor/" class="uri">http://localhost:8000/monitor/</a></li>
</ul>
</div>
<div id="start-model-runs-using-curl" class="section level4">
<h4><span class="header-section-number">29.2.2.3</span> Start model runs using curl</h4>
<p>To test PEcAn you can use the following <code>curl</code> statement, or use the webpage to submit a request:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">curl</span> -v -X POST \
    -F <span class="st">&#39;hostname=docker&#39;</span> \
    -F <span class="st">&#39;modelid=5000000002&#39;</span> \
    -F <span class="st">&#39;sitegroupid=1&#39;</span> \
    -F <span class="st">&#39;siteid=772&#39;</span> \
    -F <span class="st">&#39;sitename=Niwot Ridge Forest/LTER NWT1 (US-NR1)&#39;</span> \
    -F <span class="st">&#39;pft[]=temperate.coniferous&#39;</span> \
    -F <span class="st">&#39;start=2004/01/01&#39;</span> \
    -F <span class="st">&#39;end=2004/12/31&#39;</span> \
    -F <span class="st">&#39;input_met=5000000005&#39;</span> \
    -F <span class="st">&#39;email=&#39;</span> \
    -F <span class="st">&#39;notes=&#39;</span> \
    <span class="st">&#39;http://localhost:8000/pecan/04-runpecan.php&#39;</span></code></pre>
<p>This should return some text with in there <code>Location:</code> this is shows the workflow id, you can prepend <a href="http://localhost:8000/pecan/" class="uri">http://localhost:8000/pecan/</a> to the front of this, for example: <a href="http://localhost:8000/pecan/05-running.php?workflowid=99000000001" class="uri">http://localhost:8000/pecan/05-running.php?workflowid=99000000001</a>. Here you will be able to see the progress of the workflow.</p>
<p>To see what is happening behind the scenes you can use look at the log file of the specific docker containers, once of interest are <code>pecan_executor_1</code> this is the container that will execute a single workflow and <code>pecan_sipnet_1</code> which executes the sipnet mode. To see the logs you use <code>docker logs pecan_executor_1</code> Following is an example output:</p>
<pre><code>2018-06-13 15:50:37,903 [MainThread     ] INFO    : pika.adapters.base_connection - Connecting to 172.18.0.2:5672
2018-06-13 15:50:37,924 [MainThread     ] INFO    : pika.adapters.blocking_connection - Created channel=1
2018-06-13 15:50:37,941 [MainThread     ] INFO    : root -  [*] Waiting for messages. To exit press CTRL+C
2018-06-13 19:44:49,523 [MainThread     ] INFO    : root - b&#39;{&quot;folder&quot;: &quot;/data/workflows/PEcAn_99000000001&quot;, &quot;workflowid&quot;: &quot;99000000001&quot;}&#39;
2018-06-13 19:44:49,524 [MainThread     ] INFO    : root - Starting job in /data/workflows/PEcAn_99000000001.
2018-06-13 19:45:15,555 [MainThread     ] INFO    : root - Finished running job.</code></pre>
<p>This shows that the executor connects to RabbitMQ, waits for messages. Once it picks up a message it will print the message, and execute the workflow in the folder passed in with the message. Once the workflow (including any model executions) is finished it will print Finished. The log file for <code>pecan_sipnet_1</code> is very similar, in this case it runs the <code>job.sh</code> in the run folder.</p>
<p>To run multiple executors in parallel you can duplicate the executor section in the docker-compose file and just rename it from executor to executor1 and executor2 for example. The same can be done for the models. To make this easier it helps to deploy the containers using Kubernetes allowing to easily scale up and down the containers.</p>

</div>
</div>
</div>
<div id="pecan-docker" class="section level2">
<h2><span class="header-section-number">29.3</span> PEcAn Docker Architecture</h2>
<div id="pecan-docker-overview" class="section level3">
<h3><span class="header-section-number">29.3.1</span> Overview</h3>
<p>The PEcAn docker architecture consists of many containers (see figure below) that will communicate with each other. The goal of this architecture is to easily expand the PEcAn system by deploying new model containers and registering them with PEcAn. Once this is done the user can now use these new models in their work. The PEcAn framework will setup the configurations for the models, and send a message to the model containers to start execution. Once the execution is finished the PEcAn framework will continue. This is exactly as if the model is running on a HPC machine. Models can be executed in parallel by launching multiple model containers.</p>
<p><img src="06_reference/04_docker/pecan-docker.png" width="50%" height="50%" style="display: block; margin: auto;" /></p>
<p>As can be seen in the figure the architecture leverages of two standard containers (in orange). The first container is postgresql with postgis (<a href="https://hub.docker.com/r/mdillon/postgis/">mdillon/postgis</a>) which is used to store the database used by both BETY and PEcAn. The second containers is a messagebus, more specifically RabbitMQ (<a href="https://hub.docker.com/_/rabbitmq/">rabbitmq</a>).</p>
<p>The BETY app container (<a href="https://hub.docker.com/r/pecan/bety/">pecan/bety</a>) is the front end to the BETY database and is connected to the postgresql container. A http server can be put in front of this container for SSL termination as well to allow for load balancing (by using multiple BETY app containers).</p>
<p>The PEcAn framework containers consist of multiple unique ways to interact with the PEcAn system (none of these containers will have any models installed):</p>
<ul>
<li>PEcAn shiny hosts the shiny applications developed and will interact with the database to get all information necessary to display</li>
<li>PEcAn rstudio is a rstudio environment with the PEcAn libraries preloaded. This allows for prototyping of new algorithms that can be used as part of the PEcAn framework later.</li>
<li>PEcAn web allows the user to create a new PEcAn workflow. The workflow is stored in the database, and the models are executed by the model containers.</li>
<li>PEcAn cli will allow the user to give a pecan.xml file that will be executed by the PEcAn framework. The workflow created from the XML file is stored in the database, and the models are executed by the model containers.</li>
</ul>
<p>The model containers contain the actual models that are executed as well as small wrappers to make them work in the PEcAn framework. The containers will run the model based on the parameters received from the message bus and convert the outputs back to the standard PEcAn output format. Once the container is finished processing a message it will immediatly get the next message and start processing it.</p>
</div>
<div id="pecan-docker-compose" class="section level3">
<h3><span class="header-section-number">29.3.2</span> PEcAn’s <code>docker-compose</code></h3>
<p>The PEcAn Docker architecture is described in full by the PEcAn <code>docker-compose.yml</code> file.
For full <code>docker-compose</code> syntax, see the <a href="https://docs.docker.com/compose/">official documentation</a>.</p>
<p>This section describes the <a href="docker-index.html#pecan-dc-structure">top-level structure</a> and each of the services, which are as follows:</p>
<ul>
<li><a href="docker-index.html#pecan-dc-traefik"><code>traefik</code></a></li>
<li><a href="docker-index.html#pecan-dc-portainer"><code>portainer</code></a></li>
<li><a href="docker-index.html#pecan-dc-minio"><code>minio</code></a></li>
<li><a href="docker-index.html#pecan-dc-thredds"><code>thredds</code></a></li>
<li><a href="docker-index.html#pecan-dc-postgres"><code>postgres</code></a></li>
<li><a href="docker-index.html#pecan-dc-rabbitmq"><code>rabbitmq</code></a></li>
<li><a href="docker-index.html#pecan-dc-bety"><code>bety</code></a></li>
<li><a href="docker-index.html#pecan-dc-docs"><code>docs</code></a></li>
<li><a href="docker-index.html#pecan-dc-web"><code>web</code></a></li>
<li><a href="docker-index.html#pecan-dc-executor"><code>executor</code></a></li>
<li><a href="docker-index.html#pecan-dc-monitor"><code>monitor</code></a></li>
<li><a href="docker-index.html#pecan-dc-models">Model-specific services</a></li>
</ul>
<p>For reference, the complete <code>docker-compose</code> file is as follows:</p>
<pre><code>version: &#39;3&#39;
services:
  traefik:
    image: traefik:latest
    command:
    - --loglevel=INFO
    - --api
    - --defaultentrypoints=https,http
    - --entryPoints=Name:http Address::${TRAEFIK_HTTP_PORT:-8000} ${TRAEFIK_HTTP_REDIRECT:-&quot;&quot;}
    - --entryPoints=Name:https Address::${TRAEFIK_HTTPS_PORT:-8443} ${TRAEFIK_HTTPS_OPTIONS:-TLS}
    - --acme=${TRAEFIK_ACME_ENABLE:-false}
    - --acme.email=${TRAEFIK_ACME_EMAIL:-&quot;&quot;}
    - --acme.entrypoint=https
    - --acme.onhostrule=true
    - --acme.storage=/config/acme.json
    - --acme.httpchallenge.entrypoint=http
    - --acme.storage=/config/acme.json
    - --acme.acmelogging=true
    - --docker=true
    - --docker.endpoint=unix:///var/run/docker.sock
    - --docker.exposedbydefault=false
    - --docker.watch=true
    restart: unless-stopped
    networks: pecan
    ports:
    - ${TRAEFIK_HTTP_PORT-8000}:${TRAEFIK_HTTP_PORT:-8000}
    - ${TRAEFIK_HTTPS_PORT-8443}:${TRAEFIK_HTTPS_PORT:-8443}
    labels:
    - traefik.enable=true
    - traefik.backend=traefik
    - traefik.port=8080
    - &#39;traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefixStrip: /traefik&#39;
    - traefik.website.frontend.whiteList.sourceRange=${TRAEFIK_IPFILTER:-172.16.0.0/12}
    volumes:
    - /var/run/docker.sock:/var/run/docker.sock:ro
    - traefik:/config
  portainer:
    image: portainer/portainer:latest
    command:
    - --admin-password=${PORTAINER_PASSWORD:-}
    - --host=unix:///var/run/docker.sock
    restart: unless-stopped
    networks: pecan
    labels:
    - traefik.enable=true
    - traefik.backend=portainer
    - &#39;traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefixStrip: /portainer&#39;
    - traefik.website.frontend.whiteList.sourceRange=${TRAEFIK_IPFILTER:-172.16.0.0/12}
    volumes:
    - /var/run/docker.sock:/var/run/docker.sock
    - portainer:/data
  minio:
    image: minio/minio:latest
    command: server /data
    restart: unless-stopped
    networks: pecan
    environment:
    - MINIO_ACCESS_KEY=${MINIO_ACCESS_KEY:-carya}
    - MINIO_SECRET_KEY=${MINIO_SECRET_KEY:-illinois}
    labels:
    - traefik.enable=true
    - traefik.backend=minio
    - traefik.port=9000
    - traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefix:/minio/
    volumes: pecan:/data
  thredds:
    image: pecan/thredds:${PECAN_VERSION:-latest}
    restart: unless-stopped
    networks: pecan
    volumes: pecan:/data
    labels:
    - traefik.enable=true
    - traefik.port=8080
    - traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefix:/thredds
    - traefik.backend=thredds
  rabbitmq:
    image: rabbitmq:management
    restart: unless-stopped
    networks: pecan
    environment:
    - RABBITMQ_SERVER_ADDITIONAL_ERL_ARGS=-rabbitmq_management path_prefix &quot;/rabbitmq&quot;
    - RABBITMQ_DEFAULT_USER=${RABBITMQ_DEFAULT_USER:-guest}
    - RABBITMQ_DEFAULT_PASS=${RABBITMQ_DEFAULT_PASS:-guest}
    labels:
    - traefik.enable=true
    - traefik.backend=rabbitmq
    - traefik.port=15672
    - traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefix:/rabbitmq
    - traefik.website.frontend.whiteList.sourceRange=${TRAEFIK_IPFILTER:-172.16.0.0/12}
    volumes: rabbitmq:/var/lib/rabbitmq
  postgres:
    image: mdillon/postgis:9.5
    restart: unless-stopped
    networks: pecan
    volumes: postgres:/var/lib/postgresql/data
  bety:
    image: pecan/bety:${BETY_VERSION:-latest}
    restart: unless-stopped
    networks: pecan
    environment:
    - UNICORN_WORKER_PROCESSES=1
    - SECRET_KEY_BASE=${BETY_SECRET_KEY:-notasecret}
    - RAILS_RELATIVE_URL_ROOT=/bety
    - LOCAL_SERVER=${BETY_LOCAL_SERVER:-99}
    depends_on: postgres
    labels:
    - traefik.enable=true
    - traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefix:/bety/
    - traefik.backend=bety
  docs:
    image: pecan/docs:${PECAN_VERSION:-latest}
    restart: unless-stopped
    networks: pecan
    labels:
    - traefik.enable=true
    - traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefix:/
    - traefik.backend=docs
  web:
    image: pecan/web:${PECAN_VERSION:-latest}
    restart: unless-stopped
    networks: pecan
    environment:
    - RABBITMQ_URI=${RABBITMQ_URI:-amqp://guest:guest@rabbitmq/%2F}
    - FQDN=${PECAN_FQDN:-docker}
    - NAME=${PECAN_NAME:-docker}
    depends_on:
    - postgres
    - rabbitmq
    labels:
    - traefik.enable=true
    - traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefix:/pecan/
    - traefik.backend=pecan
    volumes:
    - pecan:/data
    - pecan:/var/www/html/pecan/data
  monitor:
    image: pecan/monitor:${PECAN_VERSION:-latest}
    restart: unless-stopped
    networks: pecan
    ports: 9999:9999
    environment:
    - RABBITMQ_URI=${RABBITMQ_URI:-amqp://guest:guest@rabbitmq/%2F}
    - FQDN=${PECAN_FQDN:-docker}
    depends_on: rabbitmq
    labels:
    - traefik.enable=true
    - traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefixStrip:/monitor/
    - traefik.backend=monitor
    volumes: pecan:/data
  executor:
    image: pecan/executor:${PECAN_VERSION:-latest}
    restart: unless-stopped
    networks: pecan
    environment:
    - RABBITMQ_URI=${RABBITMQ_URI:-amqp://guest:guest@rabbitmq/%2F}
    - FQDN=${PECAN_FQDN:-docker}
    depends_on:
    - postgres
    - rabbitmq
    volumes: pecan:/data
  sipnet:
    image: pecan/model-sipnet-136:${PECAN_VERSION:-latest}
    restart: unless-stopped
    networks: pecan
    environment: RABBITMQ_URI=${RABBITMQ_URI:-amqp://guest:guest@rabbitmq/%2F}
    depends_on: rabbitmq
    volumes: pecan:/data
  ed2:
    image: pecan/model-ed2-git:${PECAN_VERSION:-latest}
    restart: unless-stopped
    networks: pecan
    environment: RABBITMQ_URI=${RABBITMQ_URI:-amqp://guest:guest@rabbitmq/%2F}
    depends_on: rabbitmq
    volumes: pecan:/data
networks:
  pecan: ~
volumes:
  traefik: ~
  postgres: ~
  rabbitmq: ~
  pecan: ~
  portainer: ~</code></pre>
<p>There are two ways you can override different values in the docker-compose.yml file. The first method is to create a file called <code>.env</code> that is placed in the same folder as the docker-compose.yml file. This file can override some of configuration variables used by docker-compose. For example the following is an example of the env file</p>
<pre><code># This file will override the configation options in the docker-compose
# file. Copy this file to the same folder as docker-compose as .env

# ----------------------------------------------------------------------
# GENERAL CONFIGURATION
# ----------------------------------------------------------------------

# Folder to store all data
DATA_DIR=/home/kooper/pecan

# ----------------------------------------------------------------------
# TRAEFIK CONFIGURATION
# ----------------------------------------------------------------------

# hostname of server
TRAEFIK_HOST=Host:pecan-docker.ncsa.illinois.edu;

# only allow access from localhost and NCSA
TRAEFIK_IPFILTER=172.16.0.0/12, 141.142.0.0/16

# Run traffik on port 80 (http) and port 443 (https)
TRAEFIK_HTTP_PORT=80
TRAEFIK_HTTPS_PORT=443
TRAEFIK_HTTPS_OPTIONS=TLS

# enable SSL cerificate generation
TRAEFIK_ACME_ENABLE=true

# Use you real email address here to be notified if cert expires
TRAEFIK_ACME_EMAIL=pecanproj@gmail.com

# Always use https, trafic to http is redirected to https
TRAEFIK_HTTP_REDIRECT=Redirect.EntryPoint:https

# ----------------------------------------------------------------------
# PEcAn CONFIGURATION
# ----------------------------------------------------------------------

# what version of pecan to use
PECAN_VERSION=develop

# the fully qualified hostname used for this server
PECAN_FQDN=pecan-docker.ncsa.illinois.edu

# short name shown in the menu
PECAN_FQDN=pecan-docker

# ----------------------------------------------------------------------
# BETY CONFIGURATION
# ----------------------------------------------------------------------

# what version of BETY to use
BETY_VERSION=latest

# what is our server number, 99=vm, 98=docker
BETY_LOCAL_SERVER=98

# secret used to encrypt cookies in BETY
BETY_SECRET_KEY=1208q7493e8wfhdsohfo9ewhrfiouaho908ruq30oiewfdjspadosuf08q345uwrasdy98t7q243

# ----------------------------------------------------------------------
# MINIO CONFIGURATION
# ----------------------------------------------------------------------

# minio username and password
MINIO_ACCESS_KEY=carya
MINIO_SECRET_KEY=illinois

# ----------------------------------------------------------------------
# PORTAINER CONFIGURATION
# ----------------------------------------------------------------------

# password for portainer admin account
# use docker run --rm httpd:2.4-alpine htpasswd -nbB admin &lt;password&gt; | cut -d &quot;:&quot; -f 2
PORTAINER_PASSWORD=$2y$05$5meDPBtS3NNxyGhBpYceVOxmFhiiC3uY5KEy2m0YRbWghhBr2EVn2

# ----------------------------------------------------------------------
# RABBITMQ CONFIGURATION
# ----------------------------------------------------------------------

# RabbitMQ username and password
RABBITMQ_DEFAULT_USER=carya
RABBITMQ_DEFAULT_PASS=illinois

# create the correct URI with above username and password
RABBITMQ_URI=amqp://carya:illinois@rabbitmq/%2F</code></pre>
<p>You can also extend the <code>docker-compose.yml</code> file with a <code>docker-compose.override.yml</code> file (in the same directory), allowing you to add more services, or for example to change where the volumes are stored (see <a href="https://docs.docker.com/compose/extends/">official documentation</a>). For example the following will change the volume for postgres to be stored in your home directory:</p>
<pre><code>version: &quot;3&quot;

volumes:
  postgres:
    driver_opts:
      type: none
      device: ${HOME}/postgres
      o: bind</code></pre>
<div id="pecan-dc-structure" class="section level4">
<h4><span class="header-section-number">29.3.2.1</span> Top-level structure</h4>
<p>The root of the <code>docker-compose.yml</code> file contains three sections:</p>
<ul>
<li><p><code>services</code> – This is a list of services provided by the application, with each service corresponding to a container.
When communicating with each other internally, the hostnames of containers correspond to their names in this section.
For instance, regardless of the “project” name passed to <code>docker-compose up</code>, the hostname for connecting to the PostgreSQL database of any given container is <em>always</em> going to be <code>postgres</code> (e.g. you should be able to access the PostgreSQL database by calling the following from inside the container: <code>psql -d bety -U bety -h postgres</code>).
The services comprising the PEcAn application are described below.</p></li>
<li><p><code>networks</code> – This is a list of networks used by the application.
Containers can only communicate with each other (via ports and hostnames) if they are on the same Docker network, and containers on different networks can only communicate through ports exposed by the host machine.
We just provide the network name (<code>pecan</code>) and resort to Docker’s default network configuration.
Note that the services we want connected to this network include a <code>networks: ... - pecan</code> tag.
For more details on Docker networks, see the <a href="https://docs.docker.com/network/">official documentation</a>.</p></li>
<li><p><code>volumes</code> – Similarly to <code>networks</code>, this just contains a list of volume names we want.
Briefly, in Docker, volumes are directories containing files that are meant to be shared across containers.
Each volume corresponds to a directory, which can be mounted at a specific location by different containers.
For example, syntax like <code>volumes: ... - pecan:/data</code> in a service definition means to mount the <code>pecan</code> “volume” (including its contents) in the <code>/data</code> directory of that container.
Volumes also allow data to persist on containers between restarts, as normally, any data created by a container during its execution is lost when the container is re-launched.
For example, using a volume for the database allows data to be saved between different runs of the database container.
Without volumes, we would start with a blank database every time we restart the containers.
For more details on Docker volumes, see the <a href="https://docs.docker.com/storage/volumes/">official documentation</a>.
Here, we define three volumes:</p>
<ul>
<li><p><code>postgres</code> – This contains the data files underlying the PEcAn PostgreSQL database (BETY).
Notice that it is mounted by the <code>postgres</code> container to <code>/var/lib/postgresql/data</code>.
This is the data that we pre-populate when we run the Docker commands to <a href="docker-index.html#pecan-docker-quickstart-init">initialize the PEcAn database</a>.
Note that these are the values stored <em>directly in the PostgreSQL database</em>.
The default files to which the database points (i.e. <code>dbfiles</code>) are stored in the <code>pecan</code> volume, described below.</p></li>
<li><p><code>rabbitmq</code> – This volume contains persistent data for RabbitMQ.
It is only used by the <code>rabbitmq</code> service.</p></li>
<li><p><code>pecan</code> – This volume contains PEcAn’s <code>dbfiles</code>, which include downloaded and converted model inputs, processed configuration files, and outputs.
It is used by almost all of the services in the PEcAn stack, and is typically mounted to <code>/data</code>.</p></li>
</ul></li>
</ul>
</div>
<div id="pecan-dc-traefik" class="section level4">
<h4><span class="header-section-number">29.3.2.2</span> <code>traefik</code></h4>
<p><a href="https://traefik.io/">Traefik</a> manages communication among the different PEcAn services and between PEcAn and the web.
Among other things, <code>traefik</code> facilitates the setup of web access to each PEcAn service via common and easy-to-remember URLs.
For instance, the following lines in the <code>web</code> service configure access to the PEcAn web interface via the URL <a href="http://localhost:8000/pecan/" class="uri">http://localhost:8000/pecan/</a> :</p>
<pre><code>labels:
- traefik.enable=true
- traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefix:/pecan/
- traefik.backend=pecan</code></pre>
<p>(Further details in the works…)</p>
<p>The traefik service configuration looks like this:</p>
<pre><code>traefik:
  image: traefik:latest
  command:
  - --loglevel=INFO
  - --api
  - --defaultentrypoints=https,http
  - --entryPoints=Name:http Address::${TRAEFIK_HTTP_PORT:-8000} ${TRAEFIK_HTTP_REDIRECT:-&quot;&quot;}
  - --entryPoints=Name:https Address::${TRAEFIK_HTTPS_PORT:-8443} ${TRAEFIK_HTTPS_OPTIONS:-TLS}
  - --acme=${TRAEFIK_ACME_ENABLE:-false}
  - --acme.email=${TRAEFIK_ACME_EMAIL:-&quot;&quot;}
  - --acme.entrypoint=https
  - --acme.onhostrule=true
  - --acme.storage=/config/acme.json
  - --acme.httpchallenge.entrypoint=http
  - --acme.storage=/config/acme.json
  - --acme.acmelogging=true
  - --docker=true
  - --docker.endpoint=unix:///var/run/docker.sock
  - --docker.exposedbydefault=false
  - --docker.watch=true
  restart: unless-stopped
  networks: pecan
  ports:
  - ${TRAEFIK_HTTP_PORT-8000}:${TRAEFIK_HTTP_PORT:-8000}
  - ${TRAEFIK_HTTPS_PORT-8443}:${TRAEFIK_HTTPS_PORT:-8443}
  labels:
  - traefik.enable=true
  - traefik.backend=traefik
  - traefik.port=8080
  - &#39;traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefixStrip: /traefik&#39;
  - traefik.website.frontend.whiteList.sourceRange=${TRAEFIK_IPFILTER:-172.16.0.0/12}
  volumes:
  - /var/run/docker.sock:/var/run/docker.sock:ro
  - traefik:/config</code></pre>
</div>
<div id="pecan-dc-portainer" class="section level4">
<h4><span class="header-section-number">29.3.2.3</span> <code>portainer</code></h4>
<p><a href="https://portainer.io/">portainer</a> is lightweight management UI that allows you to manage the docker host (or swarm). You can use this service to monitor the different containers, see the logfiles, and start and stop containers.</p>
<p>The portainer service configuration looks like this:</p>
<pre><code>portainer:
  image: portainer/portainer:latest
  command:
  - --admin-password=${PORTAINER_PASSWORD:-}
  - --host=unix:///var/run/docker.sock
  restart: unless-stopped
  networks: pecan
  labels:
  - traefik.enable=true
  - traefik.backend=portainer
  - &#39;traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefixStrip: /portainer&#39;
  - traefik.website.frontend.whiteList.sourceRange=${TRAEFIK_IPFILTER:-172.16.0.0/12}
  volumes:
  - /var/run/docker.sock:/var/run/docker.sock
  - portainer:/data</code></pre>
<p>Portainer is accessible by browsing to <code>localhost:8000/portainer/</code>. You can either set the password in the <code>.env</code> file (for an example see env.example) or you can use the web browser and go to the portainer url. If this is the first time it will ask for your password.</p>
</div>
<div id="pecan-dc-minio" class="section level4">
<h4><span class="header-section-number">29.3.2.4</span> <code>minio</code></h4>
<p><a href="https://github.com/minio/minio">Minio</a> is a service that provides access to the a folder on disk through a variety of protocols, including S3 buckets and web-based access.
We mainly use Minio to facilitate access to PEcAn data using a web browser without the need for CLI tools.</p>
<p>Our current configuration is as follows:</p>
<pre><code>minio:
  image: minio/minio:latest
  command: server /data
  restart: unless-stopped
  networks: pecan
  environment:
  - MINIO_ACCESS_KEY=${MINIO_ACCESS_KEY:-carya}
  - MINIO_SECRET_KEY=${MINIO_SECRET_KEY:-illinois}
  labels:
  - traefik.enable=true
  - traefik.backend=minio
  - traefik.port=9000
  - traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefix:/minio/
  volumes: pecan:/data</code></pre>
<p>The Minio interface is accessible by browsing to <code>localhost:8000/minio/</code>.
From there, you can browse directories and download files.
You can also upload files by clicking the red “+” in the bottom-right corner.</p>
<p>Note that it is currently impossible to create or upload directories using the Minio interface (except in the <code>/data</code> root directory – those folders are called “buckets” in Minio).
Therefore, the recommended way to perform any file management tasks other than individual file uploads is through the command line, e.g.</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">docker</span> run -it --rm --volumes pecan_pecan:/data --volumes /path/to/local/directory:/localdir ubuntu

<span class="co"># Now, you can move files between `/data` and `/localdir`, create new directories, etc.</span></code></pre>
</div>
<div id="pecan-dc-thredds" class="section level4">
<h4><span class="header-section-number">29.3.2.5</span> <code>thredds</code></h4>
<p>This service allows PEcAn model outputs to be accessible via the <a href="https://www.unidata.ucar.edu/software/thredds/current/tds/">THREDDS data server (TDS)</a>.
When the PEcAn stack is running, the catalog can be explored in a web browser at <a href="http://localhost:8000/thredds/catalog.html" class="uri">http://localhost:8000/thredds/catalog.html</a>.
Specific output files can also be accessed from the command line via commands like the following:</p>
<pre class="sourceCode r"><code class="sourceCode r">nc &lt;-<span class="st"> </span>ncdf4<span class="op">::</span><span class="kw">nc_open</span>(<span class="st">&quot;http://localhost:8000/thredds/dodsC/outputs/PEcAn_&lt;workflow_id&gt;/out/&lt;run_id&gt;/&lt;year&gt;.nc&quot;</span>)</code></pre>
<p>Note that everything after <code>outputs/</code> exactly matches the directory structure of the <code>workflows</code> directory.</p>
<p>Which files are served, which subsetting services are available, and other aspects of the data server’s behavior are configured in the <code>docker/thredds_catalog.xml</code> file.
Specifically, this XML tells the data server to use the <code>datasetScan</code> tool to serve all files within the <code>/data/workflows</code> directory, with the additional <code>filter</code> that only files ending in <code>.nc</code> are served.
For additional information about the syntax of this file, see the extensive <a href="https://www.unidata.ucar.edu/software/thredds/current/tds/reference/index.html">THREDDS documentation</a>.</p>
<p>Our current configuration is as follows:</p>
<pre><code>thredds:
  image: pecan/thredds:${PECAN_VERSION:-latest}
  restart: unless-stopped
  networks: pecan
  volumes: pecan:/data
  labels:
  - traefik.enable=true
  - traefik.port=8080
  - traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefix:/thredds
  - traefik.backend=thredds</code></pre>
</div>
<div id="pecan-dc-postgres" class="section level4">
<h4><span class="header-section-number">29.3.2.6</span> <code>postgres</code></h4>
<p>This service provides a working PostGIS database.
Our configuration is fairly straightforward:</p>
<pre><code>postgres:
  image: mdillon/postgis:9.5
  restart: unless-stopped
  networks: pecan
  volumes: postgres:/var/lib/postgresql/data</code></pre>
<p>Some additional details about our configuration:</p>
<ul>
<li><p><code>image</code> – This pulls a container with PostgreSQL + PostGIS pre-installed.
Note that by default, we use PostgreSQL version 9.5.
To experiment with other versions, you can change <code>9.5</code> accordingly.</p></li>
<li><p><code>networks</code> – This allows PostgreSQL to communicate with other containers on the <code>pecan</code> network.
As mentioned above, the hostname of this service is just its name, i.e. <code>postgres</code>, so to connect to the database from inside a running container, use a command like the following: <code>psql -d bety -U bety -h postgres</code></p></li>
<li><p><code>volumes</code> – Note that the PostgreSQL data files (which store the values in the SQL database) are stored on a <em>volume</em> called <code>postgres</code> (which is <em>not</em> the same as the <code>postgres</code> <em>service</em>, even though they share the same name).</p></li>
</ul>
</div>
<div id="pecan-dc-rabbitmq" class="section level4">
<h4><span class="header-section-number">29.3.2.7</span> <code>rabbitmq</code></h4>
<p><a href="https://www.rabbitmq.com/">RabbitMQ</a> is a message broker service.
In PEcAn, RabbitMQ functions as a task manager and scheduler, coordinating the execution of different tasks (such as running models and analyzing results) associated with the PEcAn workflow.</p>
<p>Our configuration is as follows:</p>
<pre><code>rabbitmq:
  image: rabbitmq:management
  restart: unless-stopped
  networks: pecan
  environment:
  - RABBITMQ_SERVER_ADDITIONAL_ERL_ARGS=-rabbitmq_management path_prefix &quot;/rabbitmq&quot;
  - RABBITMQ_DEFAULT_USER=${RABBITMQ_DEFAULT_USER:-guest}
  - RABBITMQ_DEFAULT_PASS=${RABBITMQ_DEFAULT_PASS:-guest}
  labels:
  - traefik.enable=true
  - traefik.backend=rabbitmq
  - traefik.port=15672
  - traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefix:/rabbitmq
  - traefik.website.frontend.whiteList.sourceRange=${TRAEFIK_IPFILTER:-172.16.0.0/12}
  volumes: rabbitmq:/var/lib/rabbitmq</code></pre>
<p>Note that the <code>traefik.frontend.rule</code> indicates that browsing to <a href="http://localhost:8000/rabbitmq/" class="uri">http://localhost:8000/rabbitmq/</a> leads to the RabbitMQ management console.</p>
<p>By default, the RabbitMQ management console has username/password <code>guest/guest</code>, which is highly insecure.
For production instances of PEcAn, we highly recommend changing these credentials to something more secure, and removing access to the RabbitMQ management console via Traefik.</p>
</div>
<div id="pecan-dc-bety" class="section level4">
<h4><span class="header-section-number">29.3.2.8</span> <code>bety</code></h4>
<p>This service operates the BETY web interface, which is effectively a web-based front-end to the PostgreSQL database.
Unlike the <code>postgres</code> service, which contains all the data needed to run PEcAn models, this service is not essential to the PEcAn workflow.
However, note that certain features of the PEcAn web interface do link to the BETY web interface and will not work if this container is not running.</p>
<p>Our configuration is as follows:</p>
<pre><code>bety:
  image: pecan/bety:${BETY_VERSION:-latest}
  restart: unless-stopped
  networks: pecan
  environment:
  - UNICORN_WORKER_PROCESSES=1
  - SECRET_KEY_BASE=${BETY_SECRET_KEY:-notasecret}
  - RAILS_RELATIVE_URL_ROOT=/bety
  - LOCAL_SERVER=${BETY_LOCAL_SERVER:-99}
  depends_on: postgres
  labels:
  - traefik.enable=true
  - traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefix:/bety/
  - traefik.backend=bety</code></pre>
<p>The BETY container Dockerfile is located in the root directory of the <a href="https://github.com/pecan/bety">BETY GitHub repository</a> (<a href="https://github.com/PecanProject/bety/blob/master/Dockerfile">direct link</a>).</p>
</div>
<div id="pecan-dc-docs" class="section level4">
<h4><span class="header-section-number">29.3.2.9</span> <code>docs</code></h4>
<p>This service will show the documentation for the version of PEcAn running as well as a homepage with links to all relevant endpoints. You can access this at <a href="http://localhost:8000/" class="uri">http://localhost:8000/</a>. You can find the documentation for PEcAn at <a href="http://localhost:8000/docs/pecan/" class="uri">http://localhost:8000/docs/pecan/</a>.</p>
<p>Our current configuration is as follows:</p>
<pre><code>docs:
  image: pecan/docs:${PECAN_VERSION:-latest}
  restart: unless-stopped
  networks: pecan
  labels:
  - traefik.enable=true
  - traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefix:/
  - traefik.backend=docs</code></pre>
</div>
<div id="pecan-dc-web" class="section level4">
<h4><span class="header-section-number">29.3.2.10</span> <code>web</code></h4>
<p>This service runs the PEcAn web interface.
It is effectively a thin wrapper around a standard Apache web server container from Docker Hub that installs some additional dependencies and copies over the necessary files from the PEcAn source code.</p>
<p>Our configuration is as follows:</p>
<pre><code>web:
  image: pecan/web:${PECAN_VERSION:-latest}
  restart: unless-stopped
  networks: pecan
  environment:
  - RABBITMQ_URI=${RABBITMQ_URI:-amqp://guest:guest@rabbitmq/%2F}
  - FQDN=${PECAN_FQDN:-docker}
  - NAME=${PECAN_NAME:-docker}
  depends_on:
  - postgres
  - rabbitmq
  labels:
  - traefik.enable=true
  - traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefix:/pecan/
  - traefik.backend=pecan
  volumes:
  - pecan:/data
  - pecan:/var/www/html/pecan/data</code></pre>
<p>Its Dockerfile ships with the PEcAn source code, in <a href="https://github.com/PecanProject/pecan/blob/develop/docker/base/Dockerfile.web"><code>docker/base/Dockerfile.web</code></a>.</p>
<p>In terms of <a href="#pecan-docker-develop">actively developing PEcAn using Docker</a>, this is the service to modify when making changes to the web interface (i.e. PHP, HTML, and JavaScript code located in the PEcAn <code>web</code> directory).</p>
</div>
<div id="pecan-dc-executor" class="section level4">
<h4><span class="header-section-number">29.3.2.11</span> <code>executor</code></h4>
<p>This service is in charge of running the R code underlying the core PEcAn workflow.
However, it is <em>not</em> in charge of executing the models themselves – model binaries are located on their <a href="docker-index.html#pecan-dc-models">own dedicated Docker containers</a>, and model execution is coordinated by RabbitMQ.</p>
<p>Our configuration is as follows:</p>
<pre><code>executor:
  image: pecan/executor:${PECAN_VERSION:-latest}
  restart: unless-stopped
  networks: pecan
  environment:
  - RABBITMQ_URI=${RABBITMQ_URI:-amqp://guest:guest@rabbitmq/%2F}
  - FQDN=${PECAN_FQDN:-docker}
  depends_on:
  - postgres
  - rabbitmq
  volumes: pecan:/data</code></pre>
<p>Its Dockerfile is ships with the PEcAn source code, in <a href="https://github.com/PecanProject/pecan/blob/develop/docker/base/Dockerfile.executor"><code>docker/base/Dockerfile.executor</code></a>.
Its image is built on top of the <code>pecan/base</code> image (<a href="https://github.com/PecanProject/pecan/blob/develop/docker/base/Dockerfile.base"><code>docker/base/Dockerfile.base</code></a>), which contains the actual PEcAn source.
To facilitate caching, the <code>pecan/base</code> image is itself built on top of the <code>pecan/depends</code> image (<a href="https://github.com/PecanProject/pecan/blob/develop/docker/base/Dockerfile.depends"><code>docker/base/Dockerfile.depends</code></a>), a large image that contains an R installation and PEcAn’s many system and R package dependencies (which usually take ~30 minutes or longer to install from scratch).</p>
<p>In terms of <a href="#pecan-docker-develop">actively developing PEcAn using Docker</a>, this is the service to modify when making changes to the PEcAn R source code.
Note that, unlike changes to the <code>web</code> image’s PHP code, changes to the R source code do not immediately propagate to the PEcAn container; instead, you have to re-compile the code by running <code>make</code> inside the container.</p>
</div>
<div id="pecan-dc-monitor" class="section level4">
<h4><span class="header-section-number">29.3.2.12</span> <code>monitor</code></h4>
<p>This service will show all models that are currently running <a href="http://localhost:8000/monitor/" class="uri">http://localhost:8000/monitor/</a>. This list returned is JSON and shows all models (grouped by type and version) that are currently running, or where seen in the past. This list will also contain a list of all current active containers, as well as how many jobs are waiting to be processed.</p>
<p>This service is also responsible for registering any new models with PEcAn so users can select it and execute the model from the web interface.</p>
<p>Our current configuration is as follows:</p>
<pre><code>monitor:
  image: pecan/monitor:${PECAN_VERSION:-latest}
  restart: unless-stopped
  networks: pecan
  ports: 9999:9999
  environment:
  - RABBITMQ_URI=${RABBITMQ_URI:-amqp://guest:guest@rabbitmq/%2F}
  - FQDN=${PECAN_FQDN:-docker}
  depends_on: rabbitmq
  labels:
  - traefik.enable=true
  - traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE:-}PathPrefixStrip:/monitor/
  - traefik.backend=monitor
  volumes: pecan:/data</code></pre>
</div>
<div id="pecan-dc-models" class="section level4">
<h4><span class="header-section-number">29.3.2.13</span> Model-specific containers</h4>
<p>Additional models are added as additional services.
In general, their configuration should be similar to the following configuration for SIPNET, which ships with PEcAn:</p>
<pre><code>sipnet:
  image: pecan/model-sipnet-136:${PECAN_VERSION:-latest}
  restart: unless-stopped
  networks: pecan
  environment: RABBITMQ_URI=${RABBITMQ_URI:-amqp://guest:guest@rabbitmq/%2F}
  depends_on: rabbitmq
  volumes: pecan:/data</code></pre>
<p>The PEcAn source contains Dockerfiles for ED2 (<a href="https://github.com/PecanProject/pecan/blob/develop/docker/models/Dockerfile.ed2"><code>docker/models/Dockerfile.ed2</code></a>) and SIPNET (<a href="https://github.com/PecanProject/pecan/blob/develop/docker/models/Dockerfile.sipnet"><code>docker/models/Dockerfile.sipnet</code></a>) that can serve as references.
For additional tips on constructing a Dockerfile for your model, see <a href="docker-index.html#model-docker">Dockerfiles for Models</a>.</p>

</div>
</div>
</div>
<div id="model-docker" class="section level2">
<h2><span class="header-section-number">29.4</span> Models using Docker</h2>
<p>This section will discuss how to add new models to PEcAn docker. To be able to add a new model to PEcAn when using docker is as simple as starting a new container. The model will come online and let the PEcAn framework know there is a new model available, there is no need to go through the process of registering this model with PEcAn. Users will be able to select this new model from web interface and run with this model selected.</p>
<p>For this process to work a docker image of the model will need to be created as well as small json file that is used to announce this new model. A separate service in PEcAn (<a href="docker-index.html#pecan-dc-monitor"><code>monitor</code></a>) will use this json file to keep track of all models available as well as register these models with PEcAn.</p>
<div id="model-docker-json-file" class="section level3">
<h3><span class="header-section-number">29.4.1</span> Model information</h3>
<p>Each model will have a small json file called model_info.json that is used to describe the model and to used by the monitor service to register the model with PEcAn. This file will contain information about the model that is send as part of the heartbeat of the container to the monitor service. Below is an example of this file for the ED model. The required fields are <code>name</code>, <code>type</code>, <code>version</code> and <code>binary</code>. There are 2 special values that can be used, <code>@VERSION@</code> which will be replaced by the version that is passed in when building the container, and <code>@BINARY@</code> which will be replaced by the binary when building the docker image.</p>
<pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;ED2.2&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;ED2&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;version&quot;</span><span class="fu">:</span> <span class="st">&quot;@VERSION@&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;binary&quot;</span><span class="fu">:</span> <span class="st">&quot;@BINARY@&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;The Ecosystem Demography Biosphere Model (ED2) is an integrated terrestrial biosphere model incorporating hydrology, land-surface biophysics, vegetation dynamics, and soil carbon and nitrogen biogeochemistry&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;author&quot;</span><span class="fu">:</span> <span class="st">&quot;Mike Dietze&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;contributors&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;David LeBauer&quot;</span><span class="ot">,</span> <span class="st">&quot;Xiaohui Feng&quot;</span><span class="ot">,</span> <span class="st">&quot;Dan Wang&quot;</span><span class="ot">,</span> <span class="st">&quot;Carl Davidson&quot;</span><span class="ot">,</span> <span class="st">&quot;Rob Kooper&quot;</span><span class="ot">,</span> <span class="st">&quot;Shawn Serbin&quot;</span><span class="ot">,</span> <span class="st">&quot;Alexey Shiklomanov&quot;</span><span class="ot">]</span><span class="fu">,</span>
  <span class="dt">&quot;links&quot;</span><span class="fu">:</span> <span class="fu">{</span>
    <span class="dt">&quot;source&quot;</span><span class="fu">:</span> <span class="st">&quot;https://github.com/EDmodel/ED2&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;issues&quot;</span><span class="fu">:</span> <span class="st">&quot;https://github.com/EDmodel/ED2/issues&quot;</span>
  <span class="fu">},</span>
  <span class="dt">&quot;inputs&quot;</span><span class="fu">:</span> <span class="fu">{},</span>
  <span class="dt">&quot;citation&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;Medvigy D., Wofsy S. C., Munger J. W., Hollinger D. Y., Moorcroft P. R. 2009. Mechanistic scaling of ecosystem function and dynamics in space and time: Ecosystem Demography model version 2. J. Geophys. Res. 114 (doi:10.1029/2008JG000812)&quot;</span><span class="ot">]</span>
<span class="fu">}</span></code></pre>
<p>Other fields that are recommended, but currently not used yet, are:
- <code>description</code> : a longer description of the model.
- <code>creator</code> : contact person about this docker image.
- <code>contribuor</code> : other people that have contributed to this docker image.
- <code>links</code> : addtional links to help people when using this docker image, for example values that can be used are <code>source</code> to link to the source code, <code>issues</code> to link to issue tracking system, and <code>documentation</code> to link to model specific documentation.
- <code>citation</code> : how the model should be cited in publications.</p>
</div>
<div id="model-docker-Dockerfile" class="section level3">
<h3><span class="header-section-number">29.4.2</span> Model build</h3>
<p>In general we try to minimize the size of the images. To be able to do this we split the process of creating the building of the model images into two pieces (or leverage of an image that exists from the original model developers). If you look at the example Dockerfile you will see that there are 2 sections, the first section will build the model binary, the second section will build the actual PEcAn model, which copies the binary from the first section.</p>
<p>This is an example of how the ED2 model is build. This will install all the packages needed to build ED2 model, gets the latest version from GitHub and builds the model.</p>
<p>The second section will create the actual model runner. This will leverage the PEcAn model image that has PEcAn already installed as well as the python code to listen for messages and run the actual model code. This will install some additional packages needed by the model binary (more about that below), copy the model_info.json file and change the <code>@VERSION@</code> and <code>@BINARY@</code> placeholders.</p>
<p>It is important values for <code>type</code> and <code>version</code> are set correct. The PEcAn code will use these to register the model with the BETY database, which is then used by PEcAn to send out a message to a specfic worker queue, if you do not set these variables correctly your model executor will pick up messages for the wrong model.</p>
<p>To build the docker image, we use a Dockerfile (see example below) and run the following command. This command will expect the Dockerfile to live in the model specific folder and the command is executed in the root pecan folder. It will copy the content of the pecan folder and make it available to the build process (in this example we do not need any additional files).</p>
<p>Since we can have multiple different versions of a model be available for PEcAn we ar using the following naming schema <code>pecan/model-&lt;modeltype&gt;-&lt;version&gt;:&lt;pecan version</code>. For example the image below will be named pecan/model-ed2-git, since we do not specify the exact version it will be atomically be named <code>pecan/model-ed2-git:latest</code>.</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">docker</span> build \
    --tag pecan/model-ed2-git \
    --file models/ed/Dockerfile \
    .</code></pre>
<p>Example of a Dockerfile, in this case to build the ED2 model.</p>
<pre class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span class="co"># ----------------------------------------------------------------------</span>
<span class="co"># BUILD MODEL BINARY</span>
<span class="co"># ----------------------------------------------------------------------</span>
<span class="kw">FROM</span> debian:stretch as model-binary

<span class="co"># Some variables that can be used to set control the docker build</span>
<span class="kw">ARG</span> MODEL_VERSION=git

<span class="co"># install dependencies</span>
<span class="kw">RUN</span> apt-get update \
    &amp;&amp; apt-get install -y --no-install-recommends \
       build-essential \
       curl \
       gfortran \
       git \
       libhdf5-dev \
       libopenmpi-dev \
    &amp;&amp; rm -rf /var/lib/apt/lists/*

<span class="co"># download, unzip and build ed2</span>
<span class="kw">WORKDIR</span> /src
<span class="kw">RUN</span> git -c http.sslVerify=false clone https://github.com/EDmodel/ED2.git \
    &amp;&amp; cd ED2/ED/build \
    &amp;&amp; curl -o make/include.mk.VM http://isda.ncsa.illinois.edu/~kooper/EBI/include.mk.opt.Linux \
    &amp;&amp; if [ <span class="st">&quot;${MODEL_VERSION}&quot;</span> != <span class="st">&quot;git&quot;</span> ]; then git checkout ${MODEL_VERSION}; fi \
    &amp;&amp; ./install.sh -g -p VM

<span class="co">########################################################################</span>

<span class="co"># ----------------------------------------------------------------------</span>
<span class="co"># BUILD PECAN FOR MODEL</span>
<span class="co"># ----------------------------------------------------------------------</span>
<span class="kw">FROM</span> pecan/models:latest

<span class="co"># ----------------------------------------------------------------------</span>
<span class="co"># INSTALL MODEL SPECIFIC PIECES</span>
<span class="co"># ----------------------------------------------------------------------</span>

<span class="kw">RUN</span> apt-get update \
    &amp;&amp; apt-get install -y --no-install-recommends \
       libgfortran3 \
       libopenmpi2 \
    &amp;&amp; rm -rf /var/lib/apt/lists/*

<span class="co"># ----------------------------------------------------------------------</span>
<span class="co"># SETUP FOR SPECIFIC MODEL</span>
<span class="co"># ----------------------------------------------------------------------</span>

<span class="co"># Some variables that can be used to set control the docker build</span>
<span class="kw">ARG</span> MODEL_VERSION=git

<span class="co"># Setup model_info file</span>
<span class="kw">COPY</span> models/ed/model_info.json /work/model.json
<span class="kw">RUN</span> sed -i -e <span class="st">&quot;s/@VERSION@/${MODEL_VERSION}/g&quot;</span> \
           -e <span class="st">&quot;s#@BINARY@#/usr/local/bin/ed2.${MODEL_VERSION}#g&quot;</span> /work/model.json

<span class="co"># COPY model binary</span>
<span class="kw">COPY</span> --from=model-binary /src/ED2/ED/build/ed_2.1-opt /usr/local/bin/ed2.${MODEL_VERSION}</code></pre>
<p><strong>WARNING</strong>: Dockerfile environment variables set via <code>ENV</code> are assigned <em>all at once</em>; <em>they do not evaluate successively, left to right</em>.
Consider the following block:</p>
<pre class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span class="co"># Don&#39;t do this!</span>
<span class="kw">ENV</span> MODEL_TYPE=<span class="st">&quot;SIPNET&quot;</span> \
    MODEL_VERSION=136 \
    MODEL_TYPE_VERSION=${MODEL_TYPE}_${MODEL_VERSION}   <span class="co"># &lt;- Doesn&#39;t know about MODEL_TYPE or MODEL_VERSION!</span></code></pre>
<p>In this block, the expansion for setting <code>MODEL_TYPE_VERSION</code> <em>is not aware</em> of the current values of <code>MODEL_TYPE</code> or <code>MODEL_VERSION</code>, and will therefore be set incorrectly to just <code>_</code> (unless they have been set previously, in which case it will be aware only of their earlier values).
As such, <strong>variables depending on other variables must be set in a separate, subsequent <code>ENV</code> statement than the variables they depend on</strong>.</p>
<p>Once the model has build and is working we can add it to the PEcAn stack and be able to use this model in the web interface. There are two methods to start this new model. First, we can add it to the <code>docker-compose.yml</code> file and start the container using <code>docker-compose -p pecan -d up</code>.</p>
<pre class="sourceCode yaml"><code class="sourceCode yaml">  <span class="fu">sipnet:</span>
    <span class="fu">image:</span><span class="at"> pecan/model-ed2-git</span>
    <span class="fu">networks:</span>
      <span class="kw">-</span> pecan
    <span class="fu">volumes:</span>
      <span class="kw">-</span> <span class="fu">pecan:</span><span class="at">/data</span>
    <span class="fu">depends_on:</span>
       <span class="kw">-</span> rabbitmq
    <span class="fu">restart:</span><span class="at"> unless-stopped</span></code></pre>
<p>Alternatively we can start the container manually using the following command.</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">docker</span> run \
    --detach \
    --rm \
    --name pecan-ed2-git \
    --networks pecan_pecan \
    --volume pecan_pecan:/data
    <span class="ex">pecan/model-ed2-git</span></code></pre>
</div>
<div id="common-problems" class="section level3">
<h3><span class="header-section-number">29.4.3</span> Common problems</h3>
<p>Following are some solutions for common problems that you might encounter when building the docker images for a model.</p>
<div id="debugging-missing-libraries" class="section level4">
<h4><span class="header-section-number">29.4.3.1</span> Debugging missing libraries</h4>
<p>When building the model binary it might require specific libraries to be installed. In the second stage the model binary is copied into a new image, which could result in the binary missing specific libraries. In the case of the ED2 model the following was used to find the libraries that are needed to be installed (libgfortran5 and libopenmpi3).</p>
<p>The first step is to build the model using the Dockerfile (in this case the ap-get install was missing in the second stage).</p>
<pre><code>Step 5/9 : RUN git clone https://github.com/EDmodel/ED2.git     &amp;&amp; cd ED2/ED/build     &amp;&amp; curl -o make/include.mk.VM http://isda.ncsa.illinois.edu/~kooper/EBI/include.mk.opt.`uname -s`     &amp;&amp; if [ &quot;${MODEL_VERSION}&quot; != &quot;git&quot; ]; then git checkout ${MODEL_VERSION}; fi     &amp;&amp; ./install.sh -g -p VM
... LOTS OF OUTPUT ...
make[1]: Leaving directory &#39;/src/ED2/ED/build/bin-opt-E&#39;
Installation Complete.
Removing intermediate container a53eba9a8fc1
 ---&gt; 7f23c6302130
Step 6/9 : FROM pecan/executor:latest
 ---&gt; f19d81b739f5
... MORE OUTPUT ...
Step 9/9 : COPY --from=model-binary /src/ED2/ED/build/ed_2.1-opt /usr/local/bin/ed2.${MODEL_VERSION}
 ---&gt; 07ac841be457
Successfully built 07ac841be457
Successfully tagged pecan/pecan-ed2:latest</code></pre>
<p>At this point we have created a docker image with the binary and all PEcAn code that is needed to run the model. Some models (especially those build as native code) might be missing additional packages that need to be installed in the docker image. To see if all libraries are installed for the binary.</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="op">&gt;</span> <span class="ex">docker</span> run -ti --rm pecan/pecan-ed2 /bin/bash
<span class="ex">root@8a95ee8b6b47</span>:/work# ldd /usr/local/bin/ed2.git  <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&quot;not found&quot;</span>
    <span class="ex">libmpi_usempif08.so.40</span> =<span class="op">&gt;</span> not found
    <span class="ex">libmpi_usempi_ignore_tkr.so.40</span> =<span class="op">&gt;</span> not found
    <span class="ex">libmpi_mpifh.so.40</span> =<span class="op">&gt;</span> not found
    <span class="ex">libmpi.so.40</span> =<span class="op">&gt;</span> not found
    <span class="ex">libgfortran.so.5</span> =<span class="op">&gt;</span> not found</code></pre>
<p>Start the build container again (this is the number before the line FROM pecan/executor:latest, 7f23c6302130 in the example), and find the missing libraries listed above (for example libmpi_usempif08.so.40):</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="op">&gt;</span> <span class="ex">docker</span> run --rm -ti 7f23c6302130
<span class="ex">root@e716c63c031f</span>:/src# dpkg -S libmpi_usempif08.so.40
<span class="ex">libopenmpi3</span>:amd64: /usr/lib/x86_64-linux-gnu/openmpi/lib/libmpi_usempif08.so.40.10.1
<span class="ex">libopenmpi3</span>:amd64: /usr/lib/x86_64-linux-gnu/libmpi_usempif08.so.40.10.1
<span class="ex">libopenmpi3</span>:amd64: /usr/lib/x86_64-linux-gnu/libmpi_usempif08.so.40</code></pre>
<p>This shows the pages is libopenmpi3 that needs to be installed, do this for all missing packages, modify the Dockerfile and rebuild. Next time you run the ldd command there should be no more packages being listed.</p>

</div>
</div>
</div>
<div id="docker-build-images" class="section level2">
<h2><span class="header-section-number">29.5</span> Building and modifying images</h2>
<p>For general use, it is sufficient to use the pre-built PEcAn images hosted on <a href="https://hub.docker.com/r/pecan/">Docker Hub</a> (see <a href="docker-index.html#docker-quickstart">Docker quickstart</a>).
However, there are cases where it makes sense to re-build the Docker images locally.
The following is a list of PEcAn-specific images and reasons why you would want to rebuild them locally:</p>
<ul>
<li><code>pecan/depends</code> – Rebuild if:
<ul>
<li>You modify the <code>docker/base/Dockerfile.depends</code></li>
<li>You introduce new system dependencies (i.e. things that need to be installed with <code>apt-get</code>)</li>
<li>You introduce new R package dependencies, and you want those R package installations to be cached during future builds. For packages with fast build times, it may be fine to let them be installed as part of PEcAn’s standard build process (i.e. <code>make</code>).</li>
</ul></li>
<li><code>pecan/base</code> – Rebuild if:
<ul>
<li>You built a new version of <code>pecan/depends</code> (on which <code>pecan/base</code> depends)</li>
<li>You modify the <code>docker/base/Dockerfile.base</code></li>
<li>You made changes to the PEcAn R package source code, the Makefile, or <code>web/workflow.R</code>.
<ul>
<li>NOTE that changes to the web interface code affect <code>pecan/web</code>, <em>not</em> <code>pecan/base</code></li>
</ul></li>
</ul></li>
<li><code>pecan/executor</code> – Rebuild if:
<ul>
<li>You built a new version of <code>pecan/base</code> (on which <code>pecan/executor</code> depends) and/or, <code>pecan/depends</code> (on which <code>pecan/base</code> depends)</li>
<li>You modified the <code>docker/base/Dockerfile.executor</code></li>
<li>You modified the RabbitMQ Python scripts (e.g. <code>docker/receiver.py</code>, <code>docker/sender.py</code>)</li>
</ul></li>
<li><code>pecan/web</code> – Rebuild if you modified any of the following:
<ul>
<li><code>docker/base/Dockerfile.web</code></li>
<li>The PHP/HTML/JavaScript code for the PEcAn web interface in <code>web/</code> (<em>except</em> <code>web/workflow.R</code> – that goes in <code>pecan/base</code>)</li>
<li><code>docker/config.docker.php</code> (the <code>config.php</code> file for Docker web instances)</li>
<li><code>documentation/index_vm.html</code> (the documentation HTML website)</li>
<li>NOTE: Because changes to this code are applied instantly (i.e. do not require compilation or installation), a more effective way to do local development may be to mount the <code>web/</code> or other relevant folders as a volume onto the <code>pecan/web</code> container.</li>
</ul></li>
</ul>
<p>The easiest way to quickly re-build all of the images is using the <code>docker.sh</code> script in the PEcAn source code root directory.
This script will build all of the docker images locally on your machine, and tag them as <code>latest</code>.
This will not build the <code>pecan/depends</code> image by default because that takes considerably longer.
However, you can force the script to build <code>pecan/depends</code> as well by setting the <code>DEPEND</code> environment variable to 1 (i.e. <code>DEPEND=1 ./docker.sh</code>).
The following instructions provide details on how to build each image individually.</p>
<p>To build an image locally, use the <code>docker build</code> command as described below.
For more details, see <code>docker build --help</code> or the <a href="https://docs.docker.com/engine/reference/commandline/build/">online Docker build documentation</a>.</p>
<p>First, in a terminal window, navigate (<code>cd</code>) into the PEcAn source code root directory.
From there, the general syntax for building an image looks like the following:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">docker</span> build -t pecan/<span class="op">&lt;</span>image name<span class="op">&gt;</span>:<span class="op">&lt;</span>image version<span class="op">&gt;</span> -f docker/base/Dockerfile.<span class="op">&lt;</span>image name<span class="op">&gt;</span> .</code></pre>
<p>For instance, to build a local version of the <code>pecan/depends:latest</code> image, you would run:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">docker</span> build -t pecan/depends:latest -f docker/base/Dockerfile.depends .</code></pre>
<p>The breakdown of this command is as follows:</p>
<ul>
<li><p><code>docker build</code> – This is the core command.
The standard syntax is <code>docker build [OPTIONS] &lt;PATH&gt;</code>, where <code>&lt;PATH&gt;</code> refers to the directory to be used as the “build context”.
The “build context” is the working directory assumed by the Dockerfiles.
In PEcAn, this is always the PEcAn source code root directory, which allows Dockerfiles to use instructions such as <code>COPY web/workflow.R /work/</code>.
In this example, the <code>&lt;PATH&gt;</code> is set to the current working directory, i.e. <code>.</code> because we are already in the PEcAn root directory.
If you were located in a different directory, you would have to provide a path to the PEcAn source code root directory.
Also, by default, <code>docker build</code> will look for a Dockerfile located at <code>&lt;PATH&gt;/Dockerfile</code>, but this is modified by the <code>-f</code> option described below.</p></li>
<li><code>-t pecan/depends:latest</code> – The <code>-t/--tag</code> option specifies how the image will be labeled.
By default, Docker only defines unique image IDs, which are hexidecimal strings that are unintuitive and hard to remember.
Tags are useful for referring to specific images in a human-readable way.
Note that the same unique image can have multiple tags associated with it, so it is possible for, e.g. <code>pecan/depends:latest</code>, <code>pecan/depends:custom</code>, and even <code>mypecan/somethingelse:20.0</code> to refer to the same exact image.
To see a table of all local images, including their tags and IDs, run <code>docker image ls</code>.
<ul>
<li><strong>NOTE</strong>: PEcAn’s <code>docker-compose.yml</code> can be configured via the <code>PECAN</code> environment variable to point at different versions of PEcAn images.
By default, it points to the <code>:latest</code> versions of all images.
However, if you wanted to, for instance, build <code>:local</code> images corresponding to your local source code and then run that version of PEcAn, you would run:</li>
</ul>
<pre><code>PECAN=local docker-compose -p pecan up -d</code></pre>
<p>This is an effective way to do local development and testing of different PEcAn versions, as described <a href="docker-index.html#docker-local-devel">below</a>.</p></li>
<li><p><code>-f docker/base/Dockerfile.depends</code> – The <code>-f/--file</code> tag is used to provide an alternative location and file name for the Dockerfile.
The convention in PEcAn is to put Dockerfiles for core PEcAn functionality in <code>docker/base/</code> and for specific models in <code>docker/models/</code>, and to name these files <code>Dockerfile.&lt;image name&gt;</code>.</p></li>
</ul>
<div id="docker-local-devel" class="section level3">
<h3><span class="header-section-number">29.5.1</span> Local development and testing with Docker</h3>
<p>The following is an example of one possible workflow for developing and testing PEcAn using local Docker images.
The basic idea is to mount a local version of the PEcAn source code onto a running <code>pecan/executor</code> image, and then send a special “rebuild” RabbitMQ message to the container to trigger the rebuild whenever you make changes.
NOTE: All commands assume you are working from the PEcAn source code root directory.</p>
<ol style="list-style-type: decimal">
<li><p>In the PEcAn source code directory, create a <code>docker-compose.override.yml</code> file with the following contents.:</p>
<pre class="sourceCode yml"><code class="sourceCode yaml"><span class="fu">version:</span><span class="at"> </span><span class="st">&quot;3&quot;</span>
<span class="fu">services:</span>
  <span class="fu">executor:</span>
    <span class="fu">volumes:</span>
      <span class="kw">-</span> <span class="fu">.:</span><span class="at">/pecan</span></code></pre>
<p>This will mount the current directory <code>.</code> to the <code>/pecan</code> directory in the <code>executor</code> container.
The special <code>docker-compose.override.yml</code> file is read automatically by <code>docker-compose</code> and overrides or extends any instructions set in the original <code>docker-compose.yml</code> file.
It provides a convenient way to host server-specific configurations without having to modify the project-wide (and version-controlled) default configuration.
For more details, see the <a href="https://docs.docker.com/compose/extends/">Docker Compose documentation</a>.</p></li>
<li><p>Update your PEcAn Docker stack with <code>docker-compose up -d</code>.
If the stack is already running, this should only restart your <code>executor</code> instance while leaving the remaining containers running.</p></li>
<li><p>To update to the latest local code, run <code>./scripts/docker_rebuild.sh</code>.
Under the hood, this uses <code>curl</code> to post a RabbitMQ message to a running Docker instance.
By default, the scripts assumes that username and password are both <code>guest</code> and that the RabbitMQ URL is <code>http://localhost:8000/rabbitmq</code>.
All of these can be customized by setting the environment variables <code>RABBITMQ_USER</code>, <code>RABBITMQ_PASSWORD</code>, and <code>RABBITMQ_URL</code>, respectively (or running the script prefixed with those variables, e.g. <code>RABBITMQ_USER=carya RABBITMQ_PASSWORD=illinois ./scripts/docker_rebuild.sh</code>).
This step can be repeated whenever you want to trigger a rebuild of the local code.</p></li>
</ol>
<p>NOTE: The updates with this workflow are <em>specific to the running container session</em>; restarting the <code>executor</code> container will revert to the previous versions of the installed packages.
To make persistent changes, you should re-build the <code>pecan/base</code> and <code>pecan/executor</code> containers against the current version of the source code.</p>
<p>NOTE: The mounted PEcAn source code directory includes <em>everything</em> in your local source directory, <em>including installation artifacts used by make</em>.
This can lead to two common issues:
- Any previous make cache files (stuff in the <code>.install</code>, <code>.docs</code>, etc. directories) persist across container instances, even though the installed packages may not. To ensure a complete build, it’s a good idea to run <code>make clean</code> on the host machine to remove these artifacts.
- Similarly, any installation artifacts from local builds will be carried over to the build. In particular, be wary of packages with compiled code, such as <code>modules/rtm</code> (<code>PEcAnRTM</code>) – the compiled <code>.o</code>, <code>.so</code>, <code>.mod</code>, etc. files from compilation of such packages will carry over into the build, which can cause conflicts if the package was also built locally.</p>
<p>The <code>docker-compose.override.yml</code> is useful for some other local modifications.
For instance, the following adds a custom ED2 “develop” model container.</p>
<pre class="sourceCode yml"><code class="sourceCode yaml"><span class="fu">services:</span>
  <span class="co"># ...</span>
  <span class="fu">ed2devel:</span>
    <span class="fu">image:</span><span class="at"> pecan/model-ed2-develop:latest</span>
    <span class="fu">build:</span>
      <span class="fu">context:</span><span class="at"> ../ED2  </span><span class="co"># Or wherever ED2 source code is found</span>
    <span class="fu">networks:</span>
      <span class="kw">-</span> pecan
    <span class="fu">depends_on:</span>
      <span class="kw">-</span> rabbitmq
    <span class="fu">volumes:</span>
      <span class="kw">-</span> <span class="fu">pecan:</span><span class="at">/data</span>
    <span class="fu">restart:</span><span class="at"> unless-stopped</span></code></pre>
<p>Similarly, this snippet modifies the <code>pecan</code> network to use a custom IP subnet mask.
This is required on the PNNL cluster because its servers’ IP addresses often clash with Docker’s default IP mask.</p>
<pre class="sourceCode yml"><code class="sourceCode yaml"><span class="fu">networks:</span>
  <span class="fu">pecan:</span>
    <span class="fu">ipam:</span>
      <span class="fu">config:</span>
        <span class="kw">-</span> <span class="fu">subnet:</span><span class="at"> 10.17.1.0/24</span></code></pre>

</div>
<div id="docker-troubleshooting" class="section level3">
<h3><span class="header-section-number">29.5.2</span> Troubleshooting Docker</h3>
<div id="package-not-available-while-building-images" class="section level4">
<h4><span class="header-section-number">29.5.2.1</span> “Package not available” while building images</h4>
<p><strong>PROBLEM</strong>: Packages fail to install while building <code>pecan/depends</code> and/or <code>pecan/base</code> with an error like the following:</p>
<pre><code>Installing package into ‘/usr/local/lib/R/site-library’
(as ‘lib’ is unspecified)
Warning: unable to access index for repository https://mran.microsoft.com/snapshot/2018-09-01/src/contrib:
 cannot open URL &#39;https://mran.microsoft.com/snapshot/2018-09-01/src/contrib/PACKAGES&#39;
Warning message:
package ‘&lt;PACKAGE&gt;’ is not available (for R version 3.5.1)</code></pre>
<p><strong>CAUSE</strong>: This can sometimes happen if there are problems with Microsoft’s CRAN snapshots, which are the default repository for the <code>rocker/tidyverse</code> containers.
See GitHub issues <a href="https://github.com/rocker-org/rocker-versioned/issues/102">rocker-org/rocker-versioned#102</a> and <a href="https://github.com/rocker-org/rocker-versioned/issues/58">#58</a>.</p>
<p><strong>SOLUTION</strong>: Add the following line to the <code>depends</code> and/or <code>base</code> Dockerfiles <em>before</em> (i.e. above) any commands that install R packages (e.g. <code>Rscript -e &quot;install.packages(...)&quot;</code>):</p>
<pre><code>RUN echo &quot;options(repos = c(CRAN = &#39;https://cran.rstudio.org&#39;))&quot; &gt;&gt; /usr/local/lib/R/etc/Rprofile.site</code></pre>
<p>This will set the default repository to the more reliable (albeit, more up-to-date; beware of breaking package changes!) RStudio CRAN mirror.
Then, build the image as usual.</p>

</div>
</div>
</div>
<div id="docker-migrate" class="section level2">
<h2><span class="header-section-number">29.6</span> Migrating PEcAn from VM to Docker</h2>
<p>This document assumes you have read through the <a href="docker-index.html#docker-intro">Introduction to Docker</a> as well as <a href="docker-index.html#docker-quickstart">Docker quickstart</a> and have docker running on the VM.</p>
<p>This document will slowly replace each of the components with the appropriate docker images. At then end of this document you should be able to use the docker-compose command to bring up the full docker stack as if you had started with this origianally.</p>
<div id="running-bety-as-a-docker-container" class="section level3">
<h3><span class="header-section-number">29.6.1</span> Running BETY as a docker container</h3>
<p>This will replace the BETY application running on the machine with a docker image. This will assume you still have the database running on the local machine and the only thing we replace is the BETY application.</p>
<p>If you are running systemd (Ubuntu 16.04 or Centos 7) you can copy the following file to /etc/systemd/system/bety.service (replace LOCAL_SERVER=99 with your actual server). If you have postgres running on another server replace 127.0.0.1 with the actual ip address of the postgres server.</p>
<pre><code>[Unit]
Description=BETY container
After=docker.service

[Service]
Restart=always
ExecStart=/usr/bin/docker run -t --rm --name bety --add-host=postgres:127.0.0.1 --network=host --env RAILS_RELATIVE_URL_ROOT=/bety --env LOCAL_SERVER=99 pecan/bety
ExecStop=/usr/bin/docker stop -t 2 bety

[Install]
WantedBy=local.target</code></pre>
<p>At this point we can enable the bety service (this only needs to be done once). First we need to tell systemd a new service is available using <code>systemctl daemon-reload</code>. Next we enable the BETY service so it will restart automatically when the machine reboots, using <code>systemctl enable bety</code>. Finally we can start the BETY service using <code>systemctl start bety</code>. At this point BETY is running as a docker container on port 8000. You can see the log messages using <code>journalctl -u bety</code>.</p>
<p>Next we need to modify apache configuration files. The file /etc/apache2/conf-enabled/bety.conf will be replaced with the following content:</p>
<pre><code>ProxyPass                /bety/ http://localhost:8000/bety/
ProxyPassReverse         /bety/ http://localhost:8000/bety/
RedirectMatch permanent ^/bety$ /bety/</code></pre>
<p>Once this modified we can restart apache using <code>systemctl restart apache2</code>. At this point BETY is running in a container and is accessable trough the webserver at <a href="http://server/bety/" class="uri">http://server/bety/</a>.</p>
<p>To upgrade to a new version of BETY you can now use the docker commands. You can use the following commands to stop BETY, pull the latest image down, migrate the database (you made a backup correct?) and start BETY again.</p>
<pre><code>systemctl stop bety
docker pull pecan/bety:latest
docker run -ti --rm --add-host=postgres:127.0.0.1 --network=host --env LOCAL_SERVER=99 pecan/bety migrate
systemctl start bety</code></pre>
<p>Once you are satisfied with the migration of BETY you can remove the bety folder as well as any ruby binaries you have installed.</p>

</div>
<div id="using-the-pecan-download.file-function" class="section level3">
<h3><span class="header-section-number">29.6.2</span> Using the PEcAn download.file() function</h3>
<p>download.file(url, destination_file, method) <br>
<br></p>
<p>This custom PEcAn function works together with the base R function download.file (<a href="https://stat.ethz.ch/R-manual/R-devel/library/utils/html/download.file.html" class="uri">https://stat.ethz.ch/R-manual/R-devel/library/utils/html/download.file.html</a>). However, it provides expanded functionality to generalize the use for a broad range of environments. This is because some computing environments are behind a firewall or proxy, including FTP firewalls. This may require the use of a custom FTP program and/or initial proxy server authentication to retrieve the files needed by PEcAn (e.g. meteorology drivers, other inputs) to run certain model simulations or tools. For example, the Brookhaven National Laboratory (BNL) requires an initial connection to a FTP proxy before downloading files via FTP protocol. As a result, the computers running PEcAn behind the BNL firewall (e.g. <a href="https://modex.bnl.gov" class="uri">https://modex.bnl.gov</a>) use the ncftp cleint (<a href="http://www.ncftp.com/" class="uri">http://www.ncftp.com/</a>) to download files for PEcAn because the base options with R::base download.file() such as curl, libcurl which don’t have the functionality to provide credentials for a proxy or even those such as wget which do but don’t easily allow for connecting through a proxy server before downloading files. The current option for use in these instances is <strong>ncftp</strong>, specifically <strong>ncftpget</strong></p>
<p><br></p>
<p>Examples: <br>
<em>HTTP</em> <br></p>
<pre><code>download.file(&quot;http://lib.stat.cmu.edu/datasets/csb/ch11b.txt&quot;,&quot;~/test.download.txt&quot;) </code></pre>
<p><em>FTP</em></p>
<pre><code>download.file(&quot;ftp://ftp.cdc.noaa.gov/Datasets/NARR/monolevel/pres.sfc.2000.nc&quot;, &quot;~/pres.sfc.2000.nc&quot;)</code></pre>
<p><em>customizing to use ncftp when running behind an FTP firewall (requires ncftp to be installed and availible)</em> <br></p>
<pre><code>download.file(&quot;ftp://ftp.cdc.noaa.gov/Datasets/NARR/monolevel/pres.sfc.2000.nc&quot;, &quot;~/pres.sfc.2000.nc&quot;, method=&quot;&quot;ncftpget&quot;)</code></pre>
<p><br></p>
<p>On modex.bnl.gov, the ncftp firewall configuration file (e.g. ~/.ncftp/firewall) is configured as:
firewall-type=1
firewall-host=ftpgateway.sec.bnl.local
firewall-port=21</p>
<p>which then allows for direct connection through the firewall using a command like:</p>
<pre><code>ncftpget ftp://ftp.unidata.ucar.edu/pub/netcdf/netcdf-fortran-4.4.4.tar.gz</code></pre>
<p>To allow the use of ncftpget from within the download.file() function you need to set your R profile download.ftp.method option in your options list. To see your current R options run options() from R cmd, which should look something like this:</p>
<pre><code>&gt; options()
$add.smooth
[1] TRUE

$bitmapType
[1] &quot;cairo&quot;

$browser
[1] &quot;/usr/bin/xdg-open&quot;

$browserNLdisabled
[1] FALSE

$CBoundsCheck
[1] FALSE

$check.bounds
[1] FALSE

$citation.bibtex.max
[1] 1

$continue
[1] &quot;+ &quot;

$contrasts
        unordered           ordered
&quot;contr.treatment&quot;      &quot;contr.poly&quot;</code></pre>
<p>In order to set your download.ftp.method option you need to add a line such as</p>
<pre><code># set default FTP
options(download.ftp.method = &quot;ncftpget&quot;)</code></pre>
<p>In your ~/.Rprofile. On modex at BNL we have set the global option in /usr/lib64/R/etc/Rprofile.site.</p>
<p>Once this is done you should be able to see the option set using this command in R:</p>
<pre><code>&gt; options(&quot;download.ftp.method&quot;)
$download.ftp.method
[1] &quot;ncftpget&quot;</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="available-meteorological-drivers.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="shiny.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/PecanProject/pecan/edit/master/book_source/06_reference/04_docker/00_docker_index.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
