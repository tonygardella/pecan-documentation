<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>6 Developer guide | The Predictive Ecosystem Analyzer</title>
  <meta name="description" content="6 Developer guide | The Predictive Ecosystem Analyzer">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="6 Developer guide | The Predictive Ecosystem Analyzer" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Developer guide | The Predictive Ecosystem Analyzer" />
  
  
  

<meta name="author" content="By: PEcAn Team">


<meta name="date" content="2019-04-29">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="user-section.html">
<link rel="next" href="pecan-standards.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.5/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/dt-ext-fixedcolumns-1.10.16/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-fixedcolumns-1.10.16/js/dataTables.fixedColumns.min.js"></script>
<script src="libs/jszip-1.10.16/jszip.min.js"></script>
<script src="libs/pdfmake-1.10.16/pdfmake.min.js"></script>
<script src="libs/pdfmake-1.10.16/vfs_fonts.js"></script>
<link href="libs/dt-ext-buttons-1.10.16/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-buttons-1.10.16/js/dataTables.buttons.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.flash.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.html5.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.colVis.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.16/js/buttons.print.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="project-overview.html"><a href="project-overview.html"><i class="fa fa-check"></i><b>1</b> Project Overview</a></li>
<li class="chapter" data-level="2" data-path="contributor-covenant-code-of-conduct.html"><a href="contributor-covenant-code-of-conduct.html"><i class="fa fa-check"></i><b>2</b> Contributor Covenant Code of Conduct</a></li>
<li class="chapter" data-level="3" data-path="about-the-pecan-book.html"><a href="about-the-pecan-book.html"><i class="fa fa-check"></i><b>3</b> About the PEcAn Book</a><ul>
<li class="chapter" data-level="3.0.1" data-path="about-the-pecan-book.html"><a href="about-the-pecan-book.html#general-feedbackcommentssuggestions"><i class="fa fa-check"></i><b>3.0.1</b> General Feedback/Comments/Suggestions</a></li>
<li class="chapter" data-level="3.1" data-path="about-the-pecan-book.html"><a href="about-the-pecan-book.html#bookediting"><i class="fa fa-check"></i><b>3.1</b> Editing this book</a></li>
</ul></li>
<li class="part"><span><b>II Tutorials,Demos and How To’s</b></span></li>
<li class="chapter" data-level="4" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html"><i class="fa fa-check"></i><b>4</b> Install PEcAn</a><ul>
<li class="chapter" data-level="4.1" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#pecanvm"><i class="fa fa-check"></i><b>4.1</b> PEcAn Virtual Machine</a><ul>
<li class="chapter" data-level="4.1.1" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#maintain-vm"><i class="fa fa-check"></i><b>4.1.1</b> Maintaining your PEcAn VM</a></li>
<li class="chapter" data-level="4.1.2" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#working-with-vm"><i class="fa fa-check"></i><b>4.1.2</b> Working with the VM</a></li>
<li class="chapter" data-level="4.1.3" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#awsvm"><i class="fa fa-check"></i><b>4.1.3</b> Using Amazon Web Services for a VM (AWS)</a></li>
<li class="chapter" data-level="4.1.4" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#createvm"><i class="fa fa-check"></i><b>4.1.4</b> Creating a Virtual Machine</a></li>
<li class="chapter" data-level="4.1.5" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#vm-dektop-conversion"><i class="fa fa-check"></i><b>4.1.5</b> VM Desktop Conversion</a></li>
<li class="chapter" data-level="4.1.6" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#aws-setup"><i class="fa fa-check"></i><b>4.1.6</b> AWS Setup</a></li>
<li class="chapter" data-level="4.1.7" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#porting-vm-to-aws"><i class="fa fa-check"></i><b>4.1.7</b> Porting VM to AWS</a></li>
<li class="chapter" data-level="4.1.8" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#set-up-multiple-instances-optional"><i class="fa fa-check"></i><b>4.1.8</b> Set up multiple instances (optional)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#shiny-setup"><i class="fa fa-check"></i><b>4.2</b> Shiny Setup</a><ul>
<li class="chapter" data-level="4.2.1" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#install-the-shiny-r-package-and-shiny-server"><i class="fa fa-check"></i><b>4.2.1</b> Install the Shiny R package and Shiny server</a></li>
<li class="chapter" data-level="4.2.2" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#modify-the-shiny-configuration-file"><i class="fa fa-check"></i><b>4.2.2</b> Modify the shiny configuration file</a></li>
<li class="chapter" data-level="4.2.3" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#set-the-apache-proxy"><i class="fa fa-check"></i><b>4.2.3</b> Set the Apache proxy</a></li>
<li class="chapter" data-level="4.2.4" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#enable-and-start-the-shiny-server-and-restart-apache"><i class="fa fa-check"></i><b>4.2.4</b> Enable and start the shiny server, and restart apache</a></li>
<li class="chapter" data-level="4.2.5" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#troubleshooting"><i class="fa fa-check"></i><b>4.2.5</b> Troubleshooting</a></li>
<li class="chapter" data-level="4.2.6" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#further-reading"><i class="fa fa-check"></i><b>4.2.6</b> Further reading</a></li>
<li class="chapter" data-level="4.2.7" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#thredds-setup"><i class="fa fa-check"></i><b>4.2.7</b> Thredds Setup</a></li>
<li class="chapter" data-level="4.2.8" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#install-the-tomcat-8-and-thredds-webapp"><i class="fa fa-check"></i><b>4.2.8</b> Install the Tomcat 8 and Thredds webapp</a></li>
<li class="chapter" data-level="4.2.9" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#update-the-catalog"><i class="fa fa-check"></i><b>4.2.9</b> Update the catalog</a></li>
<li class="chapter" data-level="4.2.10" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#troubleshooting-1"><i class="fa fa-check"></i><b>4.2.10</b> Troubleshooting</a></li>
<li class="chapter" data-level="4.2.11" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#further-reading-1"><i class="fa fa-check"></i><b>4.2.11</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#docker-index"><i class="fa fa-check"></i><b>4.3</b> Docker</a><ul>
<li class="chapter" data-level="4.3.1" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#setup-pecan-using-docker-compose"><i class="fa fa-check"></i><b>4.3.1</b> Setup PEcAn using docker-compose</a></li>
<li class="chapter" data-level="4.3.2" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#pecan-docker-quickstart-init"><i class="fa fa-check"></i><b>4.3.2</b> Initialize PEcAn (first time only)</a></li>
<li class="chapter" data-level="4.3.3" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#docker-quickstart-troubleshooting"><i class="fa fa-check"></i><b>4.3.3</b> Troubleshooting</a></li>
<li class="chapter" data-level="4.3.4" data-path="pecan-manual-setup.html"><a href="pecan-manual-setup.html#osinstall"><i class="fa fa-check"></i><b>4.3.4</b> OS Specific Installations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="user-section.html"><a href="user-section.html"><i class="fa fa-check"></i><b>5</b> User Tutorial Section</a><ul>
<li class="chapter" data-level="5.0.1" data-path="user-section.html"><a href="user-section.html#demo-table"><i class="fa fa-check"></i><b>5.0.1</b> PEcAn Demos</a></li>
<li class="chapter" data-level="5.1" data-path="user-section.html"><a href="user-section.html#basic-web-wrokflow"><i class="fa fa-check"></i><b>5.1</b> Basic Web workflow</a><ul>
<li class="chapter" data-level="5.1.1" data-path="user-section.html"><a href="user-section.html#web-site-model"><i class="fa fa-check"></i><b>5.1.1</b> Site and model selection</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="user-section.html"><a href="user-section.html#intermediate-user"><i class="fa fa-check"></i><b>5.2</b> PEcAn Web Interface</a></li>
<li class="chapter" data-level="5.3" data-path="user-section.html"><a href="user-section.html#advanced-user"><i class="fa fa-check"></i><b>5.3</b> Advanced User Guide</a><ul>
<li class="chapter" data-level="5.3.1" data-path="user-section.html"><a href="user-section.html#adding-to-pecan"><i class="fa fa-check"></i><b>5.3.1</b> Adding to PEcAn</a></li>
<li class="chapter" data-level="5.3.2" data-path="user-section.html"><a href="user-section.html#web-curl-submission"><i class="fa fa-check"></i><b>5.3.2</b> Submitting Workflow from Command Line</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="developer-guide.html"><a href="developer-guide.html"><i class="fa fa-check"></i><b>6</b> Developer guide</a><ul>
<li class="chapter" data-level="6.1" data-path="developer-guide.html"><a href="developer-guide.html#updatebety"><i class="fa fa-check"></i><b>6.1</b> Updating PEcAn Code and Bety Database</a></li>
<li class="chapter" data-level="6.2" data-path="developer-guide.html"><a href="developer-guide.html#pecan-git"><i class="fa fa-check"></i><b>6.2</b> Git and GitHub Workflow</a><ul>
<li class="chapter" data-level="6.2.1" data-path="developer-guide.html"><a href="developer-guide.html#using-git"><i class="fa fa-check"></i><b>6.2.1</b> Using Git</a></li>
<li class="chapter" data-level="6.2.2" data-path="developer-guide.html"><a href="developer-guide.html#github-use-with-pecan"><i class="fa fa-check"></i><b>6.2.2</b> GitHub use with PEcAn</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="developer-guide.html"><a href="developer-guide.html#coding-practices"><i class="fa fa-check"></i><b>6.3</b> Coding Practices</a></li>
<li class="chapter" data-level="6.4" data-path="developer-guide.html"><a href="developer-guide.html#coding-style"><i class="fa fa-check"></i><b>6.4</b> Coding Style</a></li>
<li class="chapter" data-level="6.5" data-path="developer-guide.html"><a href="developer-guide.html#logging"><i class="fa fa-check"></i><b>6.5</b> Logging</a><ul>
<li class="chapter" data-level="6.5.1" data-path="developer-guide.html"><a href="developer-guide.html#pecan-logging-functions"><i class="fa fa-check"></i><b>6.5.1</b> PEcAn logging functions</a></li>
<li class="chapter" data-level="6.5.2" data-path="developer-guide.html"><a href="developer-guide.html#other-r-logging-packages"><i class="fa fa-check"></i><b>6.5.2</b> Other R logging packages</a></li>
<li class="chapter" data-level="6.5.3" data-path="developer-guide.html"><a href="developer-guide.html#example-usage"><i class="fa fa-check"></i><b>6.5.3</b> Example Usage</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="developer-guide.html"><a href="developer-guide.html#package-data"><i class="fa fa-check"></i><b>6.6</b> Package Data</a></li>
<li class="chapter" data-level="6.7" data-path="developer-guide.html"><a href="developer-guide.html#roxygen2-1"><i class="fa fa-check"></i><b>6.7</b> Roxygen2</a></li>
<li class="chapter" data-level="6.8" data-path="developer-guide.html"><a href="developer-guide.html#testing"><i class="fa fa-check"></i><b>6.8</b> Testing</a></li>
<li class="chapter" data-level="6.9" data-path="developer-guide.html"><a href="developer-guide.html#download-and-compile-pecan"><i class="fa fa-check"></i><b>6.9</b> Download and Compile PEcAn</a><ul>
<li class="chapter" data-level="6.9.1" data-path="developer-guide.html"><a href="developer-guide.html#pecan-testrun"><i class="fa fa-check"></i><b>6.9.1</b> PEcAn Testrun</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="developer-guide.html"><a href="developer-guide.html#directory-structure"><i class="fa fa-check"></i><b>6.10</b> Directory structure</a></li>
</ul></li>
<li class="part"><span><b>III Topical Pages</b></span></li>
<li class="chapter" data-level="7" data-path="pecan-standards.html"><a href="pecan-standards.html"><i class="fa fa-check"></i><b>7</b> PEcAn standard formats</a><ul>
<li class="chapter" data-level="7.1" data-path="pecan-standards.html"><a href="pecan-standards.html#defining-new-input-formats"><i class="fa fa-check"></i><b>7.1</b> Defining new input formats</a></li>
<li class="chapter" data-level="7.2" data-path="pecan-standards.html"><a href="pecan-standards.html#time-standard"><i class="fa fa-check"></i><b>7.2</b> Time Standard</a><ul>
<li class="chapter" data-level="7.2.1" data-path="pecan-standards.html"><a href="pecan-standards.html#input-standards"><i class="fa fa-check"></i><b>7.2.1</b> Input Standards</a></li>
<li class="chapter" data-level="7.2.2" data-path="pecan-standards.html"><a href="pecan-standards.html#soils-and-vegetation-inputs"><i class="fa fa-check"></i><b>7.2.2</b> Soils and Vegetation Inputs</a></li>
<li class="chapter" data-level="7.2.3" data-path="pecan-standards.html"><a href="pecan-standards.html#output-standards"><i class="fa fa-check"></i><b>7.2.3</b> Output Standards</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="pecanXML.html"><a href="pecanXML.html"><i class="fa fa-check"></i><b>8</b> The PEcAn XML</a><ul>
<li class="chapter" data-level="8.0.1" data-path="pecanXML.html"><a href="pecanXML.html#xml-core-config"><i class="fa fa-check"></i><b>8.0.1</b> Core configuration</a></li>
<li class="chapter" data-level="8.0.2" data-path="pecanXML.html"><a href="pecanXML.html#xml-outdir"><i class="fa fa-check"></i><b>8.0.2</b> <code>outdir</code>: Output directory</a></li>
<li class="chapter" data-level="8.0.3" data-path="pecanXML.html"><a href="pecanXML.html#xml-database"><i class="fa fa-check"></i><b>8.0.3</b> <code>database</code>: PEcAn database settings</a></li>
<li class="chapter" data-level="8.0.4" data-path="pecanXML.html"><a href="pecanXML.html#xml-pft"><i class="fa fa-check"></i><b>8.0.4</b> <code>pft</code>: Plant functional type selection</a></li>
<li class="chapter" data-level="8.0.5" data-path="pecanXML.html"><a href="pecanXML.html#xml-meta-analysis"><i class="fa fa-check"></i><b>8.0.5</b> <code>meta.analysis</code>: Trait Meta Analysis</a></li>
<li class="chapter" data-level="8.0.6" data-path="pecanXML.html"><a href="pecanXML.html#xml-model"><i class="fa fa-check"></i><b>8.0.6</b> <code>model</code>: Model configuration</a></li>
<li class="chapter" data-level="8.0.7" data-path="pecanXML.html"><a href="pecanXML.html#xml-run"><i class="fa fa-check"></i><b>8.0.7</b> <code>run</code>: Run Setup</a></li>
<li class="chapter" data-level="8.0.8" data-path="pecanXML.html"><a href="pecanXML.html#xml-host"><i class="fa fa-check"></i><b>8.0.8</b> <code>host</code>: Host information for remote execution</a></li>
<li class="chapter" data-level="8.0.9" data-path="pecanXML.html"><a href="pecanXML.html#xml-advanced"><i class="fa fa-check"></i><b>8.0.9</b> Advanced features</a></li>
<li class="chapter" data-level="8.0.10" data-path="pecanXML.html"><a href="pecanXML.html#xml-ensemble"><i class="fa fa-check"></i><b>8.0.10</b> <code>ensemble</code>: Ensemble Runs</a></li>
<li class="chapter" data-level="8.0.11" data-path="pecanXML.html"><a href="pecanXML.html#xml-sensitivity-analysis"><i class="fa fa-check"></i><b>8.0.11</b> <code>sensitivity.analysis</code>: Sensitivity analysis</a></li>
<li class="chapter" data-level="8.0.12" data-path="pecanXML.html"><a href="pecanXML.html#xml-parameter-data-assimilation"><i class="fa fa-check"></i><b>8.0.12</b> Parameter Data Assimilation</a></li>
<li class="chapter" data-level="8.0.13" data-path="pecanXML.html"><a href="pecanXML.html#xml-multi-settings"><i class="fa fa-check"></i><b>8.0.13</b> Multi-Settings</a></li>
<li class="chapter" data-level="8.0.14" data-path="pecanXML.html"><a href="pecanXML.html#xml-state-data-assimilation"><i class="fa fa-check"></i><b>8.0.14</b> (experimental) State Data Assimilation</a></li>
<li class="chapter" data-level="8.0.15" data-path="pecanXML.html"><a href="pecanXML.html#xml-browndog"><i class="fa fa-check"></i><b>8.0.15</b> (experimental) Brown Dog</a></li>
<li class="chapter" data-level="8.0.16" data-path="pecanXML.html"><a href="pecanXML.html#xml-benchmarking"><i class="fa fa-check"></i><b>8.0.16</b> (experimental) Benchmarking</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>9</b> PEcAn workflow (web/workflow.R)</a><ul>
<li class="chapter" data-level="9.0.1" data-path="workflow.html"><a href="workflow.html#workflow-readsettings"><i class="fa fa-check"></i><b>9.0.1</b> Read Settings</a></li>
<li class="chapter" data-level="9.0.2" data-path="workflow.html"><a href="workflow.html#workflow-input"><i class="fa fa-check"></i><b>9.0.2</b> Input Conversions</a></li>
<li class="chapter" data-level="9.0.3" data-path="workflow.html"><a href="workflow.html#workflow-input-data"><i class="fa fa-check"></i><b>9.0.3</b> Input Data</a></li>
<li class="chapter" data-level="9.0.4" data-path="workflow.html"><a href="workflow.html#workflow-input-initial"><i class="fa fa-check"></i><b>9.0.4</b> Initial Conditions</a></li>
<li class="chapter" data-level="9.0.5" data-path="workflow.html"><a href="workflow.html#workflow-met"><i class="fa fa-check"></i><b>9.0.5</b> Meteorological Data</a></li>
<li class="chapter" data-level="9.0.6" data-path="workflow.html"><a href="workflow.html#workflow-met-standard"><i class="fa fa-check"></i><b>9.0.6</b> Converting raw data to PEcAn standard</a></li>
<li class="chapter" data-level="9.0.7" data-path="workflow.html"><a href="workflow.html#workflow-met-downscale"><i class="fa fa-check"></i><b>9.0.7</b> Downscaling and gapfilling (optional)</a></li>
<li class="chapter" data-level="9.0.8" data-path="workflow.html"><a href="workflow.html#workflow-met-model"><i class="fa fa-check"></i><b>9.0.8</b> Converting from PEcAn standard to model-specific format</a></li>
<li class="chapter" data-level="9.0.9" data-path="workflow.html"><a href="workflow.html#workflow-traits"><i class="fa fa-check"></i><b>9.0.9</b> Traits</a></li>
<li class="chapter" data-level="9.0.10" data-path="workflow.html"><a href="workflow.html#workflow-metaanalysis"><i class="fa fa-check"></i><b>9.0.10</b> Meta Analysis</a></li>
<li class="chapter" data-level="9.0.11" data-path="workflow.html"><a href="workflow.html#workflow-modelconfig"><i class="fa fa-check"></i><b>9.0.11</b> Model Configuration</a></li>
<li class="chapter" data-level="9.0.12" data-path="workflow.html"><a href="workflow.html#workflow-modelrun"><i class="fa fa-check"></i><b>9.0.12</b> Run Execution</a></li>
<li class="chapter" data-level="9.0.13" data-path="workflow.html"><a href="workflow.html#workflow-postrun"><i class="fa fa-check"></i><b>9.0.13</b> Post Run Analysis</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="pecan-models.html"><a href="pecan-models.html"><i class="fa fa-check"></i><b>10</b> PEcAn Models</a><ul>
<li class="chapter" data-level="10.0.1" data-path="pecan-models.html"><a href="pecan-models.html#models-biocro"><i class="fa fa-check"></i><b>10.0.1</b> BioCro</a></li>
<li class="chapter" data-level="10.0.2" data-path="pecan-models.html"><a href="pecan-models.html#models-clm"><i class="fa fa-check"></i><b>10.0.2</b> CLM</a></li>
<li class="chapter" data-level="10.0.3" data-path="pecan-models.html"><a href="pecan-models.html#models-dalec"><i class="fa fa-check"></i><b>10.0.3</b> DALEC</a></li>
<li class="chapter" data-level="10.0.4" data-path="pecan-models.html"><a href="pecan-models.html#models-ed"><i class="fa fa-check"></i><b>10.0.4</b> ED2</a></li>
<li class="chapter" data-level="10.0.5" data-path="pecan-models.html"><a href="pecan-models.html#installation-notes"><i class="fa fa-check"></i><b>10.0.5</b> Installation notes</a></li>
<li class="chapter" data-level="10.0.6" data-path="pecan-models.html"><a href="pecan-models.html#models-gday"><i class="fa fa-check"></i><b>10.0.6</b> GDAY</a></li>
<li class="chapter" data-level="10.0.7" data-path="pecan-models.html"><a href="pecan-models.html#models-linkages"><i class="fa fa-check"></i><b>10.0.7</b> LINKAGES</a></li>
<li class="chapter" data-level="10.0.8" data-path="pecan-models.html"><a href="pecan-models.html#models-lpjguess"><i class="fa fa-check"></i><b>10.0.8</b> LPJ-GUESS</a></li>
<li class="chapter" data-level="10.0.9" data-path="pecan-models.html"><a href="pecan-models.html#models-maespa"><i class="fa fa-check"></i><b>10.0.9</b> MAESPA</a></li>
<li class="chapter" data-level="10.0.10" data-path="pecan-models.html"><a href="pecan-models.html#models-preles"><i class="fa fa-check"></i><b>10.0.10</b> PRELES</a></li>
<li class="chapter" data-level="10.0.11" data-path="pecan-models.html"><a href="pecan-models.html#models-sipnet"><i class="fa fa-check"></i><b>10.0.11</b> SiPNET</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html"><i class="fa fa-check"></i><b>11</b> Available Meteorological Drivers</a><ul>
<li class="chapter" data-level="11.0.1" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#ameriflux"><i class="fa fa-check"></i><b>11.0.1</b> Ameriflux</a></li>
<li class="chapter" data-level="11.0.2" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#amerifluxlbl"><i class="fa fa-check"></i><b>11.0.2</b> AmerifluxLBL</a></li>
<li class="chapter" data-level="11.0.3" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#fluxnet2015"><i class="fa fa-check"></i><b>11.0.3</b> Fluxnet2015</a></li>
<li class="chapter" data-level="11.0.4" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#narr"><i class="fa fa-check"></i><b>11.0.4</b> NARR</a></li>
<li class="chapter" data-level="11.0.5" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#cruncep"><i class="fa fa-check"></i><b>11.0.5</b> CRUNCEP</a></li>
<li class="chapter" data-level="11.0.6" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#cmip5"><i class="fa fa-check"></i><b>11.0.6</b> CMIP5</a></li>
<li class="chapter" data-level="11.0.7" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#nldas"><i class="fa fa-check"></i><b>11.0.7</b> NLDAS</a></li>
<li class="chapter" data-level="11.0.8" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#gldas"><i class="fa fa-check"></i><b>11.0.8</b> GLDAS</a></li>
<li class="chapter" data-level="11.0.9" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#paleon"><i class="fa fa-check"></i><b>11.0.9</b> PalEON</a></li>
<li class="chapter" data-level="11.0.10" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#fluxnetlathuile"><i class="fa fa-check"></i><b>11.0.10</b> FluxnetLaThuile</a></li>
<li class="chapter" data-level="11.0.11" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#geostreams"><i class="fa fa-check"></i><b>11.0.11</b> Geostreams</a></li>
<li class="chapter" data-level="11.0.12" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#download-gfdl"><i class="fa fa-check"></i><b>11.0.12</b> Download GFDL</a></li>
<li class="chapter" data-level="11.0.13" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#cm3"><i class="fa fa-check"></i><b>11.0.13</b> CM3</a></li>
<li class="chapter" data-level="11.0.14" data-path="available-meteorological-drivers.html"><a href="available-meteorological-drivers.html#esm2m-esm2g"><i class="fa fa-check"></i><b>11.0.14</b> ESM2M &amp; ESM2G</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="pecan-api.html"><a href="pecan-api.html"><i class="fa fa-check"></i><b>12</b> The PEcAn Docker API</a></li>
<li class="chapter" data-level="13" data-path="database-synchronization.html"><a href="database-synchronization.html"><i class="fa fa-check"></i><b>13</b> Database synchronization</a><ul>
<li class="chapter" data-level="13.0.1" data-path="database-synchronization.html"><a href="database-synchronization.html#how-does-it-work"><i class="fa fa-check"></i><b>13.0.1</b> How does it work?</a></li>
<li class="chapter" data-level="13.0.2" data-path="database-synchronization.html"><a href="database-synchronization.html#set-up"><i class="fa fa-check"></i><b>13.0.2</b> Set up</a></li>
<li class="chapter" data-level="13.0.3" data-path="database-synchronization.html"><a href="database-synchronization.html#fetch-latest-data"><i class="fa fa-check"></i><b>13.0.3</b> Fetch latest data</a></li>
<li class="chapter" data-level="13.0.4" data-path="database-synchronization.html"><a href="database-synchronization.html#sharing-data"><i class="fa fa-check"></i><b>13.0.4</b> Sharing data</a></li>
<li class="chapter" data-level="13.0.5" data-path="database-synchronization.html"><a href="database-synchronization.html#automation"><i class="fa fa-check"></i><b>13.0.5</b> Automation</a></li>
<li class="chapter" data-level="13.0.6" data-path="database-synchronization.html"><a href="database-synchronization.html#database-maintentance"><i class="fa fa-check"></i><b>13.0.6</b> Database maintentance</a></li>
<li class="chapter" data-level="13.0.7" data-path="database-synchronization.html"><a href="database-synchronization.html#troubleshooting-3"><i class="fa fa-check"></i><b>13.0.7</b> Troubleshooting</a></li>
<li class="chapter" data-level="13.0.8" data-path="database-synchronization.html"><a href="database-synchronization.html#network-status-map"><i class="fa fa-check"></i><b>13.0.8</b> Network Status Map</a></li>
<li class="chapter" data-level="13.0.9" data-path="database-synchronization.html"><a href="database-synchronization.html#tasks"><i class="fa fa-check"></i><b>13.0.9</b> Tasks</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="standalone-tools-modules.html"><a href="standalone-tools-modules.html"><i class="fa fa-check"></i><b>14</b> Standalone tools (modules)</a><ul>
<li class="chapter" data-level="14.0.1" data-path="standalone-tools-modules.html"><a href="standalone-tools-modules.html#LoadData"><i class="fa fa-check"></i><b>14.0.1</b> Loading Data in PEcAn</a></li>
<li class="chapter" data-level="14.0.2" data-path="standalone-tools-modules.html"><a href="standalone-tools-modules.html#function-load_data"><i class="fa fa-check"></i><b>14.0.2</b> Function <code>load_data</code></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>15</b> SHINY</a><ul>
<li class="chapter" data-level="15.0.1" data-path="shiny.html"><a href="shiny.html#debugging-shiny-apps"><i class="fa fa-check"></i><b>15.0.1</b> Debugging Shiny Apps</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>16</b> Debugging</a><ul>
<li class="chapter" data-level="16.0.1" data-path="debugging.html"><a href="debugging.html#using-testsworkflow.r"><i class="fa fa-check"></i><b>16.0.1</b> Using <code>tests/workflow.R</code></a></li>
<li class="chapter" data-level="16.0.2" data-path="debugging.html"><a href="debugging.html#useful-scripts"><i class="fa fa-check"></i><b>16.0.2</b> Useful scripts</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="troubleshooting-pecan.html"><a href="troubleshooting-pecan.html"><i class="fa fa-check"></i><b>17</b> Troubleshooting PEcAn</a><ul>
<li class="chapter" data-level="17.0.1" data-path="troubleshooting-pecan.html"><a href="troubleshooting-pecan.html#cookies-and-pecan-web-pages"><i class="fa fa-check"></i><b>17.0.1</b> Cookies and pecan web pages</a></li>
<li class="chapter" data-level="17.0.2" data-path="troubleshooting-pecan.html"><a href="troubleshooting-pecan.html#warning-mkdir-function.mkdir-no-such-file-or-directory"><i class="fa fa-check"></i><b>17.0.2</b> <code>Warning: mkdir() [function.mkdir]: No such file or directory</code></a></li>
<li class="chapter" data-level="17.0.3" data-path="troubleshooting-pecan.html"><a href="troubleshooting-pecan.html#after-creating-a-new-pft-the-tag-for-pft-not-passed-to-config.xml-in-ed"><i class="fa fa-check"></i><b>17.0.3</b> After creating a new PFT the <num> tag for PFT not passed to config.xml in ED</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="rabbitmq.html"><a href="rabbitmq.html"><i class="fa fa-check"></i><b>18</b> RabbitMQ</a><ul>
<li class="chapter" data-level="18.0.1" data-path="rabbitmq.html"><a href="rabbitmq.html#rabbitmq-basics-sender"><i class="fa fa-check"></i><b>18.0.1</b> Producer – <code>sender.py</code></a></li>
<li class="chapter" data-level="18.0.2" data-path="rabbitmq.html"><a href="rabbitmq.html#rabbitmq-basics-receiver"><i class="fa fa-check"></i><b>18.0.2</b> Consumer – <code>receiver.py</code></a></li>
<li class="chapter" data-level="18.0.3" data-path="rabbitmq.html"><a href="rabbitmq.html#rabbitmq-web"><i class="fa fa-check"></i><b>18.0.3</b> RabbitMQ and the PEcAn web interface</a></li>
<li class="chapter" data-level="18.0.4" data-path="rabbitmq.html"><a href="rabbitmq.html#rabbitmq-xml"><i class="fa fa-check"></i><b>18.0.4</b> RabbitMQ in the PEcAn XML</a></li>
<li class="chapter" data-level="18.0.5" data-path="rabbitmq.html"><a href="rabbitmq.html#rabbitmq-dockerfile"><i class="fa fa-check"></i><b>18.0.5</b> RabbitMQ configuration in Dockerfiles</a></li>
<li class="chapter" data-level="18.0.6" data-path="rabbitmq.html"><a href="rabbitmq.html#rabbitmq-case-study"><i class="fa fa-check"></i><b>18.0.6</b> Case study: PEcAn web interface</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="database.html"><a href="database.html"><i class="fa fa-check"></i><b>19</b> BETY Database Administration</a><ul>
<li class="chapter" data-level="19.0.1" data-path="database.html"><a href="database.html#database-setup"><i class="fa fa-check"></i><b>19.0.1</b> Best practices</a></li>
<li class="chapter" data-level="19.0.2" data-path="database.html"><a href="database.html#backup-of-bety-database"><i class="fa fa-check"></i><b>19.0.2</b> Backup of BETY database</a></li>
<li class="chapter" data-level="19.0.3" data-path="database.html"><a href="database.html#restore-of-bety-database"><i class="fa fa-check"></i><b>19.0.3</b> Restore of BETY database</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="workflow-modules.html"><a href="workflow-modules.html"><i class="fa fa-check"></i><b>20</b> Workflow modules</a><ul>
<li class="chapter" data-level="20.0.1" data-path="workflow-modules.html"><a href="workflow-modules.html#overview"><i class="fa fa-check"></i><b>20.0.1</b> Overview</a></li>
<li class="chapter" data-level="20.0.2" data-path="workflow-modules.html"><a href="workflow-modules.html#load-settings"><i class="fa fa-check"></i><b>20.0.2</b> Load Settings:</a></li>
<li class="chapter" data-level="20.0.3" data-path="workflow-modules.html"><a href="workflow-modules.html#query-database"><i class="fa fa-check"></i><b>20.0.3</b> Query Database:</a></li>
<li class="chapter" data-level="20.0.4" data-path="workflow-modules.html"><a href="workflow-modules.html#meta-analysis"><i class="fa fa-check"></i><b>20.0.4</b> Meta Analysis:</a></li>
<li class="chapter" data-level="20.0.5" data-path="workflow-modules.html"><a href="workflow-modules.html#write-configuration-files"><i class="fa fa-check"></i><b>20.0.5</b> Write Configuration Files</a></li>
<li class="chapter" data-level="20.0.6" data-path="workflow-modules.html"><a href="workflow-modules.html#start-runs"><i class="fa fa-check"></i><b>20.0.6</b> Start Runs:</a></li>
<li class="chapter" data-level="20.0.7" data-path="workflow-modules.html"><a href="workflow-modules.html#get-model-output"><i class="fa fa-check"></i><b>20.0.7</b> Get Model Output</a></li>
<li class="chapter" data-level="20.0.8" data-path="workflow-modules.html"><a href="workflow-modules.html#ensemble-analysis"><i class="fa fa-check"></i><b>20.0.8</b> Ensemble Analysis</a></li>
<li class="chapter" data-level="20.0.9" data-path="workflow-modules.html"><a href="workflow-modules.html#sensitivity-analysis-variance-decomposition"><i class="fa fa-check"></i><b>20.0.9</b> Sensitivity Analysis, Variance Decomposition</a></li>
<li class="chapter" data-level="20.0.10" data-path="workflow-modules.html"><a href="workflow-modules.html#glossary"><i class="fa fa-check"></i><b>20.0.10</b> Glossary</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="data-assimilation-with-dart.html"><a href="data-assimilation-with-dart.html"><i class="fa fa-check"></i><b>21</b> Data assimilation with DART</a><ul>
<li class="chapter" data-level="21.1" data-path="data-assimilation-with-dart.html"><a href="data-assimilation-with-dart.html#using-the-pecan-download.file-function"><i class="fa fa-check"></i><b>21.1</b> Using the PEcAn download.file() function</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="pecan-project-use-to-teach-ecological-model-data-synthesis.html"><a href="pecan-project-use-to-teach-ecological-model-data-synthesis.html"><i class="fa fa-check"></i><b>22</b> PEcAn Project use to teach Ecological model-data synthesis</a><ul>
<li class="chapter" data-level="22.0.1" data-path="pecan-project-use-to-teach-ecological-model-data-synthesis.html"><a href="pecan-project-use-to-teach-ecological-model-data-synthesis.html#university-classes"><i class="fa fa-check"></i><b>22.0.1</b> University classes</a></li>
<li class="chapter" data-level="22.0.2" data-path="pecan-project-use-to-teach-ecological-model-data-synthesis.html"><a href="pecan-project-use-to-teach-ecological-model-data-synthesis.html#summer-courses-workshops"><i class="fa fa-check"></i><b>22.0.2</b> Summer Courses / Workshops</a></li>
<li class="chapter" data-level="22.0.3" data-path="pecan-project-use-to-teach-ecological-model-data-synthesis.html"><a href="pecan-project-use-to-teach-ecological-model-data-synthesis.html#selected-publications"><i class="fa fa-check"></i><b>22.0.3</b> Selected Publications</a></li>
</ul></li>
<li class="part"><span><b>IV Appendix</b></span><ul>
<li class="chapter" data-level="22.1" data-path="02_demos_tutorials_workflows/03_developer_workflows/00_developer_guide.html"><a href="#todo"><i class="fa fa-check"></i><b>22.1</b> TODO:</a></li>
<li class="chapter" data-level="22.2" data-path="pecan-project-use-to-teach-ecological-model-data-synthesis.html"><a href="pecan-project-use-to-teach-ecological-model-data-synthesis.html#faq"><i class="fa fa-check"></i><b>22.2</b> FAQ</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Predictive Ecosystem Analyzer</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="developer-guide" class="section level1">
<h1><span class="header-section-number">6</span> Developer guide</h1>
<p><span id="updatebety">Update BETY</span>
<span id="pecan-make">Update PEcAn Code</span>
<span id="pecan-git">PEcAn and Git</span>
<span id="coding-practices">Coding Practices</span></p>

<div id="updatebety" class="section level2">
<h2><span class="header-section-number">6.1</span> Updating PEcAn Code and Bety Database</h2>
<p>Release notes for all releases can be found <a href="https://github.com/PecanProject/pecan/releases">here</a>.</p>
<p>This page will only list any steps you have to do to upgrade an existing system. When updating PEcAn it is highly encouraged to update BETY. You can find instructions on how to do this, as well on how to update the database in the <a href="https://pecan.gitbooks.io/betydb-documentation/content/updating_betydb_when_new_versions_are_released.html">Updating BETYdb</a> gitbook page.</p>
<div id="pecan-make" class="section level4">
<h4><span class="header-section-number">6.1.0.1</span> Updating PEcAn</h4>
<p>The latest version of PEcAn code can be obtained from the PEcAn repository on GitHub:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="bu">cd</span> pecan        # If you are not already in the PEcAn directory
<span class="fu">git</span> pull</code></pre>
<p>The PEcAn build system is based on GNU Make.
The simplest way to install is to run <code>make</code> from inside the PEcAn directory.
This will update the documentation for all packages and install them, as well as all required dependencies.</p>
<p>For more control, the following <code>make</code> commands are available:</p>
<ul>
<li><p><code>make document</code> – Use <code>devtools::document</code> to update the documentation for all package.
Under the hood, this uses the <code>roxygen2</code> documentation system.</p></li>
<li><p><code>make install</code> – Install all packages and their dependnencies using <code>devtools::install</code>.
By default, this only installs packages that have had their code changed and any dependent packages.</p></li>
<li><p><code>make check</code> – Perform a rigorous check of packages using <code>devtools::check</code></p></li>
<li><p><code>make test</code> – Run all unit tests (based on <code>testthat</code> package) for all packages, using <code>devtools::test</code></p></li>
<li><p><code>make clean</code> – Remove the make build cache, which is used to track which packages have changed.
Cache files are stored in the <code>.doc</code>, <code>.install</code>, <code>.check</code>, and <code>.test</code> subdirectories in the PEcAn main directory.
Running <code>make clean</code> will force the next invocation of <code>make</code> commands to operate on all PEcAn packages, regardless of changes.</p></li>
</ul>
<p>The following are some additional <code>make</code> tricks that may be useful:</p>
<ul>
<li><p>Install, check, document, or test a specific package – <code>make .&lt;cmd&gt;/&lt;pkg-dir&gt;</code>; e.g. <code>make .install/utils</code> or <code>make .check/modules/rtm</code></p></li>
<li><p>Force <code>make</code> to run, even if package has not changed – <code>make -B &lt;command&gt;</code></p></li>
<li><p>Run <code>make</code> commands in parallel – <code>make -j&lt;ncores&gt;</code>; e.g. <code>make -j4 install</code> to install packages using four parallel processes.</p></li>
</ul>
<p>All instructions for the <code>make</code> build system are contained in the <code>Makefile</code> in the PEcAn root directory.
For full documentation on <code>make</code>, see the man pages by running <code>man make</code> from a terminal.</p>
<p><em>Point of contact:
Alexey Shiklomanov
GitHub/Gitter: <span class="citation">@ashiklom</span>
email: <a href="mailto:ashiklom@bu.edu">ashiklom@bu.edu</a></em></p>

</div>
</div>
<div id="pecan-git" class="section level2">
<h2><span class="header-section-number">6.2</span> Git and GitHub Workflow</h2>
<p><span id="using-git">Using Git</span></p>

<div id="using-git" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Using Git</h3>
<p>This document describes the steps required to download PEcAn, make changes to code, and submit your changes.</p>
<ul>
<li>If you are new to GitHub or to PEcAn, start with the one-time set-up instructions under <a href="developer-guide.html#before-any-work-is-done">Before any work is done</a>. Also see the excellent tutorials and references in the <a href="developer-guide.html#git">Git</a>) section right below this list and at the bootom in <a href="developer-guide.html#references">References</a>.</li>
<li>To make trivial changes, see <a href="developer-guide.html#quick-and-easy">Quick and Easy</a>.</li>
<li>To make a few changes to the code, start with the <a href="developer-guide.html#basic-workflow">Basic Workflow</a>.</li>
<li>To make substantial changes and/or if plan to contribute over time see <a href="developer-guide.html#recommended-workflow-a-new-branch-for-each-change">Recommended Workflow: A new branch for each change</a>.</li>
</ul>
<div id="git" class="section level4">
<h4><span class="header-section-number">6.2.1.1</span> Git</h4>
<p>Git is a free &amp; open source, distributed version control system designed
to handle everything from small to very large projects with speed and
efficiency. Every Git clone is a full-fledged repository with complete
history and full revision tracking capabilities, not dependent on
network access or a central server. Branching and merging are fast and
easy to do.</p>
<p>A good place to start is the <a href="https://guides.github.com/introduction/flow/">GitHub 5 minute illustrated tutorial</a>.
In addition, there are three fun tutorials for learning git:</p>
<ul>
<li><a href="https://www.codecademy.com/learn/learn-git">Learn Git</a> is a great web-based interactive tutorial.</li>
<li><a href="https://learngitbranching.js.org/">LearnGitBranching</a></li>
<li><a href="http://try.github.com">TryGit</a>.</li>
</ul>
<p><strong>URLs</strong> In the rest of the document will use specific URL’s to clone the code.
There a few URL’s you can use to clone a project, using https, ssh and
git. You can use either https or git to clone a repository and write to
it. The git protocol is read-only.
This document describes the steps required to download PEcAn, make changes to code, and submit your changes.</p>
</div>
<div id="pecan-project-and-github" class="section level4">
<h4><span class="header-section-number">6.2.1.2</span> PEcAn Project and Github</h4>
<ul>
<li>Organization Repository: <a href="https://github.com/organizations/PecanProject" class="uri">https://github.com/organizations/PecanProject</a></li>
<li>PEcAn source code: <a href="https://github.com/PecanProject/pecan.git" class="uri">https://github.com/PecanProject/pecan.git</a></li>
<li>BETYdb source code: <a href="https://github.com/PecanProject/bety.git" class="uri">https://github.com/PecanProject/bety.git</a></li>
</ul>
<p>These instructions apply to other repositories too.</p>
</div>
<div id="pecan-project-branches" class="section level4">
<h4><span class="header-section-number">6.2.1.3</span> PEcAn Project Branches</h4>
<p>We follow branch organization laid out on <a href="http://nvie.com/posts/a-successful-git-branching-model">this page</a>.</p>
<p>In short, there are three main branches you must be aware of:</p>
<ul>
<li><strong>develop</strong> - Main Branch containing the latest code. This is the main branch you will make changes to.</li>
<li><strong>master</strong> - Branch containing the latest stable code. DO NOT MAKE CHANGES TO THIS BRANCH.</li>
<li><strong>release/vX.X.X</strong> - Named branches containing code specific to a release. Only make changes to this branch if you are fixing a bug on a release branch.</li>
</ul>
</div>
<div id="milestones-issues-tasks" class="section level4">
<h4><span class="header-section-number">6.2.1.4</span> Milestones, Issues, Tasks</h4>
<p>The Milestones, issues, and tasks can be used to organize specific features or research projects. In general, there is a heirarchy:</p>
<ul>
<li>milestones (Big picture, “Epic”): contains many issues, organized by release.</li>
<li>issues (Specific features / bugs, “Story”): may contain a list of tasks; represent</li>
<li>task list (to do list, “Tasks”): list of steps required to close an issue, e.g.:</li>
</ul>
<table>
<tbody>
<tr class="odd">
<td align="left">* [ ] first do this</td>
</tr>
<tr class="even">
<td align="left">* [ ] then this</td>
</tr>
<tr class="odd">
<td align="left">* [ ] completed when x and y</td>
</tr>
</tbody>
</table>
</div>
<div id="quick-and-easy" class="section level4">
<h4><span class="header-section-number">6.2.1.5</span> Quick and Easy</h4>
<p>The <strong>easiest</strong> approach is to use GitHub’s browser based workflow. This is useful when your change is a few lines, if you are editing a wiki, or if the edit is trivial (and won’t break the code). The <a href="https://help.github.com/articles/github-flow-in-the-browser">GitHub documentation is here</a> but it is simple: finding the page or file you want to edit, click “edit” and then the GitHub web application will automatically forking and branch, then allow you to submit a pull request. However, it should be noted that unless you are a member of the PEcAn project that the “edit” button will not be active and you’ll want to follow the workflow described below for forking and then submitting a pull request.</p>
</div>
<div id="recommended-git-workflow" class="section level4">
<h4><span class="header-section-number">6.2.1.6</span> Recommended Git Workflow</h4>
<p><strong>Each feature should be in its own branch</strong> (for example each issue is a branch, names of branches are often the issue in a bug tracking system).</p>
<p><strong>Commit and Push Frequency</strong> On your branch, commit <strong><em>at minimum once a day before you push changes:</em></strong> even better: every time you reach a stopping point and move to a new issue. best: any time that you have done work that you do not want to re-do. Remember, pushing changes to your branch is like saving a draft. Submit a pull request when you are done.</p>
</div>
<div id="before-any-work-is-done" class="section level4">
<h4><span class="header-section-number">6.2.1.7</span> Before any work is done</h4>
<p>The first step below only needs to be done once when you first start working on the PEcAn code. The steps below that need to be done to set up PEcAn on your computer, and would need to be repeated if you move to a new computer. If you are working from the PEcAn VM, you can skip the “git clone” since the PEcAn code is already installed.</p>
<p>Most people will not be able to work in the PEcAn repository directly and will need to create a fork of the PEcAn source code in their own folder. To fork PEcAn into your own github space (<a href="https://help.github.com/articles/fork-a-repo">github help: “fork a repo”</a>). This forked repository will allow you to create branches and commit changes back to GitHub and create pull requests to the develop branch of PEcAn.</p>
<p>The forked repository is the only way for external people to commit code back to PEcAn and BETY. The pull request will start a review process that will eventually result in the code being merged into the main copy of the codebase. See <a href="https://help.github.com/articles/fork-a-repo" class="uri">https://help.github.com/articles/fork-a-repo</a> for more information, especially on how to keep your fork up to date with respect to the original. (Rstudio users should also see <a href="Using-Git.md#git--rstudio">Git + Rstudio</a>, below)</p>
<p>You can setup SSH keys to make it easier to commit cod back to GitHub. This might especially be true if you are working from a cluster, see <a href="https://help.github.com/articles/generating-ssh-keys">set up ssh keys</a></p>
<ol style="list-style-type: decimal">
<li>Introduce yourself to GIT</li>
</ol>
<p><code>git config --global user.name &quot;FULLNAME&quot;</code>
<code>git config --global user.email you@yourdomain.example.com</code></p>
<ol start="2" style="list-style-type: decimal">
<li><p>Fork PEcAn on GitHub. Go to the PEcAn source code and click on the Fork button in the upper right. This will create a copy of PEcAn in your personal space.</p></li>
<li><p>Clone to your local machine via command line</p></li>
</ol>
<p><code>git clone git@github.com:&lt;username&gt;/pecan.git</code></p>
<p>If this does not work, try the https method</p>
<p><code>git clone https://github.com/PecanProject/pecan.git</code></p>
<ol start="4" style="list-style-type: decimal">
<li>Define upstream repository</li>
</ol>
<pre><code>cd pecan
git remote add upstream git@github.com:PecanProject/pecan.git</code></pre>
</div>
<div id="during-development" class="section level4">
<h4><span class="header-section-number">6.2.1.8</span> During development:</h4>
<ul>
<li>commit often;</li>
<li>each commit can address 0 or 1 issue; many commits can reference an issue</li>
<li>ensure that all tests are passing before anything is pushed into develop.</li>
</ul>
</div>
<div id="basic-workflow" class="section level4">
<h4><span class="header-section-number">6.2.1.9</span> Basic Workflow</h4>
<p>This workflow is for educational purposes only. Please use the Recommended Workflow if you plan on contributing to PEcAn. This workflow does not include creating branches, a feature we would like you to use.
1. Get the latest code from the main repository</p>
<p><code>git pull upstream develop</code></p>
<ol start="2" style="list-style-type: decimal">
<li><p>Do some coding</p></li>
<li><p>Commit after each chunk of code (multiple times a day)</p></li>
</ol>
<p><code>git commit -m &quot;&lt;some descriptive information about what was done; references/fixes gh-X&gt;&quot;</code></p>
<ol start="4" style="list-style-type: decimal">
<li>Push to YOUR Github (when a feature is working, a set of bugs are fixed, or you need to share progress with others)</li>
</ol>
<p><code>git push origin develop</code></p>
<ol start="5" style="list-style-type: decimal">
<li>Before submitting code back to the main repository, make sure that code compiles from the main directory.</li>
</ol>
<p><code>make</code></p>
<ol start="6" style="list-style-type: decimal">
<li>submit pull request with a reference to related issue;</li>
</ol>
<ul>
<li>also see <a href="https://help.github.com/articles/using-pull-requests">github documentation</a></li>
</ul>
</div>
<div id="recommended-workflow-a-new-branch-for-each-change" class="section level4">
<h4><span class="header-section-number">6.2.1.10</span> Recommended Workflow: A new branch for each change</h4>
<ol style="list-style-type: decimal">
<li>Make sure you start in develop</li>
</ol>
<p><code>git checkout develop</code></p>
<ol start="2" style="list-style-type: decimal">
<li>Make sure develop is up to date</li>
</ol>
<p><code>git pull upstream develop</code></p>
<ol start="3" style="list-style-type: decimal">
<li>Run the PEcAn MAKEFILE to compile code from the main directory.</li>
</ol>
<p><code>make</code></p>
<ol start="4" style="list-style-type: decimal">
<li>Create a branch and switch to it</li>
</ol>
<p><code>git checkout -b &lt;branchname&gt;</code></p>
<ol start="5" style="list-style-type: decimal">
<li>Work/commit/etc</li>
</ol>
<p><code>git add &lt;file_that_was_changed.R&gt;</code></p>
<p><code>git commit -m &quot;&lt;some descriptive information about what was done&gt;&quot;</code></p>
<ol start="6" style="list-style-type: decimal">
<li>Make sure that code compiles and documentation updated. The make document command will run roxygenise.</li>
</ol>
<p><code>make document</code>
<code>make</code></p>
<ol start="7" style="list-style-type: decimal">
<li>Push this branch to your github space</li>
</ol>
<p><code>git push origin &lt;branchname&gt;</code></p>
<ol start="8" style="list-style-type: decimal">
<li>submit pull request with [[link commits to issues|Using-Git#link-commits-to-issuess]];</li>
</ol>
<ul>
<li>also see <a href="https://github.com/PecanProject/bety/issues/57">explanation in this PecanProject/bety issue</a> and <a href="https://help.github.com/articles/using-pull-requests">github documentation</a></li>
</ul>
</div>
<div id="after-pull-request-is-merged" class="section level4">
<h4><span class="header-section-number">6.2.1.11</span> After pull request is merged</h4>
<ol style="list-style-type: decimal">
<li>Make sure you start in master</li>
</ol>
<p><code>git checkout develop</code></p>
<ol start="2" style="list-style-type: decimal">
<li>delete branch remotely</li>
</ol>
<p><code>git push origin --delete &lt;branchname&gt;</code></p>
<ol start="3" style="list-style-type: decimal">
<li>delete branch locally</li>
</ol>
<p><code>git branch -D &lt;branchname&gt;</code></p>
</div>
<div id="fixing-a-release-branch" class="section level4">
<h4><span class="header-section-number">6.2.1.12</span> Fixing a release Branch</h4>
<p>If you would like to make changes to a release branch, you must follow a different workflow, as the release branch will not contain the latest code on develop and must remain seperate.</p>
<ol style="list-style-type: decimal">
<li>Fetch upstream remote branches</li>
</ol>
<p><code>git fetch upstream</code></p>
<ol start="2" style="list-style-type: decimal">
<li>Checkout the correct release branch</li>
</ol>
<p><code>git checkout -b release/vX.Y.Z</code></p>
<ol start="4" style="list-style-type: decimal">
<li>Compile Code with make</li>
</ol>
<p><code>make</code></p>
<ol start="5" style="list-style-type: decimal">
<li>Make changes and commit them</li>
</ol>
<p><code>git add &lt;changed_file.R&gt;</code>
<code>git commit -m &quot;Describe changes&quot;</code></p>
<ol start="6" style="list-style-type: decimal">
<li><p>Compile and make roxygen changes
<code>make</code>
<code>make document</code></p></li>
<li><p>Commit and push any files that were changed by make document</p></li>
<li><p>Make a pull request. It is essential that you compare your pull request to the remote release branch, NOT the develop branch.</p></li>
</ol>
</div>
<div id="link-commits-to-issues" class="section level4">
<h4><span class="header-section-number">6.2.1.13</span> Link commits to issues</h4>
<p>You can reference and close issues from comments, pull requests, and commit messages. This should be done when you commit code that is related to or will close/fix an existing issue.</p>
<p>There are two ways to do this. One easy way is to include the following text in your commit message:</p>
<ul>
<li><a href="https://github.com/blog/1386-closing-issues-via-commit-messages"><strong>Github</strong></a></li>
<li>to close: “closes gh-xxx” (or syn. close, closed, fixes, fix, fixed)<br />
</li>
<li>to reference: just the issue number (e.g. “gh-xxx”)</li>
</ul>
</div>
<div id="other-useful-git-commands" class="section level4">
<h4><span class="header-section-number">6.2.1.14</span> Other Useful Git Commands:</h4>
<ul>
<li>GIT encourages branching “early and often”</li>
<li>First pull from develop</li>
<li>Branch before working on feature</li>
<li>One branch per feature</li>
<li>You can switch easily between branches</li>
<li>Merge feature into main line when branch done</li>
</ul>
<p>If during above process you want to work on something else, commit all
your code, create a new branch, and work on new branch.</p>
<ul>
<li>Delete a branch: <code>git branch -d &lt;name of branch&gt;</code></li>
<li>To push a branch git: <code>push -u origin</code><name of branch>`</li>
<li>To check out a branch:</li>
</ul>
<pre><code>git fetch origin
git checkout --track origin/&lt;name of branch&gt;</code></pre>
<ul>
<li>Show graph of commits:</li>
</ul>
<p><code>git log --graph --oneline --all</code></p>
</div>
<div id="tags" class="section level4">
<h4><span class="header-section-number">6.2.1.15</span> Tags</h4>
<p>Git supports two types of tags: lightweight and annotated. For more information see the <a href="http://git-scm.com/book/ch2-6.html">Tagging Chapter in the Git documentation</a>.</p>
<p>Lightweight tags are useful, but here we discuss the annotated tags that are used for marking stable versions, major releases, and versions associated with published results.</p>
<p>The basic command is <code>git tag</code>. The <code>-a</code> flag means ‘annotated’ and <code>-m</code> is used before a message. Here is an example:</p>
<p><code>git tag -a v0.6 -m &quot;stable version with foo and bar features, used in the foobar publication by Bob&quot;</code></p>
<p>Adding a tag to the a remote repository must be done explicitly with a push, e.g.</p>
<p><code>git push v0.6</code></p>
<p>To use a tagged version, just checkout:</p>
<p><code>git checkout v0.6</code></p>
<p>To tag an earlier commit, just append the commit SHA to the command, e.g.</p>
<p><code>git tag -a v0.99 -m &quot;last version before 1.0&quot; 9fceb02</code></p>
<p><strong>Using GitHub</strong> The easiest way to get working with GitHub is by installing the GitHub
client. For instructions for your specific OS and download of the
GitHub client, see <a href="https://help.github.com/articles/set-up-git" class="uri">https://help.github.com/articles/set-up-git</a>.
This will help you set up an SSH key to push code back to GitHub. To
check out a project you do not need to have an ssh key and you can use
the https or git url to check out the code.</p>
</div>
<div id="git-rstudio" class="section level4">
<h4><span class="header-section-number">6.2.1.16</span> Git + Rstudio</h4>
<p>Rstudio is nicely integrated with many development tools, including git and GitHub.
It is quite easy to check out source code from within the Rstudio program or browser.
The Rstudio documentation includes useful overviews of <a href="http://www.rstudio.com/ide/docs/version_control/overview">version control</a> and <a href="http://www.rstudio.com/ide/docs/packages/overview">R package development</a>.</p>
<p>Once you have git installed on your computer (see the <a href="http://www.rstudio.com/ide/docs/version_control/overview">Rstudio version control</a> documentation for instructions), you can use the following steps to install the PEcAn source code in Rstudio.</p>
</div>
<div id="creating-a-read-only-version" class="section level4">
<h4><span class="header-section-number">6.2.1.17</span> Creating a Read-only version:</h4>
<p>This is a fast way to clone the repository that does not support contributing new changes (this can be done with further modification).</p>
<ol style="list-style-type: decimal">
<li>install Rstudio (www.rstudio.com)</li>
<li>click (upper right) project</li>
</ol>
<ul>
<li>create project</li>
<li>version control</li>
<li>Git - clone a project from a Git Repository</li>
<li>paste <a href="https://www.github.com/PecanProject/pecan" class="uri">https://www.github.com/PecanProject/pecan</a></li>
<li>choose working dir. for repo</li>
</ul>
</div>
<div id="for-development" class="section level4">
<h4><span class="header-section-number">6.2.1.18</span> For development:</h4>
<ol style="list-style-type: decimal">
<li>create account on github</li>
<li>create a fork of the PEcAn repository to your own account <a href="https://www.github.com/pecanproject/pecan" class="uri">https://www.github.com/pecanproject/pecan</a></li>
<li>install Rstudio (www.rstudio.com)</li>
<li>generate an ssh key</li>
</ol>
<ul>
<li>in Rstudio:
<ul>
<li><code>Tools -&gt; Options -&gt; Git/SVN -&gt; &quot;create RSA key&quot;</code></li>
</ul></li>
<li><code>View public key -&gt; ctrl+C to copy</code></li>
<li>in GitHub</li>
<li>go to <a href="https://github.com/settings/ssh">ssh settings</a></li>
<li><code>-&gt; 'add ssh key' -&gt; ctrl+V to paste -&gt; 'add key'</code></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Create project in Rstudio</li>
</ol>
<ul>
<li><code>project (upper right) -&gt; create project -&gt; version control -&gt; Git - clone a project from a Git Repository</code></li>
<li>paste repository url <code>git@github.com:&lt;username&gt;/pecan.git&gt;</code></li>
<li>choose working dir. for repository</li>
</ul>
</div>
<div id="references" class="section level4">
<h4><span class="header-section-number">6.2.1.19</span> References</h4>
</div>
<div id="git-documentation" class="section level4">
<h4><span class="header-section-number">6.2.1.20</span> Git Documentation</h4>
<ul>
<li>Scott Chacon, ‘Pro Git book’,
<a href="http://git-scm.com/book" class="uri">http://git-scm.com/book</a></li>
<li>GitHub help pages,
<a href="https://help.github.com" class="uri">https://help.github.com</a>/</li>
<li>Main GIT page
<a href="http://git-scm.com/documentation" class="uri">http://git-scm.com/documentation</a></li>
<li>Another set of pages about branching,
<a href="http://sandofsky.com/blog/git-workflow.html" class="uri">http://sandofsky.com/blog/git-workflow.html</a></li>
<li><a href="http://stackoverflow.com/questions/tagged/git?sort=votes&amp;pagesize=50">Stackoverflow highest voted questions tagged “git”</a></li>
</ul>
</div>
<div id="github-documentation" class="section level4">
<h4><span class="header-section-number">6.2.1.21</span> GitHub Documentation</h4>
<p>When in doubt, the first step is to click the “Help” button at the top of the page.</p>
<ul>
<li><a href="http://scottchacon.com/2011/08/31/github-flow.html">GitHub Flow</a> by
Scott Chacon (Git evangelist and Ruby developer working on GitHub.com)</li>
<li><a href="https://help.github.com/">GitHub FAQ</a></li>
<li><a href="https://help.github.com/articles/using-pull-requests">Using Pull Requests</a></li>
<li><a href="https://help.github.com/articles/generating-ssh-keys">SSH Keys</a></li>
</ul>

</div>
</div>
<div id="github-use-with-pecan" class="section level3">
<h3><span class="header-section-number">6.2.2</span> GitHub use with PEcAn</h3>
<p>In this section, development topics are introduced and discussed. PEcAn code lives within the If you are looking for an issue to work on, take a look through issues labled <a href="https://github.com/PecanProject/pecan/issues?q=is%3Aopen+is%3Aissue+label%3A%22good+first+issue%22">“good first issue”</a>. To get started you will want to review</p>
<p>We use GitHub to track development.</p>
<p>To learn about GitHub, it is worth taking some time to read through the <a href="https://help.github.com/">FAQ</a>. When in doubt, the first step is to click the “Help” button at the top of the page.</p>
<ul>
<li><strong>To address specific people</strong>, use a github feature called <span class="citation">@mentions</span> e.g. write <span class="citation">@dlebauer</span>, <span class="citation">@robkooper</span>, <span class="citation">@mdietze</span>, or <span class="citation">@serbinsh</span> … in the issue to alert the user as described in the <a href="https://help.github.com/articles/notifications">GitHub documentation on notifications</a></li>
</ul>
<div id="bugs-issues-features-etc." class="section level4">
<h4><span class="header-section-number">6.2.2.1</span> Bugs, Issues, Features, etc.</h4>
</div>
<div id="reporting-a-bug" class="section level4">
<h4><span class="header-section-number">6.2.2.2</span> Reporting a bug</h4>
<ol style="list-style-type: decimal">
<li>(For developers) work through debugging.</li>
<li>Once you have identified a problem, that you can not resolve, you can write a bug report</li>
<li>Write a bug report</li>
<li>submit the bug report</li>
<li>If you do find the answer, explain the resolution (in the issue) and close the issue</li>
</ol>
</div>
<div id="required-content" class="section level4">
<h4><span class="header-section-number">6.2.2.3</span> Required content</h4>
<p>Note:</p>
<ul>
<li><strong>a bug is only a bug if it is reproducible</strong></li>
<li><strong>clear bug reports save time</strong></li>
</ul>
<ol style="list-style-type: decimal">
<li>Clear, specific title</li>
<li>Description -</li>
</ol>
<ul>
<li>What you did</li>
<li>What you expected to happen</li>
<li>What actually happened</li>
<li>What does work, under what conditions does it fail?</li>
<li>Reproduction steps - minimum steps required to reproduce the bug</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>additional materials that could help identify the cause:</li>
</ol>
<ul>
<li>screen shots</li>
<li>stack traces, logs, scripts, output</li>
<li>specific code and data / settings / configuration files required to reproduce the bug</li>
<li>environment (operating system, browser, hardware)</li>
</ul>
</div>
<div id="requesting-a-feature" class="section level4">
<h4><span class="header-section-number">6.2.2.4</span> Requesting a feature</h4>
<p>(from The Pragmatic Programmer, available as
<a href="http://proquestcombo.safaribooksonline.com/0-201-61622-X/223">ebook</a>
through UI libraries, hardcopy on David’s bookshelf)<br />
</p>
<ul>
<li>focus on “user stories”, e.g. specific use cases</li>
<li><p>Be as specific as possible,</p></li>
<li><p>Here is an example:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>Bob is at www.mysite.edu/maps</li>
<li>map of the the region (based on user location, e.g. US, Asia, etc)</li>
<li>option to “use current location” is provided, if clicked, map zooms in to, e.g. state or county level</li>
<li>for site run:
<ol style="list-style-type: decimal">
<li>option to select existing site or specify point by lat/lon</li>
<li>option to specify a bounding box and grid resolution in
either lat/lon or polar stereographic.</li>
</ol></li>
<li>asked to specify start and end times in terms of year, month, day, hour, minute. Time is recorded in UTC not local time, this should be indicated.</li>
</ol>
</div>
<div id="closing-an-issue" class="section level4">
<h4><span class="header-section-number">6.2.2.5</span> Closing an issue</h4>
<ol style="list-style-type: decimal">
<li>Definition of “Done”</li>
</ol>
<ul>
<li>test</li>
<li>documentation</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>when issue is resolved:</li>
</ol>
<ul>
<li>status is changed to “resolved”</li>
<li>assignee is changed to original author</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>if original author agrees that issue has been resolved</li>
</ol>
<ul>
<li>original author changes status to “closed”</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>except for trivial issues, issues are only closed by the author</li>
</ol>
</div>
<div id="when-to-submit-an-issue" class="section level4">
<h4><span class="header-section-number">6.2.2.6</span> When to submit an issue?</h4>
</div>
<div id="ideally-non-trivial-code-changes-will-be-linked-to-an-issue-and-a-commit." class="section level4">
<h4><span class="header-section-number">6.2.2.7</span> Ideally, non-trivial code changes will be linked to an issue and a commit.</h4>
<p>This requires creating issues for each task, making small commits, and referencing the issue within your commit message. Issues can be created <a href="https://github.com/PecanProject/pecan/issues/new">on GitHub</a>. These issues can be linked to commits by adding text such as <code>fixes gh-5</code>).</p>
<p>Rationale: This workflow is a small upfront investment that reduces error and time spent re-creating and debugging errors. Associating issues and commits, makes it easier to identify why a change was made, and potential bugs that could arise when the code is changed. In addition, knowing which issue you are working on clarifies the scope and objectives of your current task.</p>

</div>
</div>
</div>
<div id="coding-practices" class="section level2">
<h2><span class="header-section-number">6.3</span> Coding Practices</h2>

</div>
<div id="coding-style" class="section level2">
<h2><span class="header-section-number">6.4</span> Coding Style</h2>
<p>Consistent coding style improves readability and reduces errors in
shared code.</p>
<p>R does not have an official style guide, but Hadley Wickham provides one that is well
thought out and widely adopted. <a href="http://r-pkgs.had.co.nz/style.html">Advanced R: Coding Style</a>.</p>
<p>Both the Wickham text and this page are derived from <a href="https://google.github.io/styleguide/Rguide.xml">Google’s R Style Guide</a>.</p>
<div id="use-roxygen2-documentation" class="section level4">
<h4><span class="header-section-number">6.4.0.1</span> Use Roxygen2 documentation</h4>
<p>This is the standard method of documentation used in PEcAn development,
it provides inline documentation similar to doxygen. Even trivial
functions should be documented.</p>
<p>See <a href="Roxygen2.md">Roxygen2</a> Wiki page</p>
</div>
<div id="write-your-name-at-the-top" class="section level4">
<h4><span class="header-section-number">6.4.0.2</span> Write your name at the top</h4>
<p>Any function that you create or make a meaningful contribution to should
have your name listed after the author tag in the function documentation.</p>
</div>
<div id="use-testthat-testing-package" class="section level4">
<h4><span class="header-section-number">6.4.0.3</span> Use testthat testing package</h4>
<p>See <a href="Testing.md">Unit_Testing</a> wiki for instructions, and <a href="http://r-pkgs.had.co.nz/tests.html">Advanced R: Tests</a>.</p>
<ul>
<li>tests provide support for documentation - they define what a function is (and is not) expected to do</li>
<li>all functions need tests to ensure basic functionality is maintained during development.</li>
<li>all bugs should have a test that reproduces the bug, and the test should pass before bug is closed</li>
</ul>
</div>
<div id="dont-use-shortcuts" class="section level4">
<h4><span class="header-section-number">6.4.0.4</span> Don’t use shortcuts</h4>
<p>R provides many shortcuts that are useful when coding interactively, or for writing scripts. However, these can make code more difficult to read and can cause problems when written into packages.</p>
</div>
<div id="function-names-verb.noun" class="section level4">
<h4><span class="header-section-number">6.4.0.5</span> Function Names (<code>verb.noun</code>)</h4>
<p>Following convention established in PEcAn 0.1, we use the all lowercase with periods to separate words. They should generally have a <code>verb.noun</code> format, such as <code>query.traits</code>, <code>get.samples</code>, etc.</p>
</div>
<div id="file-names" class="section level4">
<h4><span class="header-section-number">6.4.0.6</span> File Names</h4>
<p>File names should end in <code>.R</code>, <code>.Rdata</code>, <code>.Rscript</code> and should be meaningful, e.g. named after the primary functions that they contain. There should be a separate file for each major high-level function to aid in identifying the contents of files in a directory.</p>
</div>
<div id="use---as-an-assignment-operator" class="section level4">
<h4><span class="header-section-number">6.4.0.7</span> Use “&lt;-” as an assignment operator</h4>
<ul>
<li>Because most R code uses &lt;- (except where = is required), we will use &lt;-</li>
<li>“=” is used for function arguments</li>
</ul>
</div>
<div id="use-spaces" class="section level4">
<h4><span class="header-section-number">6.4.0.8</span> Use Spaces</h4>
<ul>
<li>around all binary operators (=, +, -, &lt;-, etc.).</li>
<li>after but not before a comma</li>
</ul>
</div>
<div id="use-curly-braces" class="section level4">
<h4><span class="header-section-number">6.4.0.9</span> Use curly braces</h4>
<p>The option to omit curly braces is another shortcut that makes code easier to write but harder to read and more prone to error.</p>
</div>
<div id="package-dependencies" class="section level4">
<h4><span class="header-section-number">6.4.0.10</span> Package Dependencies:</h4>
</div>
<div id="library-vs-require" class="section level4">
<h4><span class="header-section-number">6.4.0.11</span> library vs require</h4>
<p>When another package is required by a function or script, it can be called in the following ways:</p>
<p>(As a package dependency loads with the package, these should be the default approaches when writing functions in a package. There can be some exceptions, such as when a rarely-used or non-essential function requires an esoteric package.)
1. When using <code>library</code>,
if dependency is not met, it will print an error and stop
2. When using <code>require</code>, it
will print a warning and continue (but will throw an error when a function from the required package is called)</p>
<p>Reference: Stack Overflow <a href="http://stackoverflow.com/questions/5595512/what-is-the-difference-between-require-and-library">“What is the difference between require and library?”</a></p>
</div>
<div id="depends-suggests-imports" class="section level4">
<h4><span class="header-section-number">6.4.0.12</span> DEPENDS, SUGGESTS, IMPORTS</h4>
<p>It is considered best practice to use DEPENDS and SUGGESTS in DESCRIPTION; SUGGESTS should be used for packages that are called infrequently, or only in examples and vignettes; suggested packages are called by require inside a function.</p>
<p>Consider using IMPORTS instead of depends in the DESCRIPTION files. This will make loading packages faster by allowing it to have functions available without loading the hierarchy of dependencies, dependencies of dependencies, ad infinitum …
From p. 6 of the “R extensions manual”:<a href="http://cran.r-project.org/doc/manuals/R-exts.html" class="uri">http://cran.r-project.org/doc/manuals/R-exts.html</a></p>
<blockquote>
<p>The <code>Suggests</code> field uses the same syntax as <code>Depends</code> and lists packages that are not necessarily needed. This includes packages used only in examples, tests or vignettes (see Section 1.4 [Writing package vignettes], page 26), and packages loaded in the body of functions. E.g., suppose an example from package foo uses a dataset from package bar. Then it is not necessary to have bar use foo unless one wants to execute all the examples/tests/vignettes: it is useful to have bar, but not necessary. Version requirements can be specified, and will be used by R CMD check.</p>
</blockquote>

</div>
</div>
<div id="logging" class="section level2">
<h2><span class="header-section-number">6.5</span> Logging</h2>
<p>During development we often add many print statements to check to see how the code is doing, what is happening, what intermediate results there are etc. When done with the development it would be nice to turn this additional code off, but have the ability to quickly turn it back on if we discover a problem. This is where logging comes into play. Logging allows us to use “rules” to say what information should be shown. For example when I am working on the code to create graphs, I do not have to see any debugging information about the SQL command being sent, however trying to figure out what goes wrong during a SQL statement it would be nice to show the SQL statements without adding any additional code.</p>
<div id="pecan-logging-functions" class="section level3">
<h3><span class="header-section-number">6.5.1</span> PEcAn logging functions</h3>
<p>These <code>logger</code> family of functions are more sophisticated, and can be used in place of <code>stop</code>, <code>warn</code>, <code>print</code>, and similar functions. The <code>logger</code> functions make it easier to print to a system log file.</p>
<div id="examples" class="section level4">
<h4><span class="header-section-number">6.5.1.1</span> Examples</h4>
<ul>
<li>The file <a href="../blob/master/utils/inst/tests/test.logger.R">test.logger.R</a> provides descriptive examples</li>
<li>This query provides an current overview of <a href="https://github.com/PecanProject/pecan/search?q=logger&amp;ref=cmdform">functions that use logging</a></li>
<li>logger functions (in order of increasing level):</li>
<li><code>logger.debug</code></li>
<li><code>logger.info</code></li>
<li><code>logger.warn</code></li>
<li><code>logger.error</code></li>
<li>the <code>logger.setLevel</code> function sets the level at which a message will be printed</li>
<li><code>logger.setLevel(&quot;DEBUG&quot;)</code> will print messages from all logger functions</li>
<li><code>logger.setLevel(&quot;ERROR&quot;)</code> will only print messages from <code>logger.error</code></li>
<li><code>logger.setLevel(&quot;INFO&quot;)</code> and <code>logger.setLevel(&quot;WARN&quot;) shows messages from</code>logger.<level><code>and higher functions, e.g.</code>logger.setLevel(“WARN”)<code>shows messages from</code>logger.warn<code>and</code>logger.error`</li>
<li><code>logger.setLevel(&quot;OFF&quot;)</code> suppresses all logger messages</li>
<li>To print all messages to console, use <code>logger.setUseConsole(TRUE)</code></li>
</ul>
</div>
<div id="related-issues-requires-redmine-developer-account" class="section level4">
<h4><span class="header-section-number">6.5.1.2</span> Related Issues (requires Redmine developer account)</h4>
<ul>
<li><a href="https://ebi-forecast.igb.illinois.edu/redmine/issues/1071">#1071 How to handle errors?</a></li>
<li><a href="https://ebi-forecast.igb.illinois.edu/redmine/issues/1222">#1222 Ignore warnings</a>
You can use <span class="citation">@logger.setLevel</span>(“ERROR”)@ to only show error messages. All the code that does not use logger will not be filtered.</li>
</ul>
</div>
</div>
<div id="other-r-logging-packages" class="section level3">
<h3><span class="header-section-number">6.5.2</span> Other R logging packages</h3>
<ul>
<li><strong>This section is for reference - these functions should not be used in PEcAn, as they are redundant with the <code>logger.*</code> functions described above</strong></li>
</ul>
<p>R does provide a basic logging capability using stop, warning and message. These allow to print message (and stop execution in case of stop). However there is not an easy method to redirect the logging information to a file, or turn the logging information on and off. This is where one of the following packages comes into play. The packages themselves are very similar since they try to emulate log4j.</p>
<p>Both of the following packages use a hierarchic loggers, meaning that if you change the level of displayed level of logging at one level all levels below it will update their logging.</p>
<div id="logging-1" class="section level4">
<h4><span class="header-section-number">6.5.2.1</span> logging</h4>
The logging development is done at <a href="http://logging.r-forge.r-project.org/" class="uri">http://logging.r-forge.r-project.org/</a> and more information is located at <a href="http://cran.r-project.org/web/packages/logging/index.html" class="uri">http://cran.r-project.org/web/packages/logging/index.html</a> . To install use the following command:
<pre>
install.packages("logging", repos="http://R-Forge.R-project.org")
</pre>
<p>This has my preference pure based on documentation.</p>
</div>
<div id="futile" class="section level4">
<h4><span class="header-section-number">6.5.2.2</span> futile</h4>
<p>The second logging package is <a href="http://cran.r-project.org/web/packages/futile.logger/" class="uri">http://cran.r-project.org/web/packages/futile.logger/</a> and is eerily similar to logging (as a matter of fact logging is based on futile).</p>
</div>
</div>
<div id="example-usage" class="section level3">
<h3><span class="header-section-number">6.5.3</span> Example Usage</h3>
<p>To be able to use the loggers there needs to be some initialization done. Neither package allows to read it from a configuration file, so we might want to use the pecan.xml file to set it up. The setup will always be somewhat the same:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load library</span>
<span class="kw">library</span>(logging)
<span class="kw">logReset</span>()

<span class="co"># add handlers, responsible for actually printing/saving the messages</span>
<span class="kw">addHandler</span>(writeToConsole)
<span class="kw">addHandler</span>(writeToFile, <span class="dt">file=</span><span class="st">&quot;file.log&quot;</span>)

<span class="co"># setup root logger with INFO</span>
<span class="kw">setLevel</span>(<span class="st">&#39;INFO&#39;</span>)

<span class="co"># make all of PEcAn print debug messages</span>
<span class="kw">setLevel</span>(<span class="st">&#39;DEBUG&#39;</span>, <span class="kw">getLogger</span>(<span class="st">&#39;PEcAn&#39;</span>))

<span class="co"># only print info and above for the SQL part of PEcAn</span>
<span class="kw">setLevel</span>(<span class="st">&#39;INFO&#39;</span>, <span class="kw">getLogger</span>(<span class="st">&#39;PEcAn.SQL&#39;</span>))</code></pre>
<p>To now use logging in the code you can use the following code:</p>
<pre class="sourceCode r"><code class="sourceCode r">pl &lt;-<span class="st"> </span><span class="kw">getLogger</span>(<span class="st">&#39;PEcAn.MetaAnalysis.function1&#39;</span>)
pl<span class="op">$</span><span class="kw">info</span>(<span class="st">&quot;This is an INFO message.&quot;</span>)
pl<span class="op">$</span><span class="kw">debug</span>(<span class="st">&quot;The value for x=%d&quot;</span>, x)
pl<span class="op">$</span><span class="kw">error</span>(<span class="st">&quot;Something bad happened and I am scared now.&quot;</span>)</code></pre>
<p>or</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">loginfo</span>(<span class="st">&quot;This is an INFO message.&quot;</span>, <span class="dt">logger=</span><span class="st">&quot;PEcAn.MetaAnalysis.function1&quot;</span>)
<span class="kw">logdebug</span>(<span class="st">&quot;The value for x=%d&quot;</span>, x, <span class="dt">logger=</span><span class="st">&quot;PEcAn.MetaAnalysis.function1&quot;</span>)
<span class="kw">logerror</span>(<span class="st">&quot;Something bad happened and I am scared now.&quot;</span>, <span class="dt">logger=</span><span class="st">&quot;PEcAn.MetaAnalysis.function1&quot;</span>)</code></pre>

</div>
</div>
<div id="package-data" class="section level2">
<h2><span class="header-section-number">6.6</span> Package Data</h2>
<div id="summary" class="section level4">
<h4><span class="header-section-number">6.6.0.1</span> Summary:</h4>
<p>Files with the following extensions will be read by R as data:</p>
<ul>
<li>plain R code in .R and .r files are sourced using <code>source()</code></li>
<li>text tables in .tab, .txt, .csv files are read using <code>read()</code>
** objects in R image files: .RData, .rda are loaded using <code>load()</code></li>
<li>capitalization matters</li>
<li>all objects in foo.RData are loaded into environment</li>
<li>pro: easiset way to store objects in R format</li>
<li>con: format is application (R) specific (<a href="https://ebi-forecast.igb.illinois.edu/redmine/issues/318">discussed in #318</a>)</li>
</ul>
<p>Details are in <code>?data</code>, which is mostly a copy of <a href="http://cran.r-project.org/doc/manuals/R-exts.html#Data-in-packages">Data section of
Writing R
Extensions</a>.</p>
</div>
<div id="accessing-data" class="section level4">
<h4><span class="header-section-number">6.6.0.2</span> Accessing data</h4>
<p>Data in the [data] directory will be accessed in the following ways,</p>
<ul>
<li>efficient way: (especially for large data sets) using the <code>data</code>
function:</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(foo) <span class="co"># accesses data with, e.g. load(foo.RData), read(foo.csv), or source(foo.R) </span></code></pre>
<ul>
<li>easy way: by adding the following line to the package DESCRIPTION:
<em>note:</em> this should be used with caution or it can cause difficulty as discussed in redmine issue #1118</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">LazyData<span class="op">:</span><span class="st"> </span><span class="ot">TRUE</span></code></pre>
<p>From the R help page:</p>
<p>Currently, a limited number of data formats can be accessed using the <code>data</code> function by placing one of the following filetypes in a packages’ <code>data</code> directory:
* files ending <code>.R</code> or <code>.r</code> are <code>source()</code>d in, with the R working
directory changed temporarily to the directory containing the respective
file. (<code>data</code> ensures that the <code>utils</code> package is attached, in case it
had been run <em>via</em> <code>utils::data</code>.)
* files ending <code>.RData</code> or <code>.rda</code> are <code>load()</code>ed.
* files ending <code>.tab</code>, <code>.txt</code> or <code>.TXT</code> are read using <code>read.table(..., header = TRUE)</code>, and hence result in a data frame.
* files ending <code>.csv</code> or <code>.CSV</code> are read using <code>read.table(..., header = TRUE, sep = ';')</code>, and also result in a data frame.</p>
<p>If your data does not fall in those 4 categories, or you can use the
<code>system.file</code> function to get access to the data:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.file</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;ed.trait.dictionary.csv&quot;</span>, <span class="dt">package=</span><span class="st">&quot;PEcAn.utils&quot;</span>)
[<span class="dv">1</span>] <span class="st">&quot;/home/kooper/R/x86_64-pc-linux-gnu-library/2.15/PEcAn.utils/data/ed.trait.dictionary.csv&quot;</span></code></pre>
<p>The arguments are folder, filename(s) and then package. It will return
the fully qualified path name to a file in a package, in this case it
points to the trait data. This is almost the same as the data function,
however we can now use any function to read the file, such as read.csv
instead of read.csv2 which seems to be the default of data. This also
allows us to store arbitrary files in the data folder, such as the the
bug file and load it when we need it.</p>
<div id="examples-of-data-in-pecan-packages" class="section level5">
<h5><span class="header-section-number">6.6.0.2.1</span> Examples of data in PEcAn packages</h5>
<ul>
<li><a href="https://ebi-forecast.igb.illinois.edu/redmine/issues/1060">Redmine issue #1060</a> added time constants in <code>source:utils/data/time.constants.RData</code></li>
<li>outputs: [/modules/uncertainties/data/output.RData]</li>
<li>parameter samples [/modules/uncertainties/data/samples.RData]</li>
</ul>
<p>Packages used in development</p>
</div>
</div>
<div id="roxygen2" class="section level4">
<h4><span class="header-section-number">6.6.0.3</span> roxygen2</h4>
<p>Used to document code. See instructions under [[R#Coding_Style|Coding
Style]]</p>
</div>
<div id="devtools" class="section level4">
<h4><span class="header-section-number">6.6.0.4</span> devtools</h4>
<p>Provides functions to simplify development</p>
<p>Documentation:
<a href="https://github.com/hadley/devtools">The R devtools packate</a></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load_all</span>(<span class="st">&quot;pkg&quot;</span>)
<span class="kw">document</span>(<span class="st">&quot;pkg&quot;</span>)
<span class="kw">test</span>(<span class="st">&quot;pkg&quot;</span>)
<span class="kw">install</span>(<span class="st">&quot;pkg&quot;</span>)
<span class="kw">build</span>(<span class="st">&quot;pkg&quot;</span>)</code></pre>
<p>other tips for devtools (from the documentation):</p>
<ul>
<li>Adding the following to your <code>~/.Rprofile</code> will load devtools when
running R in interactive mode:</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load devtools by default</span>
<span class="cf">if</span> (<span class="kw">interactive</span>()) {
  <span class="kw">suppressMessages</span>(<span class="kw">require</span>(devtools))
}</code></pre>
<ul>
<li>Adding the following to your .Rpackages will allow devtools to recognize package by folder name, rather than directory path</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># in this example, devhome is the pecan trunk directory </span>
devhome &lt;-<span class="st"> &quot;/home/dlebauer/R-dev/pecandev/&quot;</span>
<span class="kw">list</span>(
    <span class="dt">default =</span> <span class="cf">function</span>(x) {
      <span class="kw">file.path</span>(devhome, x, x)
    }, 
  <span class="st">&quot;utils&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(devhome, <span class="st">&quot;pecandev/utils&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
  <span class="st">&quot;common&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(devhome, <span class="st">&quot;pecandev/common&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
  <span class="st">&quot;all&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(devhome, <span class="st">&quot;pecandev/all&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
  <span class="st">&quot;ed&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(devhome, <span class="st">&quot;pecandev/models/ed&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
  <span class="st">&quot;uncertainty&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(devhome, <span class="st">&quot;modules/uncertainty&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
  <span class="st">&quot;meta.analysis&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(devhome, <span class="st">&quot;modules/meta.analysis&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
  <span class="st">&quot;db&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(devhome, <span class="st">&quot;db&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
)</code></pre>
<p>Now, devtools can take <code>pkg</code> as an argument instead of <code>/path/to/pkg/</code>,
e.g. so you can use <code>build(&quot;pkg&quot;)</code> instead of <code>build(&quot;/path/to/pkg/&quot;)</code></p>

</div>
</div>
<div id="roxygen2-1" class="section level2">
<h2><span class="header-section-number">6.7</span> Roxygen2</h2>
<p>This is the standard method of documentation used in PEcAn development, it provides inline documentation similar to doxygen.</p>
<div id="canonical-references" class="section level4">
<h4><span class="header-section-number">6.7.0.1</span> Canonical references:</h4>
<ul>
<li>Must Read: R package development by Hadley Wickham:</li>
<li><a href="http://r-pkgs.had.co.nz/man.html"><strong>Object Documentation</strong></a><br />
</li>
<li><a href="http://r-pkgs.had.co.nz/description.html">Package Metadata</a></li>
<li>Roxygen2 Documentation</li>
<li><a href="http://cran.r-project.org/web/packages/roxygen2/roxygen2.pdf">Roxygen2 Package Documentation</a></li>
<li><a href="https://github.com/klutometis/roxygen">GitHub</a></li>
</ul>
</div>
<div id="basic-roxygen2-instructions" class="section level4">
<h4><span class="header-section-number">6.7.0.2</span> Basic Roxygen2 instructions:</h4>
<p>Section headers link to “Writing R extensions” which provides in-depth documentation. This is provided as an overview and quick reference.</p>
</div>
<div id="tags-1" class="section level4">
<h4><span class="header-section-number">6.7.0.3</span> <a href="http://cran.r-project.org/doc/manuals/R-exts.html#Documenting-functions">Tags</a></h4>
<ul>
<li>tags are preceeded by <code>##'</code></li>
<li>tags required by R:
** <code>title</code> tag is required, along with actual title
** <code>param</code> one for each parameter, should be defined
** <code>return</code> must state what function returns (or nothing, if something occurs as a side effect</li>
<li>tags strongly suggested for most functions:
** <code>author</code>
** <code>examples</code> can be similar to test cases.</li>
<li>optional tags:
** <code>export</code> required if function is used by another package
** <code>import</code> can import a required function from another package (if package is not loaded or other function is not exported)
** <code>seealso</code> suggests related functions. These can be linked using <code>\code{link{}}</code></li>
</ul>
</div>
<div id="text-markup" class="section level4">
<h4><span class="header-section-number">6.7.0.4</span> Text markup</h4>
<div id="formatting" class="section level5">
<h5><span class="header-section-number">6.7.0.4.1</span> <a href="http://cran.r-project.org/doc/manuals/R-exts.html#Marking-text">Formatting</a></h5>
<ul>
<li><code>\bold{}</code></li>
<li><code>\emph{}</code> italics</li>
</ul>
</div>
<div id="links" class="section level5">
<h5><span class="header-section-number">6.7.0.4.2</span> <a href="http://cran.r-project.org/doc/manuals/R-exts.html#Marking-text">Links</a></h5>
<ul>
<li><code>\url{www.url.com}</code> or <code>\href{url}{text}</code> for links</li>
<li><code>\code{\link{thisfn}}</code> links to function “thisfn” in the same package</li>
<li><code>\code{\link{foo::thatfn}}</code> links to function “thatfn” in package “foo”</li>
<li><code>\pkg{package_name}</code></li>
</ul>
</div>
<div id="math" class="section level5">
<h5><span class="header-section-number">6.7.0.4.3</span> <a href="http://cran.r-project.org/doc/manuals/R-exts.html#Mathematics">Math</a></h5>
<ul>
<li><code>\eqn{a+b=c}</code> uses LaTex to format an inline equation</li>
<li><code>\deqn{a+b=c}</code> uses LaTex to format displayed equation</li>
<li><code>\deqn{latex}{ascii}</code> and <code>\eqn{latex}{ascii}</code> can be used to provide different versions in latex and ascii.</li>
</ul>
</div>
<div id="lists" class="section level5">
<h5><span class="header-section-number">6.7.0.4.4</span> <a href="http://cran.r-project.org/doc/manuals/R-exts.html#Lists-and-tables">Lists</a></h5>
<pre><code>\enumerate{
\item A database consists of one or more records, each with one or
more named fields.
\item Regular lines start with a non-whitespace character.
\item Records are separated by one or more empty lines.
}
\itemize and \enumerate commands may be nested.</code></pre>
</div>
<div id="tableshttpcran.r-project.orgdocmanualsr-exts.htmllists-and-tables" class="section level5">
<h5><span class="header-section-number">6.7.0.4.5</span> “Tables”:<a href="http://cran.r-project.org/doc/manuals/R-exts.html#Lists-and-tables" class="uri">http://cran.r-project.org/doc/manuals/R-exts.html#Lists-and-tables</a></h5>
<pre><code>\tabular{rlll}{
[,1] \tab Ozone \tab numeric \tab Ozone (ppb)\cr
[,2] \tab Solar.R \tab numeric \tab Solar R (lang)\cr
[,3] \tab Wind \tab numeric \tab Wind (mph)\cr
[,4] \tab Temp \tab numeric \tab Temperature (degrees F)\cr
[,5] \tab Month \tab numeric \tab Month (1--12)\cr
[,6] \tab Day \tab numeric \tab Day of month (1--31)
}</code></pre>
</div>
</div>
<div id="example" class="section level4">
<h4><span class="header-section-number">6.7.0.5</span> Example</h4>
<p>Here is an example documented function, myfun</p>
<pre><code>##&#39; My function adds three numbers
##&#39;
##&#39; A great function for demonstrating Roxygen documentation
##&#39; @param a numeric
##&#39; @param b numeric
##&#39; @param c numeric
##&#39; @return d, numeric sum of a + b + c
##&#39; @export
##&#39; @author David LeBauer
##&#39; @examples
##&#39; myfun(1,2,3)
##&#39; \dontrun{myfun(NULL)}
myfun &lt;- function(a, b, c){
  d &lt;- a + b + c
  return(d)
}</code></pre>
<p>In emacs, with the cursor inside the function, the keybinding C-x O will generate an outline or update the Roxygen2 documentation.</p>
</div>
<div id="updating-documentation" class="section level4">
<h4><span class="header-section-number">6.7.0.6</span> Updating documentation</h4>
<ul>
<li>After adding documentation run the following command (replacing common with the name of the folder you want to update):
** In R using devtools to call roxygenize:</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(devtools)
<span class="kw">document</span>(<span class="st">&quot;common&quot;</span>)</code></pre>

</div>
</div>
<div id="testing" class="section level2">
<h2><span class="header-section-number">6.8</span> Testing</h2>
<p>PEcAn uses the testthat package developed by Hadley Wickham. Hadley has
written instructions for using this package in his
<a href="http://adv-r.had.co.nz/Testing.html">Testing</a> chapter.</p>
<div id="rationale" class="section level4">
<h4><span class="header-section-number">6.8.0.1</span> Rationale</h4>
<ul>
<li>makes development easier</li>
<li>provides working documentation of expected functionality</li>
<li>saves time by allowing computer to take over error checking once a
test has been made</li>
<li>improves code quality</li>
<li>Further reading: <a href="http://arxiv.org/pdf/1210.0530v3.pdf">Aruliah et al 2012 Best Practices for Scientific
Computing</a></li>
</ul>
</div>
<div id="tests-makes-development-easier-and-less-error-prone" class="section level4">
<h4><span class="header-section-number">6.8.0.2</span> Tests makes development easier and less error prone</h4>
<p>Testing makes it easier to develop by organizing everything you are
already doing anyway - but integrating it into the testing and
documentation. With a codebase like PEcAn, it is often difficult to get
started. You have to figure out</p>
<ul>
<li>what was I doing yesterday?</li>
<li>what do I want to do today?</li>
<li>what existing functions do I need to edit?</li>
<li>what are the arguments to these functions (and what are examples of
valid arguments)</li>
<li>what packages are affected</li>
<li>where is a logical place to put files used in testing</li>
</ul>
</div>
<div id="quick-start" class="section level4">
<h4><span class="header-section-number">6.8.0.3</span> Quick Start:</h4>
<ul>
<li>decide what you want to do today</li>
<li>identify the issue in github (if none exists, create one)</li>
<li><p>to work on issue 99, create a new branch called “github99” or some descriptive name… Today we will enable an
existing function, <code>make.cheas</code> to make <code>goat.cheddar</code>. We will know
that we are done by the color and taste.</p>
<pre><code>git branch goat-cheddar
git checkout goat-cheddar</code></pre></li>
<li>open existing (or create new) file in <code>inst/tests/</code>. If working on code in “myfunction” or a set of functions in “R/myfile.R”, the file should be named accordingly, e.g. “inst/tests/test.myfile.R”</li>
<li>if you are lucky, the function has already been tested and has some examples.</li>
<li><p>if not, you may need to create a minimal example, often requiring a settings file. The default settings file can be obtained in this way:</p>
<pre class="sourceCode r"><code class="sourceCode r">settings &lt;-<span class="st"> </span><span class="kw">read.settings</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata/test.settings.xml&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;PEcAn.utils&quot;</span>))</code></pre></li>
<li><p>write what you want to do</p>
<pre><code>test_that(&quot;make.cheas can make cheese&quot;,{
  goat.cheddar &lt;- make.cheas(source = &#39;goat&#39;, style = &#39;cheddar&#39;)
  expect_equal(color(goat.cheddar), &quot;orange&quot;)
  expect_is(object = goat.cheddar, class = &quot;cheese&quot;)
  expect_true(all(c(&quot;sharp&quot;, &quot;creamy&quot;) %in% taste(goat.cheddar)))
}</code></pre></li>
<li>now edit the goat.cheddar function until it makes savory, creamy, orange cheese.</li>
<li>commit often</li>
<li><p>update documentation and test</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw">document</span>(<span class="st">&quot;mypkg&quot;</span>)
<span class="kw">test</span>(<span class="st">&quot;mypkg&quot;</span>)</code></pre></li>
<li>commit again</li>
<li><p>when complete, merge, and push</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">git</span> commit -m <span class="st">&quot;make.cheas makes goat.cheddar now&quot;</span>
<span class="fu">git</span> checkout master
<span class="fu">git</span> merge goat-cheddar
<span class="fu">git</span> push</code></pre></li>
</ul>
</div>
<div id="test-files" class="section level4">
<h4><span class="header-section-number">6.8.0.4</span> Test files</h4>
<p>Many of PEcAn’s functions require inputs that are provided as data.
These can be in the <code>/data</code> or the <code>/inst/extdata</code> folders of a package.
Data that are not package specific should be placed in the PEcAn.all or
PEcAn.utils files.</p>
<p>Some useful conventions:</p>
</div>
<div id="settings" class="section level4">
<h4><span class="header-section-number">6.8.0.5</span> Settings</h4>
<ul>
<li>A generic settings can be found in the PEcAn.all package</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">settings.xml &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;pecan.biocro.xml&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;PEcAn.BIOCRO&quot;</span>)
settings &lt;-<span class="st"> </span><span class="kw">read.settings</span>(settings.xml)</code></pre>
<ul>
<li>database settings can be specified, and tests run only if a connection is available</li>
</ul>
<p>We currently use the following database to run tests against; tests that require access to a database should check <code>db.exists()</code> and be skipped if it returns FALSE to avoid failed tests on systems that do not have the database installed.</p>
<pre class="sourceCode r"><code class="sourceCode r">settings<span class="op">$</span>database &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">userid =</span> <span class="st">&quot;bety&quot;</span>, 
                          <span class="dt">passwd =</span> <span class="st">&quot;bety&quot;</span>, 
                          <span class="dt">name =</span> <span class="st">&quot;bety&quot;</span>,     <span class="co"># database name </span>
                          <span class="dt">host =</span> <span class="st">&quot;localhost&quot;</span> <span class="co"># server name)</span>
<span class="kw">test_that</span>(..., {
  <span class="kw">skip_if_not</span>(<span class="kw">db.exists</span>(settings<span class="op">$</span>database))
  ## write tests here
})</code></pre>
<ul>
<li>instructions for installing this are available on the <a href="VM-Creation.md">VM creation
wiki</a></li>
<li><p>examples can be found in the PEcAn.DB package (<code>base/db/tests/testthat/</code>).</p></li>
<li><p>Model specific settings can go in the model-specific module, for
example:</p></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">settings.xml &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/pecan.biocro.xml&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;PEcAn.BIOCRO&quot;</span>)
settings &lt;-<span class="st"> </span><span class="kw">read.settings</span>(settings.xml)</code></pre>
<ul>
<li>test-specific settings:
<ul>
<li><p>settings text can be specified inline:</p>
<pre><code>settings.text &lt;- &quot;
  &lt;pecan&gt;
    &lt;nocheck&gt;nope&lt;/nocheck&gt; ## allows bypass of checks in the read.settings functions
    &lt;pfts&gt;
      &lt;pft&gt;
        &lt;name&gt;ebifarm.pavi&lt;/name&gt;
        &lt;outdir&gt;test/&lt;/outdir&gt;
      &lt;/pft&gt;
    &lt;/pfts&gt;
    &lt;outdir&gt;test/&lt;/outdir&gt;
    &lt;database&gt;
      &lt;userid&gt;bety&lt;/userid&gt;
      &lt;passwd&gt;bety&lt;/passwd&gt;
      &lt;location&gt;localhost&lt;/location&gt;
      &lt;name&gt;bety&lt;/name&gt;
    &lt;/database&gt;
  &lt;/pecan&gt;&quot;
settings &lt;- read.settings(settings.text)</code></pre></li>
<li><p>values in settings can be updated:</p>
<pre class="sourceCode r"><code class="sourceCode r">settings &lt;-<span class="st"> </span><span class="kw">read.settings</span>(settings.text)
settings<span class="op">$</span>outdir &lt;-<span class="st"> &quot;/tmp&quot;</span> ## or any other settings</code></pre></li>
</ul></li>
</ul>
</div>
<div id="helper-functions-created-to-make-testing-easier" class="section level4">
<h4><span class="header-section-number">6.8.0.6</span> Helper functions created to make testing easier</h4>
<ul>
<li><strong>tryl</strong> returns FALSE if function gives error</li>
<li><strong>temp.settings</strong> creates temporary settings file</li>
<li><strong>test.remote</strong> returns TRUE if remote connection is available</li>
<li><strong>db.exists</strong> returns TRUE if connection to database is available</li>
</ul>
</div>
<div id="when-should-i-test" class="section level4">
<h4><span class="header-section-number">6.8.0.7</span> When should I test?</h4>
<p>A test <em>should</em> be written for each of the following situations:</p>
<ol style="list-style-type: decimal">
<li>Each bug should get a regression test.</li>
</ol>
<ul>
<li>The first step in handling a bug is to write code that reproduces the error</li>
<li>This code becomes the test</li>
<li>most important when error could re-appear</li>
<li>essential when error silently produces invalid results</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Every time a (non-trivial) function is created or edited</li>
</ol>
<ul>
<li>Write tests that indicate how the function should perform
<ul>
<li>example: <code>expect_equal(sum(1,1), 2)</code> indicates that the sum
function should take the sum of its arguments</li>
</ul></li>
<li>Write tests for cases under which the function should throw an
error</li>
<li>example: <code>expect_error(sum(&quot;foo&quot;))</code></li>
<li>better : <code>expect_error(sum(&quot;foo&quot;), &quot;invalid 'type' (character)&quot;)</code></li>
</ul>
</div>
<div id="what-types-of-testing-are-important-to-understand" class="section level4">
<h4><span class="header-section-number">6.8.0.8</span> What types of testing are important to understand?</h4>
</div>
<div id="unit-testing-test-driven-development" class="section level4">
<h4><span class="header-section-number">6.8.0.9</span> Unit Testing / Test Driven Development</h4>
<p>Tests are only as good as the test</p>
<ol style="list-style-type: decimal">
<li>write test</li>
<li>write code</li>
</ol>
</div>
<div id="regression-testing" class="section level4">
<h4><span class="header-section-number">6.8.0.10</span> Regression Testing</h4>
<p>When a bug is found,</p>
<ol style="list-style-type: decimal">
<li>write a test that finds the bug (the minimum test required to make
the test fail)</li>
<li>fix the bug</li>
<li>bug is fixed when test passes</li>
</ol>
</div>
<div id="how-should-i-test-in-r-the-testthat-package." class="section level4">
<h4><span class="header-section-number">6.8.0.11</span> How should I test in R? The testthat package.</h4>
<p>tests are found in <code>~/pecan/&lt;packagename&gt;/inst/tests</code>, for example
<code>utils/inst/tests/</code></p>
<p>See attached file and
<a href="http://r-pkgs.had.co.nz/tests.html" class="uri">http://r-pkgs.had.co.nz/tests.html</a>
for details on how to use the testthat package.</p>
<div id="list-of-expectations" class="section level5">
<h5><span class="header-section-number">6.8.0.11.1</span> List of Expectations</h5>
<table>
<thead>
<tr class="header">
<th>Full</th>
<th>Abbreviation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>expect_that(x, is_true())</td>
<td>expect_true(x)</td>
</tr>
<tr class="even">
<td>expect_that(x, is_false())</td>
<td>expect_false(x)</td>
</tr>
<tr class="odd">
<td>expect_that(x, is_a(y))</td>
<td>expect_is(x, y)</td>
</tr>
<tr class="even">
<td>expect_that(x, equals(y))</td>
<td>expect_equal(x, y)</td>
</tr>
<tr class="odd">
<td>expect_that(x, is_equivalent_to(y))</td>
<td>expect_equivalent(x, y)</td>
</tr>
<tr class="even">
<td>expect_that(x, is_identical_to(y))</td>
<td>expect_identical(x, y)</td>
</tr>
<tr class="odd">
<td>expect_that(x, matches(y))</td>
<td>expect_matches(x, y)</td>
</tr>
<tr class="even">
<td>expect_that(x, prints_text(y))</td>
<td>expect_output(x, y)</td>
</tr>
<tr class="odd">
<td>expect_that(x, shows_message(y))</td>
<td>expect_message(x, y)</td>
</tr>
<tr class="even">
<td>expect_that(x, gives_warning(y))</td>
<td>expect_warning(x, y)</td>
</tr>
<tr class="odd">
<td>expect_that(x, throws_error(y))</td>
<td>expect_error(x, y)</td>
</tr>
</tbody>
</table>
</div>
<div id="how-to-run-tests" class="section level5">
<h5><span class="header-section-number">6.8.0.11.2</span> How to run tests</h5>
<p>add the following to “pecan/tests/testthat.R”</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(testthat)
<span class="kw">library</span>(mypackage)

<span class="kw">test_check</span>(<span class="st">&quot;mypackage&quot;</span>)</code></pre>
</div>
</div>
<div id="basic-use-of-the-testthat-package" class="section level4">
<h4><span class="header-section-number">6.8.0.12</span> basic use of the testthat package</h4>
<p>Here is an example of tests (these should be placed in
<code>&lt;packagename&gt;/tests/testthat/test-&lt;sourcefilename&gt;.R</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">test_that</span>(<span class="st">&quot;mathematical operators plus and minus work as expected&quot;</span>,{
  <span class="kw">expect_equal</span>(<span class="kw">sum</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dv">2</span>)
  <span class="kw">expect_equal</span>(<span class="kw">sum</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dv">-2</span>)
  <span class="kw">expect_equal</span>(<span class="kw">sum</span>(<span class="dv">1</span>,<span class="ot">NA</span>), <span class="ot">NA</span>)
  <span class="kw">expect_error</span>(<span class="kw">sum</span>(<span class="st">&quot;cat&quot;</span>))
  <span class="kw">set.seed</span>(<span class="dv">0</span>)
  <span class="kw">expect_equal</span>(<span class="kw">sum</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)), <span class="kw">sum</span>(<span class="kw">data.frame</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)))
})

<span class="kw">test_that</span>(<span class="st">&quot;different testing functions work, giving excuse to demonstrate&quot;</span>,{
  <span class="kw">expect_identical</span>(<span class="dv">1</span>, <span class="dv">1</span>)
  <span class="kw">expect_identical</span>(<span class="kw">numeric</span>(<span class="dv">1</span>), <span class="kw">integer</span>(<span class="dv">1</span>))
  <span class="kw">expect_equivalent</span>(<span class="kw">numeric</span>(<span class="dv">1</span>), <span class="kw">integer</span>(<span class="dv">1</span>))
  <span class="kw">expect_warning</span>(<span class="kw">mean</span>(<span class="st">&#39;1&#39;</span>))
  <span class="kw">expect_that</span>(<span class="kw">mean</span>(<span class="st">&#39;1&#39;</span>), <span class="kw">gives_warning</span>(<span class="st">&quot;argument is not numeric or logical: returning NA&quot;</span>))
  <span class="kw">expect_warning</span>(<span class="kw">mean</span>(<span class="st">&#39;1&#39;</span>), <span class="st">&quot;argument is not numeric or logical: returning NA&quot;</span>)
  <span class="kw">expect_message</span>(<span class="kw">message</span>(<span class="st">&quot;a&quot;</span>), <span class="st">&quot;a&quot;</span>)
})</code></pre>
<div id="script-testing" class="section level5">
<h5><span class="header-section-number">6.8.0.12.1</span> Script testing</h5>
<p>It is useful to add tests to a script during development. This allows
you to test that the code is doing what you expect it to do.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="op">*</span><span class="st"> </span>here is a fake script using the iris data set

<span class="kw">test_that</span>(<span class="st">&quot;the iris data set has the same basic features as before&quot;</span>,{
  <span class="kw">expect_equal</span>(<span class="kw">dim</span>(iris), <span class="kw">c</span>(<span class="dv">150</span>,<span class="dv">5</span>))
  <span class="kw">expect_that</span>(iris<span class="op">$</span>Sepal.Length, <span class="kw">is_a</span>(<span class="st">&quot;numeric&quot;</span>))
  <span class="kw">expect_is</span>(iris<span class="op">$</span>Sepal.Length, <span class="st">&quot;numeric&quot;</span>)<span class="co">#equivalent to prev. line</span>
  <span class="kw">expect_is</span>(iris<span class="op">$</span>Species, <span class="st">&quot;factor&quot;</span>)
})

iris.color &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Species =</span> <span class="kw">c</span>(<span class="st">&quot;setosa&quot;</span>, <span class="st">&quot;versicolor&quot;</span>, <span class="st">&quot;virginica&quot;</span>),
                         <span class="dt">color =</span> <span class="kw">c</span>(<span class="st">&quot;pink&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>))

newiris &lt;-<span class="st"> </span><span class="kw">merge</span>(iris, iris.color)
iris.model &lt;-<span class="st"> </span><span class="kw">lm</span>(Petal.Length <span class="op">~</span><span class="st"> </span>color, <span class="dt">data =</span> newiris)

<span class="kw">test_that</span>(<span class="st">&quot;changes to Iris code occurred as expected&quot;</span>,{
  <span class="kw">expect_that</span>(<span class="kw">dim</span>(newiris), <span class="kw">equals</span>(<span class="kw">c</span>(<span class="dv">150</span>, <span class="dv">6</span>)))
  <span class="kw">expect_that</span>(<span class="kw">unique</span>(newiris<span class="op">$</span>color),
              <span class="kw">is_identical_to</span>(<span class="kw">unique</span>(iris.color<span class="op">$</span>color)))
  <span class="kw">expect_equivalent</span>(iris.model<span class="op">$</span>coefficients[<span class="st">&quot;(Intercept)&quot;</span>], <span class="fl">4.26</span>)
})</code></pre>
</div>
<div id="function-testing" class="section level5">
<h5><span class="header-section-number">6.8.0.12.2</span> Function testing</h5>
<p>Testing of a new function, <code>as.sequence</code>. The function and documentation
are in source:R/utils.R and the tests are in source:tests/test.utils.R.</p>
<p>Recently, I made the function <code>as.sequence</code> to turn any vector into a
sequence, with custom handling of NA’s:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">function</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>){
  x2 &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">factor</span>(x, <span class="kw">unique</span>(x)))
  <span class="cf">if</span>(<span class="kw">all</span>(<span class="kw">is.na</span>(x2))){
    x2 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">length</span>(x2))
  }
  <span class="cf">if</span>(na.rm <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){
    x2[<span class="kw">is.na</span>(x2)] &lt;-<span class="st"> </span><span class="kw">max</span>(x2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
  }
  <span class="kw">return</span>(x2)
}</code></pre>
<p>The next step was to add documentation and test. Many people find it
more efficient to write tests before writing the function. This is true,
but it also requires more discipline. I wrote these tests to handle the
variety of cases that I had observed.</p>
<p>As currently used, the function is exposed to a fairly restricted set of
options - results of downloads from the database and transformations.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">test_that</span>(“as.sequence works”;{
 <span class="kw">expect_identical</span>(<span class="kw">as.sequence</span>(<span class="kw">c</span>(“a”, “b”)), <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)
 <span class="kw">expect_identical</span>(<span class="kw">as.sequence</span>(<span class="kw">c</span>(“a”, <span class="ot">NA</span>)), <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)
 <span class="kw">expect_equal</span>(<span class="kw">as.sequence</span>(<span class="kw">c</span>(“a”, <span class="ot">NA</span>), <span class="dt">na.rm =</span> <span class="ot">FALSE</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="ot">NA</span>))
 <span class="kw">expect_equal</span>(<span class="kw">as.sequence</span>(<span class="kw">c</span>(<span class="ot">NA</span>,<span class="ot">NA</span>)), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))
})</code></pre>
</div>
</div>
<div id="testing-the-shiny-server" class="section level4">
<h4><span class="header-section-number">6.8.0.13</span> Testing the Shiny Server</h4>
<p>Shiny can be difficult to debug because, when run as a web service, the R output is hidden in system log files that are hard to find and read.
One useful approach to debugging is to use port forwarding, as follows.</p>
<p>First, on the remote machine (including the VM), make sure R’s working directory is set to the directory of the Shiny app (e.g., <code>setwd(/path/to/pecan/shiny/WorkflowPlots)</code>, or just open the app as an RStudio project).
Then, in the R console, run the app as:</p>
<pre><code>shiny::runApp(port = XXXX)
# E.g. shiny::runApp(port = 5638)</code></pre>
<p>Then, on your local machine, open a terminal and run the following command, matching <code>XXXX</code> to the port above and <code>YYYY</code> to any unused port on your local machine (any 4-digit number should work).</p>
<pre><code>ssh -L YYYY:localhost:XXXX &lt;remote connection&gt;
# E.g., for the PEcAn VM, given the above port:
# ssh -L 5639:localhost:5638 carya@localhost -p 6422</code></pre>
<p>Now, in a web browser on your local machine, browse to <code>localhost:YYYY</code> (e.g., <code>localhost:5639</code>) to run whatever app you started with <code>shiny::runApp</code> in the previous step.
All of the output should display in the R console where the <code>shiny::runApp</code> command was executed.
Note that this includes any <code>print</code>, <code>message</code>, <code>logger.*</code>, etc. statements in your Shiny app.</p>
<p>If the Shiny app hits an R error, the backtrace should include a line like <code>Hit error at of server.R#LXX</code> – that <code>XX</code> being a line number that you can use to track down the error.
To return from the error to a normal R prompt, hit <code>&lt;Control&gt;-C</code> (alternatively, the “Stop” button in RStudio).
To restart the app, run <code>shiny::runApp(port = XXXX)</code> again (keeping the same port).</p>
<p>Note that Shiny runs any code in the <code>pecan/shiny/&lt;app&gt;</code> directory at the moment the app is launched.
So, any changes you make to the code in <code>server.R</code> and <code>ui.R</code> or scripts loaded therein will take effect the next time the app is started.</p>
<p>If for whatever reason this doesn’t work with RStudio, you can always run R from the command line.
Also, note that the ability to forward ports (<code>ssh -L</code>) may depend on the <code>ssh</code> configuration of your remote machine.
These instructions have been tested on the PEcAn VM (v.1.5.2+).</p>

</div>
</div>
<div id="download-and-compile-pecan" class="section level2">
<h2><span class="header-section-number">6.9</span> Download and Compile PEcAn</h2>
<p>Set <code>R_LIBS_USER</code></p>
<p><a href="http://cran.r-project.org/doc/manuals/r-devel/R-admin.html#Managing-libraries">CRAN Reference</a></p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># point R to personal lib folder</span>
<span class="bu">echo</span> <span class="st">&#39;export R_LIBS_USER=${HOME}/R/library&#39;</span> <span class="op">&gt;&gt;</span> ~/.profile
<span class="bu">source</span> ~/.profile
<span class="fu">mkdir</span> -p <span class="va">${R_LIBS_USER}</span></code></pre>
<div id="download-compile-and-install-pecan-from-github" class="section level4">
<h4><span class="header-section-number">6.9.0.1</span> Download, compile and install PEcAn from GitHub</h4>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># download pecan</span>
<span class="bu">cd</span>
<span class="fu">git</span> clone https://github.com/PecanProject/pecan.git

<span class="co"># compile pecan</span>
<span class="bu">cd</span> pecan
<span class="fu">make</span></code></pre>
<p>For more information on the capabilities of the PEcAn Makefile, check out our section on <a href="developer-guide.html#pecan-make">Updating PEcAn</a>.</p>
<p>Following will run a small script to setup some hooks to prevent people from using the pecan demo user account to check in any code.</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># prevent pecan user from checking in code</span>
<span class="ex">./scripts/create-hooks.sh</span></code></pre>
</div>
<div id="pecan-testrun" class="section level3">
<h3><span class="header-section-number">6.9.1</span> PEcAn Testrun</h3>
<p>Do the run, this assumes you have <a href="pecan-manual-setup.html#install-bety">installed the BETY database</a>, <a href="pecan-manual-setup.html#site-information">sites</a> tar file and <a href="pecan-models.html#models-sipnet">SIPNET</a>.</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># create folder</span>
<span class="bu">cd</span>
<span class="fu">mkdir</span> testrun.pecan
<span class="bu">cd</span> testrun.pecan

<span class="co"># copy example of pecan workflow and configuration file</span>
<span class="fu">cp</span> ../pecan/tests/pecan32.sipnet.xml pecan.xml
<span class="fu">cp</span> ../pecan/scripts/workflow.R workflow.R

<span class="co"># exectute workflow</span>
<span class="fu">rm</span> -rf pecan
<span class="ex">./workflow.R</span> pecan.xml</code></pre>
<p>NB: pecan.xml is configured for the virtual machine, you will need to change the <met> field from ‘/home/carya/’ to wherever you installed your ‘sites’, usually $HOME</p>

</div>
</div>
<div id="directory-structure" class="section level2">
<h2><span class="header-section-number">6.10</span> Directory structure</h2>
<div id="overview-of-pecan-repository-as-of-pecan-1.5.3" class="section level4">
<h4><span class="header-section-number">6.10.0.1</span> Overview of PEcAn repository as of PEcAn 1.5.3</h4>
<!--Should Also include a guideline to structures so that people know where to put things as they add them-->
<pre><code>pecan/
 +- base/          # Core functions
    +- all         # Dummy package to load all PEcAn R packages
    +- db          # Modules for querying the database
    +- logger      # Report warnings without killing workflows
    +- qaqc        # Model skill testing and integration testing
    +- remote      # Communicate with and execute models on local and remote hosts
    +- settings    # Functions to read and manipulate PEcAn settings files
    +- utils       # Misc. utility functions
    +- visualization # Advanced PEcAn visualization module
    +- workflow    # functions to coordinate analysis steps
 +- book_source/   # Main documentation and developer&#39;s guide
 +- CHANGELOG.md   # Running log of changes in each version of PEcAn
 +- docker/        # Experimental replacement for PEcAn virtual machine
 +- documentation  # index_vm.html, references, other misc.
 +- models/        # Wrappers to run models within PEcAn
    +- ed/         # Wrapper scripts for running ED within PEcAn
    +- sipnet/     # Wrapper scripts for running SIPNET within PEcAn
    +- ...         # Wrapper scripts for running [...] within PEcAn
    +- template/   # Sample wrappers to copy and modify when adding a new model
 +- modules        # Core modules
    +- allometry
    +- data.atmosphere
    +- data.hydrology
    +- data.land
    +- meta.analysis
    +- priors
    +- rtm
    +- uncertainty
    +- ...
 +- scripts        # R and Shell scripts for use with PEcAn
 +- shiny/         # Interactive visualization of model results
 +- tests/         # Settings files for host-specific integration tests
 +- web            # Main PEcAn website files</code></pre>
</div>
<div id="generic-r-package-structure" class="section level4">
<h4><span class="header-section-number">6.10.0.2</span> Generic R package structure:</h4>
<p>see the R development wiki for more information on writing code and adding data.</p>
<pre><code> +- DESCRIPTION    # short description of the PEcAn library
 +- R/             # location of R source code
 +- man/           # Documentation (automatically compiled by Roxygen)
 +- inst/          # files to be installed with package that aren&#39;t R functions
    +- extdata/    # misc. data files (in misc. formats)
 +- data/          # data used in testing and examples (saved as *.RData or *.rda files)
 +- NAMESPACE      # declaration of package imports and exports (automatically compiled by Roxygen)
 +- tests/         # PEcAn testing scripts
   +- testthat/    # nearly all tests should use the testthat framework and live here</code></pre>

</div>
</div>
</div>



</div>
            </section>

          </div>
        </div>
      </div>
<a href="user-section.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="pecan-standards.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tonygardella/pecan/edit/release/vtonydoc/book_source/02_demos_tutorials_workflows/03_developer_workflows/00_developer_guide.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
